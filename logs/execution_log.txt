2025-08-29 11:32:53,041 - INFO - ==================================================
2025-08-29 11:32:53,041 - INFO - 开始执行流水线 - 2025-08-29 11:32:53
2025-08-29 11:32:53,041 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-08-29 11:32:53,041 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-08-29 11:32:53,132 - INFO - pymysql版本: 1.4.6
2025-08-29 11:32:53,132 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-08-29 11:32:53,132 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-08-29 11:32:53,132 - INFO - 工作目录: D:\JA\database
2025-08-29 11:34:09,036 - ERROR - 读取输出时出错: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
2025-08-29 11:34:09,058 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-08-29 11:34:09,058 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-08-29 11:34:09,058 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-08-29 11:34:09,058 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-08-29 11:34:09,059 - INFO - 工作目录: D:\JA\database
2025-08-29 11:34:10,802 - ERROR - 读取输出时出错: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
2025-08-29 12:00:29,819 - INFO - ==================================================
2025-08-29 12:00:29,819 - INFO - 开始执行流水线 - 2025-08-29 12:00:29
2025-08-29 12:00:29,820 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-08-29 12:00:29,820 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-08-29 12:00:29,936 - INFO - pymysql版本: 1.4.6
2025-08-29 12:00:29,936 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-08-29 12:00:29,937 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-08-29 12:00:29,937 - INFO - 工作目录: D:\JA\database
2025-08-29 12:01:39,575 - ERROR - 读取输出时出错: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
2025-08-29 12:01:39,599 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-08-29 12:01:39,599 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-08-29 12:01:39,599 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-08-29 12:01:39,600 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-08-29 12:01:39,600 - INFO - 工作目录: D:\JA\database
2025-08-29 12:01:41,447 - ERROR - 读取输出时出错: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
2025-08-29 12:02:14,689 - ERROR - 脚本 2_table_aggregator.py 失败 (返回码: 3221225786)
2025-08-29 12:02:14,689 - ERROR - 检测到失败，停止后续执行
2025-08-29 12:02:14,689 - INFO - 结束执行时间: 2025-08-29 12:02:14
2025-08-29 12:02:14,690 - INFO - ==================================================
2025-08-29 12:02:29,922 - INFO - ==================================================
2025-08-29 12:02:29,922 - INFO - 开始执行流水线 - 2025-08-29 12:02:29
2025-08-29 12:02:29,922 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-08-29 12:02:29,922 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-08-29 12:02:29,999 - INFO - pymysql版本: 1.4.6
2025-08-29 12:02:29,999 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-08-29 12:02:29,999 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-08-29 12:02:29,999 - INFO - 工作目录: D:\JA\database
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] 开始数据库同步任务: 2025-08-29 12:02:30
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] 开始同步基地: 扬州
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_1_扬州
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] |- 同步完成: 86597 条数据
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_1_扬州
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] |- 同步完成: 8171 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_1_扬州
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 11363 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_1_扬州
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_1_扬州
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 8147 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_1_扬州
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 6051 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_1_扬州
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 3410 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 10.41秒
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 开始同步基地: 东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_2_东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 77532 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_2_东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_2_东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 5767 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_2_东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 12 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_2_东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_2_东台
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] |- 同步完成: 4604 条数据
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_2_东台
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] |- 同步完成: 1921 条数据
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 5.26秒
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 开始同步基地: 合肥
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_3_合肥
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] |- 同步完成: 41670 条数据
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_3_合肥
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_3_合肥
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 2417 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_3_合肥
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_3_合肥
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_3_合肥
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 1776 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_3_合肥
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 855 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 11.14秒
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 开始同步基地: 鄂尔多斯
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_4_鄂尔多斯
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 14211 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_4_鄂尔多斯
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_4_鄂尔多斯
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 484 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_4_鄂尔多斯
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_4_鄂尔多斯
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_4_鄂尔多斯
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 794 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_4_鄂尔多斯
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 152 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 10.52秒
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 开始同步基地: 曲靖
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_5_曲靖
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 82370 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_5_曲靖
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 8315 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_5_曲靖
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 14400 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_5_曲靖
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_5_曲靖
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 8316 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_5_曲靖
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 13973 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_5_曲靖
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 2491 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 9.47秒
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 开始同步基地: 奉贤
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_6_奉贤
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 6128 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_6_奉贤
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 614 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_6_奉贤
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 749 条数据
2025-08-29 12:03:36,606 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_6_奉贤
2025-08-29 12:03:36,606 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-08-29 12:03:36,606 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_6_奉贤
2025-08-29 12:03:36,606 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_6_奉贤
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 667 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_6_奉贤
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 274 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.76秒
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 开始同步基地: 包头
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_7_包头
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 60067 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_7_包头
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 5228 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_7_包头
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 7541 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_7_包头
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_7_包头
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 5228 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_7_包头
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 5828 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_7_包头
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 2019 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 3.99秒
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 开始同步基地: 义乌
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_8_义乌
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 9645 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_8_义乌
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_8_义乌
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 1467 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_8_义乌
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_8_义乌
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_8_义乌
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 2776 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_8_义乌
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 4 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 2.56秒
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 开始同步基地: 邢台
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_9_邢台
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 7098 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_9_邢台
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 483 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_9_邢台
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 933 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_9_邢台
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 5 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_9_邢台
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 483 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_9_邢台
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 741 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_9_邢台
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 266 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.64秒
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 开始同步基地: 宁晋
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_10_宁晋
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 25724 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_10_宁晋
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 1238 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_10_宁晋
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 1933 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_10_宁晋
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_10_宁晋
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 1238 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_10_宁晋
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 850 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_10_宁晋
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 377 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 2.86秒
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 开始同步基地: 石家庄
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_11_石家庄
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 82047 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_11_石家庄
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_11_石家庄
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 9846 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_11_石家庄
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 16 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_11_石家庄
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_11_石家庄
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 6433 条数据
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_11_石家庄
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 1208 条数据
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 6.14秒
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 开始同步基地: 巴彦淖尔
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_12_巴彦淖尔
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 2119 条数据
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_12_巴彦淖尔
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_12_巴彦淖尔
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_12_巴彦淖尔
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_12_巴彦淖尔
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_12_巴彦淖尔
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] |- 同步完成: 158 条数据
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_12_巴彦淖尔
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] |- 同步完成: 157 条数据
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.03秒
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 所有同步任务完成: 2025-08-29 12:03:36
2025-08-29 12:03:36,954 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-08-29 12:03:36,956 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-08-29 12:03:36,956 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-08-29 12:03:36,956 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-08-29 12:03:36,956 - INFO - 工作目录: D:\JA\database
2025-08-29 12:03:38,993 - INFO - [2_table_aggregator.py] 开始数据聚合流程...
2025-08-29 12:03:38,993 - INFO - [2_table_aggregator.py] 加载配置文件: 2_table_aggregator_config.json
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] 数据库连接成功
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_1_扬州
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] 表 1_汇总表_1_扬州 创建成功
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] 正在为基地 扬州 执行数据聚合...
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_1_扬州' 行数: 11363
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] a表 'a采集点表_1_扬州' 行数: 86597
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_1_扬州' 行数: 8171
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('扬州基地', '一厂（晶运园区）-F3电池车间'), ('扬州基地', '一厂（晶运园区）-F2电池车间'), ('扬州基地', '一厂（晶运园区）-动力站F3'), ('扬州基地', '二厂（晶山园区）-晶山组件（M3）'), ('扬州基地', '一厂（晶运园区）-动力站-配电室')]
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_1_扬州
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 原始表c的行数: 11363
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 汇总表的行数: 11363
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:38,996 - INFO - [2_table_aggregator.py] 行 1: ('LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '耗电', '7', '电池车间LPCVD自动化312#电能', '电池车间LPCVD自动化312', 'YZ-002-DC-58-206-0037#AE0005-FV', '85262', 'LPCVD自动化312（JAYZ2438173）', '90002', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-58-206-0037', '通过', '反馈值', '能耗类', '正向有功电度', 'LPCVD自动化', 'LPCVD自动化', '1', 'LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000250', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', 'LPCVD')
2025-08-29 12:03:38,996 - INFO - [2_table_aggregator.py] 行 2: ('硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '耗电', '7', '电池车间硼扩自动化317#电能', '电池车间硼扩自动化317', 'YZ-002-DC-43-156-0039#AE0005-FV', '85636', '硼扩自动化317（JAYZ23C7297）', '89886', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-43-156-0039', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩自动化', '硼扩自动化', '1', '硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000134', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', '硼扩')
2025-08-29 12:03:38,996 - INFO - [2_table_aggregator.py] 行 3: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-08-29 12:03:38,996 - INFO - [2_table_aggregator.py] 行 4: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-08-29 12:03:38,996 - INFO - [2_table_aggregator.py] 行 5: ('背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '运行状态', None, '电池车间背膜主机307#炉管5#设备运行状态', '电池车间背膜主机307', 'YZ-002-DC-53-175-0040#SN0005-RS', '90931', '背膜主机307（JAYZ2417811）', '90116', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-53-175-0040', '通过', '运行状态', '信号类', '状态信号', '背膜主机', '背膜主机', '1', '背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000358', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '背膜')
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_2_东台
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] 表 1_汇总表_2_东台 创建成功
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] 正在为基地 东台 执行数据聚合...
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_2_东台' 行数: 5767
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] a表 'a采集点表_2_东台' 行数: 77532
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_2_东台' 行数: 5131
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('东台基地', '一厂-电池车间1'), ('东台基地', '一厂-组件车间1'), ('东台基地', '一厂动力站'), ('东台基地', '一厂办公区'), ('东台基地', '其他区域')]
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_2_东台
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 原始表c的行数: 5767
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 汇总表的行数: 5767
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 行 1: ('BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '产量', '0', 'BSG上料2号机#产量下料', 'BSG上料2号机', 'DT-001-DC-45-160-0002#YE0004-FV', '384554', 'BSG下料-BSGX1002', '512016', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0002', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-08-29 12:03:39,367 - INFO - [2_table_aggregator.py] 行 2: ('BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '产量', '0', 'BSG上料4号机#产量下料', 'BSG上料4号机', 'DT-001-DC-45-160-0003#YE0004-FV', '384544', 'BSG下料-BSGX1004', '512018', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0003', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-08-29 12:03:39,367 - INFO - [2_table_aggregator.py] 行 3: ('BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '产量', '0', 'BSG上料6号机#产量下料', 'BSG上料6号机', 'DT-001-DC-45-160-0004#YE0004-FV', '384586', 'BSG下料-BSGX1006', '512019', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0004', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-08-29 12:03:39,367 - INFO - [2_table_aggregator.py] 行 4: ('BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '产量', '0', 'BSG上料8号机#产量下料', 'BSG上料8号机', 'DT-001-DC-45-160-0006#YE0004-FV', '384562', 'BSG下料-BSGX1008', '512022', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0006', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] 行 5: ('BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '产量', '0', 'BSG上料12号机#产量下料', 'BSG上料12号机', 'DT-001-DC-45-160-0008#YE0004-FV', '384488', 'BSG下料-BSGX1012', '512025', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0008', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_3_合肥
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] 表 1_汇总表_3_合肥 创建成功
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] 正在为基地 合肥 执行数据聚合...
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_3_合肥' 行数: 2417
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] a表 'a采集点表_3_合肥' 行数: 41670
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_3_合肥' 行数: 1890
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('合肥基地', '二厂（二部）-六车间（201#智慧工厂）'), ('合肥基地', '一厂（一部）-二车间（116#创新工厂）'), ('合肥基地', '207动力站'), ('合肥基地', '207动力站-配电室'), ('合肥基地', '一厂（一部）-四车间（110#领跑工厂）-配电室')]
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_3_合肥
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] 原始表c的行数: 2417
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] 汇总表的行数: 2417
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行 1: ('二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '耗电', '7', '智慧工厂一-6BL15002-总有功电度', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#AE0003-FV', '10', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000048', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行 2: ('二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '产量', '0', '智慧工厂一-6BL15002-产量', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#YE0005-FV', '12', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '统计类', '产量', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000049', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行 3: ('二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '运行状态', None, '智慧工厂一-6BL15002运行状态', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#SN0002-RS', '9', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'HF-EMC-RS-E-NS-NS-000000049', '设备管控', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行 4: ('二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '耗电', '7', '智慧工厂一-6CQ13002-总有功电度', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#AE0001-FV', '759', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000078', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行 5: ('二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '产量', '0', '智慧工厂一-6CQ13002-产量', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#YE0002-FV', '760', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '统计类', '产量', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000079', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_4_鄂尔多斯
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] 表 1_汇总表_4_鄂尔多斯 创建成功
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] 正在为基地 鄂尔多斯 执行数据聚合...
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_4_鄂尔多斯' 行数: 484
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] a表 'a采集点表_4_鄂尔多斯' 行数: 14211
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_4_鄂尔多斯' 行数: 310
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:39,372 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:40,284 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:40,284 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('鄂尔多斯', '二厂（B区）-B4-5GW组件车间2'), ('', '二厂（B区）-B4-5GW组件车间2')]
2025-08-29 12:03:40,284 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:40,284 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:40,284 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:40,285 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_4_鄂尔多斯
2025-08-29 12:03:40,285 - INFO - [2_table_aggregator.py] 原始表c的行数: 484
2025-08-29 12:03:40,285 - INFO - [2_table_aggregator.py] 汇总表的行数: 484
2025-08-29 12:03:40,285 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:40,285 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] 行 1: ('2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '运行状态', None, '2#串焊机01状态', '2#串焊机01', 'EE-019-ZJ-61-224-0002#SN0003-RS', '1143', '2#串焊机01（JAEEDS2020087）', '162', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0002', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000004', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] 行 2: ('2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '运行状态', None, '2#串焊机02状态', '2#串焊机02', 'EE-019-ZJ-61-224-0001#SN0005-RS', '1132', '2#串焊机02（JAEEDS2020088）', '160', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0001', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] 行 3: ('2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '运行状态', None, '2#串焊机03状态', '2#串焊机03', 'EE-019-ZJ-61-224-0004#SN0004-RS', '1161', '2#串焊机03（JAEEDS2020089）', '167', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0004', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000006', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] 行 4: ('2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '运行状态', None, '2#串焊机04状态', '2#串焊机04', 'EE-019-ZJ-61-224-0003#SN0001-RS', '1149', '2#串焊机04（JAEEDS2020090）', '164', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0003', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] 行 5: ('1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '产量', '0', '1#二道胶膜裁切机产量', '1#二道胶膜裁切机02', 'EE-019-ZJ-61-228-0001#YE0001-FV', '1115', '1#二道胶膜裁切机02（JAEEDS2020026）', '155', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-228-0001', '通过', '反馈值', '统计类', '产量', '裁切机', '裁切机', '1', '1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'EE-EMS-YE-E-NS-NS-000000016', '能源管理', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_5_曲靖
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] 表 1_汇总表_5_曲靖 创建成功
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] 正在为基地 曲靖 执行数据聚合...
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_5_曲靖' 行数: 14400
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] a表 'a采集点表_5_曲靖' 行数: 82370
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_5_曲靖' 行数: 8315
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('曲靖基地', '三厂（三期）-电池一期车间（101）'), ('曲靖基地', '二厂（二期）-201拉晶车间'), ('曲靖基地', '二厂（二期）-201加工车间'), ('曲靖基地', '三厂（三期）-组件一期车间（104）'), ('曲靖基地', '二厂（二期）-202拉晶车间')]
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_5_曲靖
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] 原始表c的行数: 14400
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] 汇总表的行数: 14407
2025-08-29 12:03:40,289 - INFO - [2_table_aggregator.py] 警告: 行数不一致! 可能丢失了 -7 行数据
2025-08-29 12:03:40,289 - INFO - [2_table_aggregator.py] 建议检查连接条件和数据完整性
2025-08-29 12:03:40,289 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:40,289 - INFO - [2_table_aggregator.py] 行 1: ('西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '运行状态', None, '西区POLY尾气处理B19#运行状态', '西区POLY尾气处理B19', 'QJ-028-DC-56-199-0039#SN0001-RS', '1070', '西区POLY尾气处理B19（QJJAKJ12021493）', '145', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0039', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-08-29 12:03:40,289 - INFO - [2_table_aggregator.py] 行 2: ('西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '运行状态', None, '西区ALD尾气处理B01#运行状态', '西区ALD尾气处理B01', 'QJ-028-DC-56-199-0044#SN0001-RS', '1110', '西区ALD尾气处理B01（QJJAKJ12021632）', '151', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0044', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-08-29 12:03:40,972 - INFO - [2_table_aggregator.py] 行 3: ('西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '运行状态', None, '西区ALD尾气处理B02#运行状态', '西区ALD尾气处理B02', 'QJ-028-DC-56-199-0045#SN0001-RS', '1118', '西区ALD尾气处理B02（QJJAKJ12021633）', '152', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0045', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] 行 4: ('西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '运行状态', None, '西区ALD尾气处理B03#运行状态', '西区ALD尾气处理B03', 'QJ-028-DC-56-199-0046#SN0001-RS', '1126', '西区ALD尾气处理B03（QJJAKJ120216334）', '153', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0046', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] 行 5: ('西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '运行状态', None, '西区ALD尾气处理B04#运行状态', '西区ALD尾气处理B04', 'QJ-028-DC-56-199-0001#SN0001-RS', '8', '西区ALD尾气处理B04（QJJAKJ120216335）', '5', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0001', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000009', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_6_奉贤
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] 表 1_汇总表_6_奉贤 创建成功
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] 正在为基地 奉贤 执行数据聚合...
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_6_奉贤' 行数: 749
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] a表 'a采集点表_6_奉贤' 行数: 6128
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_6_奉贤' 行数: 614
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('奉贤基地', '一厂-B2组件车间（北区）'), ('奉贤基地', '一厂-B1储能车间'), ('奉贤基地', '厂外-C2接线盒车间'), ('奉贤基地', 'E2动力站'), ('奉贤基地', '35KV变电站')]
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_6_奉贤
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 原始表c的行数: 749
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 汇总表的行数: 749
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行 1: ('自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '运行状态', None, '装工装_201_PLC#运行状态', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#SN0001-RS', '162', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '通过', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行 2: ('自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '耗电', '7', '装工装_201_PLC#总有功电度', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#AE0004-FV', '165', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行 3: ('在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '运行状态', None, '裁切机_501_PLC#运行状态', '裁切机_501_PLC', 'FX-002-ZJ-61-228-0001#SN0001-RS', '153', '在线裁切机一道-FX02CQ0501', '29', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-61-228-0001', '通过', '运行状态', '信号类', '状态信号', '一道EVA裁切机', '一道EVA裁切机', '1', '在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000079', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '焊接')
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行 4: ('自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '运行状态', None, '装工装_301_PLC#运行状态', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#SN0001-RS', '166', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000112', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行 5: ('自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '耗电', '7', '装工装_301_PLC#总有功电度', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#AE0004-FV', '169', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000040', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_7_包头
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 表 1_汇总表_7_包头 创建成功
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 正在为基地 包头 执行数据聚合...
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_7_包头' 行数: 7541
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] a表 'a采集点表_7_包头' 行数: 60067
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_7_包头' 行数: 5228
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('包头基地', '二厂-拉晶车间'), ('包头基地', '三厂-拉晶车间'), ('包头基地', '二厂-加工车间'), ('包头基地', '四厂-组件车间'), ('包头基地', '三厂-切片车间-配电室')]
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_7_包头
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] 原始表c的行数: 7541
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] 汇总表的行数: 7541
2025-08-29 12:03:41,105 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:41,105 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] 行 1: ('二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '二厂-拉晶车间单晶炉1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] 行 2: ('二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '产量', '0', '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '二厂-拉晶车间单晶炉1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] 行 3: ('二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '耗电', '7', '单晶炉#电能', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#AE0003-FV', '9643', '二厂-拉晶车间单晶炉1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '反馈值', '能耗类', '正向有功电度', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'BT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] 行 4: ('二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '二厂-拉晶车间单晶炉1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] 行 5: ('二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '产量', '0', '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '二厂-拉晶车间单晶炉1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_8_义乌
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] 表 1_汇总表_8_义乌 创建成功
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] 正在为基地 义乌 执行数据聚合...
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_8_义乌' 行数: 1467
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] a表 'a采集点表_8_义乌' 行数: 9645
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_8_义乌' 行数: 1363
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('义乌基地', '一厂-组件车间一'), ('义乌基地', '仓库'), ('义乌基地', '动力站-配电室'), ('义乌基地', '一厂-电池车间一'), ('义乌基地', '二厂-电池车间二')]
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_8_义乌
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 原始表c的行数: 1467
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 汇总表的行数: 1467
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 行 1: ('1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '运行状态', None, '1上玻璃102-设备状态', 'KEP-HC', 'YW-003-ZJ-61-256-0010#SN0001-RS', '1', '1上玻璃102', '1', '一厂-组件车间一', '003', 'YW-003-ZJ-61-256-0010', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 行 2: ('1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '运行状态', None, '1汇流条竖起机141-设备状态', 'KEP-HC', 'YW-003-ZJ-60-211-0002#SN0001-RS', '100', '1汇流条竖起机141', '23', '一厂-组件车间一', '003', 'YW-003-ZJ-60-211-0002', '通过', '运行状态', '信号类', '状态信号', '自动捋引线', '自动捋引线', '1', '1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '装框')
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 行 3: ('1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '运行状态', None, '1层压机101-02-设备状态', 'KEP-HC', 'YW-003-ZJ-62-230-0021#SN0003-RS', '1001', '1层压机101-02', '158', '一厂-组件车间一', '003', 'YW-003-ZJ-62-230-0021', '通过', '运行状态', '信号类', '状态信号', '层压机', '层压机', '1', '1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '层压')
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] 行 4: ('1排版机092-产量', '0#10_003_22#160#Sum', '产量', '0', '1排版机092-设备当班产能', 'KEP-HC', 'YW-003-ZJ-61-227-0015#YE0001-FV', '1004', '1排版机092', '160', '一厂-组件车间一', '003', 'YW-003-ZJ-61-227-0015', '通过', '反馈值', '统计类', '产量', '排版机', '排版机', '1', '1排版机092-产量', '0#10_003_22#160#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'YW-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] 行 5: ('1分档机111-耗电', '7#10_003_22#156#Sum', '耗电', '7', '1分档机111-电量', 'KEP-HC', 'YW-003-ZJ-64-239-0004#AE0005-FV', '1005', '1分档机111', '156', '一厂-组件车间一', '003', 'YW-003-ZJ-64-239-0004', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '1分档机111-耗电', '7#10_003_22#156#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YW-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '包装')
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_9_邢台
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] 表 1_汇总表_9_邢台 创建成功
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] 正在为基地 邢台 执行数据聚合...
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_9_邢台' 行数: 933
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] a表 'a采集点表_9_邢台' 行数: 7098
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_9_邢台' 行数: 483
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('邢台基地', '三厂（三园区）-组件三车间'), ('邢台基地', '二厂（二园区）-组件一车间')]
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_9_邢台
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 原始表c的行数: 933
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 汇总表的行数: 933
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行 1: ('分档机1FD501-耗电', '7#2_004_22#249#Sum', '耗电', '7', '分档机1FD501#设备当前电能表示数', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#AE0002-FV', '801', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '分档机1FD501-耗电', '7#2_004_22#249#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'XT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '邢台基地', '组件工段', '包装')
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行 2: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', '0', '分档机1FD501#设备白班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0004-FV', '805', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行 3: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', '0', '分档机1FD501#设备夜班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0005-FV', '807', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行 4: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', '0', '裁切机1EC106#设备白班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0002-FV', '249', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行 5: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', '0', '裁切机1EC106#设备夜班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0003-FV', '250', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_10_宁晋
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 表 1_汇总表_10_宁晋 创建成功
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 正在为基地 宁晋 执行数据聚合...
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_10_宁晋' 行数: 1933
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] a表 'a采集点表_10_宁晋' 行数: 25724
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_10_宁晋' 行数: 1238
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('宁晋基地', '宁晋东城-电池车间'), ('宁晋基地', '宁晋东城-电池车间-配电室'), ('宁晋基地', '动力车间'), ('', '宁晋东城-电池车间')]
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:41,437 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_10_宁晋
2025-08-29 12:03:41,437 - INFO - [2_table_aggregator.py] 原始表c的行数: 1933
2025-08-29 12:03:41,437 - INFO - [2_table_aggregator.py] 汇总表的行数: 1933
2025-08-29 12:03:41,437 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:41,438 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:41,438 - INFO - [2_table_aggregator.py] 行 1: ('制绒下料自动化401-产量', '7#7_001#111#Sum', '产量', '0', '宁晋电池-制绒下料自动化401-PLC---实时累计产出', '宁晋电池-制绒下料自动化401-PLC', 'NJ-001-DC-42-154-0002#YE0003-FV', '877', '制绒下料自动化401', '111', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0002', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化401-产量', '7#7_001#111#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-08-29 12:03:41,438 - INFO - [2_table_aggregator.py] 行 2: ('制绒下料自动化402-产量', '7#7_001#113#Sum', '产量', '0', '宁晋电池-制绒下料自动化402-PLC---实时累计产出', '宁晋电池-制绒下料自动化402-PLC', 'NJ-001-DC-42-154-0004#YE0003-FV', '882', '制绒下料自动化402', '113', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0004', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化402-产量', '7#7_001#113#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-08-29 12:03:42,305 - INFO - [2_table_aggregator.py] 行 3: ('制绒下料自动化403-产量', '7#7_001#115#Sum', '产量', '0', '宁晋电池-制绒下料自动化403-PLC---实时累计产出', '宁晋电池-制绒下料自动化403-PLC', 'NJ-001-DC-42-154-0006#YE0003-FV', '887', '制绒下料自动化403', '115', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0006', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化403-产量', '7#7_001#115#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] 行 4: ('制绒下料自动化404-产量', '7#7_001#117#Sum', '产量', '0', '宁晋电池-制绒下料自动化404-PLC---实时累计产出', '宁晋电池-制绒下料自动化404-PLC', 'NJ-001-DC-42-154-0008#YE0003-FV', '892', '制绒下料自动化404', '117', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0008', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化404-产量', '7#7_001#117#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] 行 5: ('制绒下料自动化405-产量', '7#7_001#119#Sum', '产量', '0', '宁晋电池-制绒下料自动化405-PLC---实时累计产出', '宁晋电池-制绒下料自动化405-PLC', 'NJ-001-DC-42-154-0010#YE0003-FV', '897', '制绒下料自动化405', '119', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0010', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化405-产量', '7#7_001#119#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_11_石家庄
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] 表 1_汇总表_11_石家庄 创建成功
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] 正在为基地 石家庄 执行数据聚合...
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_11_石家庄' 行数: 9846
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] a表 'a采集点表_11_石家庄' 行数: 82047
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_11_石家庄' 行数: 3694
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('石家庄基地', '一厂-动力站'), ('石家庄基地', '一厂-电池一期-配电室'), ('石家庄基地', '一厂-切片一期-配电室'), ('石家庄基地', '一厂-电池一期'), ('石家庄基地', '一厂-切片一期')]
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_11_石家庄
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 原始表c的行数: 9846
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 汇总表的行数: 9846
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行 1: ('重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '耗电', '7', '78AH07#仪表正向有功总', '动力配电室仪表2.4.6.8', 'SJ-003-ZZ-01-JQ-0207#AE0001-FV', '447079', '78AH07', '519381', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0207', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000480', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行 2: ('重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '耗电', '7', '71AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0102#AE0001-FV', '446711', '71AH07', '519013', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0102', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000182', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行 3: ('重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '耗电', '7', '75AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0138#AE0001-FV', '446807', '75AH07', '519109', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0138', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000236', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行 4: ('重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '耗电', '7', '77AH08#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0155#AE0001-FV', '446871', '77AH08', '519173', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0155', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000483', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行 5: ('重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '耗电', '7', '71AH06#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0099#AE0001-FV', '446703', '71AH06', '519005', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0099', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000479', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_12_巴彦淖尔
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] 表 1_汇总表_12_巴彦淖尔 创建成功
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] 正在为基地 巴彦淖尔 执行数据聚合...
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_12_巴彦淖尔' 行数: 0
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] a表 'a采集点表_12_巴彦淖尔' 行数: 2119
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_12_巴彦淖尔' 行数: 0
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('巴彦淖尔', '一厂（一期）-5GW组件车间')]
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_12_巴彦淖尔
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 原始表c的行数: 0
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 汇总表的行数: 0
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 所有基地数据聚合完成!
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 数据库连接已关闭
2025-08-29 12:03:42,328 - INFO - 脚本 2_table_aggregator.py 成功完成 (返回码: 0)
2025-08-29 12:03:42,328 - INFO - 脚本 2_table_aggregator.py 执行完成，继续下一个
2025-08-29 12:03:42,328 - INFO - 正在运行脚本: 3_merge_tables.py
2025-08-29 12:03:42,329 - INFO - 开始运行脚本: D:\JA\database\3_merge_tables.py
2025-08-29 12:03:42,329 - INFO - 工作目录: D:\JA\database
2025-08-29 12:28:03,527 - INFO - [3_merge_tables.py] 正在处理: 扬州基地...
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_1_扬州_20250829120343.xlsx
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_1_扬州_20250829120343.xlsx
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 正在处理: 东台基地...
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_2_东台_20250829120343.xlsx
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_2_东台_20250829120343.xlsx
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 正在处理: 合肥基地...
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_3_合肥_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_3_合肥_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 鄂尔多斯基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_4_鄂尔多斯_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_4_鄂尔多斯_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 曲靖基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_5_曲靖_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_5_曲靖_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 奉贤基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_6_奉贤_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_6_奉贤_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 包头基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_7_包头_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_7_包头_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 义乌基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_8_义乌_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_8_义乌_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 邢台基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_9_邢台_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_9_邢台_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 宁晋基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_10_宁晋_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_10_宁晋_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 石家庄基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_11_石家庄_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_11_石家庄_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 巴彦淖尔基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_12_巴彦淖尔_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_12_巴彦淖尔_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 所有基地处理完成！
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 开始合并所有基地文件...
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 扬州基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 东台基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 合肥基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 鄂尔多斯基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 曲靖基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 奉贤基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 包头基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 义乌基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 邢台基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 宁晋基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 石家庄基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 巴彦淖尔基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 正在格式化合并后的文件...
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 合并文件已生成: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\00汇总表\【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:24,547 - INFO - 脚本 3_merge_tables.py 成功完成 (返回码: 0)
2025-08-29 12:28:24,547 - INFO - 脚本 3_merge_tables.py 执行完成，继续下一个
2025-08-29 12:28:24,547 - INFO - 正在运行脚本: 4_merge_calc_tables.py
2025-08-29 12:28:24,547 - INFO - 开始运行脚本: D:\JA\database\4_merge_calc_tables.py
2025-08-29 12:28:24,547 - INFO - 工作目录: D:\JA\database
2025-08-29 12:29:10,529 - INFO - [4_merge_calc_tables.py] 开始导出数据...
2025-08-29 12:29:10,529 - INFO - [4_merge_calc_tables.py] 输出目录: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\00汇总表
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_1_扬州 已导出到Sheet: 扬州
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_2_东台 已导出到Sheet: 东台
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_3_合肥 已导出到Sheet: 合肥
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_4_鄂尔多斯 已导出到Sheet: 鄂尔多斯
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_5_曲靖 已导出到Sheet: 曲靖
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_6_奉贤 已导出到Sheet: 奉贤
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_7_包头 已导出到Sheet: 包头
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_8_义乌 已导出到Sheet: 义乌
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_9_邢台 已导出到Sheet: 邢台
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_10_宁晋 已导出到Sheet: 宁晋
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_11_石家庄 已导出到Sheet: 石家庄
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_12_巴彦淖尔 已导出到Sheet: 巴彦淖尔
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 汇总Sheet已创建
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 文件已保存为: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\00汇总表\【合并】计算逻辑_20250829122825.xlsx
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 文件验证成功: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\00汇总表\【合并】计算逻辑_20250829122825.xlsx
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 文件大小: 23567.62 KB
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 导出完成，耗时: 45.01 秒
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] === 导出摘要 ===
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 输出文件: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\00汇总表\【合并】计算逻辑_20250829122825.xlsx
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 包含工作表: 汇总 + 12个基地表
2025-08-29 12:29:12,303 - INFO - 脚本 4_merge_calc_tables.py 成功完成 (返回码: 0)
2025-08-29 12:29:12,303 - INFO - 脚本 4_merge_calc_tables.py 执行完成，继续下一个
2025-08-29 12:29:12,303 - INFO - 结束执行时间: 2025-08-29 12:29:12
2025-08-29 12:29:12,303 - INFO - ==================================================
