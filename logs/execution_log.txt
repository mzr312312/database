2025-08-29 11:32:53,041 - INFO - ==================================================
2025-08-29 11:32:53,041 - INFO - 开始执行流水线 - 2025-08-29 11:32:53
2025-08-29 11:32:53,041 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-08-29 11:32:53,041 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-08-29 11:32:53,132 - INFO - pymysql版本: 1.4.6
2025-08-29 11:32:53,132 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-08-29 11:32:53,132 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-08-29 11:32:53,132 - INFO - 工作目录: D:\JA\database
2025-08-29 11:34:09,036 - ERROR - 读取输出时出错: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
2025-08-29 11:34:09,058 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-08-29 11:34:09,058 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-08-29 11:34:09,058 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-08-29 11:34:09,058 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-08-29 11:34:09,059 - INFO - 工作目录: D:\JA\database
2025-08-29 11:34:10,802 - ERROR - 读取输出时出错: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
2025-08-29 12:00:29,819 - INFO - ==================================================
2025-08-29 12:00:29,819 - INFO - 开始执行流水线 - 2025-08-29 12:00:29
2025-08-29 12:00:29,820 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-08-29 12:00:29,820 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-08-29 12:00:29,936 - INFO - pymysql版本: 1.4.6
2025-08-29 12:00:29,936 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-08-29 12:00:29,937 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-08-29 12:00:29,937 - INFO - 工作目录: D:\JA\database
2025-08-29 12:01:39,575 - ERROR - 读取输出时出错: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
2025-08-29 12:01:39,599 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-08-29 12:01:39,599 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-08-29 12:01:39,599 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-08-29 12:01:39,600 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-08-29 12:01:39,600 - INFO - 工作目录: D:\JA\database
2025-08-29 12:01:41,447 - ERROR - 读取输出时出错: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
2025-08-29 12:02:14,689 - ERROR - 脚本 2_table_aggregator.py 失败 (返回码: 3221225786)
2025-08-29 12:02:14,689 - ERROR - 检测到失败，停止后续执行
2025-08-29 12:02:14,689 - INFO - 结束执行时间: 2025-08-29 12:02:14
2025-08-29 12:02:14,690 - INFO - ==================================================
2025-08-29 12:02:29,922 - INFO - ==================================================
2025-08-29 12:02:29,922 - INFO - 开始执行流水线 - 2025-08-29 12:02:29
2025-08-29 12:02:29,922 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-08-29 12:02:29,922 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-08-29 12:02:29,999 - INFO - pymysql版本: 1.4.6
2025-08-29 12:02:29,999 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-08-29 12:02:29,999 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-08-29 12:02:29,999 - INFO - 工作目录: D:\JA\database
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] 开始数据库同步任务: 2025-08-29 12:02:30
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] 开始同步基地: 扬州
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_1_扬州
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] |- 同步完成: 86597 条数据
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_1_扬州
2025-08-29 12:03:36,599 - INFO - [1_copy_to_local.py] |- 同步完成: 8171 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_1_扬州
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 11363 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_1_扬州
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_1_扬州
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 8147 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_1_扬州
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 6051 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_1_扬州
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 3410 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 10.41秒
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 开始同步基地: 东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_2_东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 77532 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_2_东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_2_东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 5767 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_2_东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 12 条数据
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_2_东台
2025-08-29 12:03:36,600 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_2_东台
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] |- 同步完成: 4604 条数据
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_2_东台
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] |- 同步完成: 1921 条数据
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 5.26秒
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 开始同步基地: 合肥
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_3_合肥
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] |- 同步完成: 41670 条数据
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_3_合肥
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-08-29 12:03:36,602 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_3_合肥
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 2417 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_3_合肥
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_3_合肥
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_3_合肥
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 1776 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_3_合肥
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 855 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 11.14秒
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 开始同步基地: 鄂尔多斯
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_4_鄂尔多斯
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 14211 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_4_鄂尔多斯
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-08-29 12:03:36,603 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_4_鄂尔多斯
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 484 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_4_鄂尔多斯
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_4_鄂尔多斯
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_4_鄂尔多斯
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 794 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_4_鄂尔多斯
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 152 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 10.52秒
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 开始同步基地: 曲靖
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_5_曲靖
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 82370 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_5_曲靖
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] |- 同步完成: 8315 条数据
2025-08-29 12:03:36,604 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_5_曲靖
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 14400 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_5_曲靖
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_5_曲靖
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 8316 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_5_曲靖
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 13973 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_5_曲靖
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 2491 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 9.47秒
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 开始同步基地: 奉贤
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_6_奉贤
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 6128 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_6_奉贤
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 614 条数据
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_6_奉贤
2025-08-29 12:03:36,605 - INFO - [1_copy_to_local.py] |- 同步完成: 749 条数据
2025-08-29 12:03:36,606 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_6_奉贤
2025-08-29 12:03:36,606 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-08-29 12:03:36,606 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_6_奉贤
2025-08-29 12:03:36,606 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_6_奉贤
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 667 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_6_奉贤
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 274 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.76秒
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 开始同步基地: 包头
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_7_包头
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 60067 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_7_包头
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 5228 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_7_包头
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 7541 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_7_包头
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-08-29 12:03:36,607 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_7_包头
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 5228 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_7_包头
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 5828 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_7_包头
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 2019 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 3.99秒
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 开始同步基地: 义乌
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_8_义乌
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 9645 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_8_义乌
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_8_义乌
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 1467 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_8_义乌
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-08-29 12:03:36,608 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_8_义乌
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_8_义乌
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 2776 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_8_义乌
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 4 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 2.56秒
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 开始同步基地: 邢台
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_9_邢台
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 7098 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_9_邢台
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 483 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_9_邢台
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 933 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_9_邢台
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] |- 同步完成: 5 条数据
2025-08-29 12:03:36,609 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_9_邢台
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 483 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_9_邢台
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 741 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_9_邢台
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 266 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.64秒
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 开始同步基地: 宁晋
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_10_宁晋
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 25724 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_10_宁晋
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 1238 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_10_宁晋
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 1933 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_10_宁晋
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-08-29 12:03:36,610 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_10_宁晋
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 1238 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_10_宁晋
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 850 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_10_宁晋
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 377 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 2.86秒
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 开始同步基地: 石家庄
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_11_石家庄
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 82047 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_11_石家庄
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_11_石家庄
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 9846 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_11_石家庄
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] |- 同步完成: 16 条数据
2025-08-29 12:03:36,611 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_11_石家庄
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_11_石家庄
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 6433 条数据
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_11_石家庄
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 1208 条数据
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 6.14秒
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 开始同步基地: 巴彦淖尔
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_12_巴彦淖尔
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 2119 条数据
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_12_巴彦淖尔
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_12_巴彦淖尔
2025-08-29 12:03:36,612 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_12_巴彦淖尔
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_12_巴彦淖尔
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_12_巴彦淖尔
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] |- 同步完成: 158 条数据
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_12_巴彦淖尔
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] |- 同步完成: 157 条数据
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.03秒
2025-08-29 12:03:36,929 - INFO - [1_copy_to_local.py] 所有同步任务完成: 2025-08-29 12:03:36
2025-08-29 12:03:36,954 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-08-29 12:03:36,956 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-08-29 12:03:36,956 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-08-29 12:03:36,956 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-08-29 12:03:36,956 - INFO - 工作目录: D:\JA\database
2025-08-29 12:03:38,993 - INFO - [2_table_aggregator.py] 开始数据聚合流程...
2025-08-29 12:03:38,993 - INFO - [2_table_aggregator.py] 加载配置文件: 2_table_aggregator_config.json
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] 数据库连接成功
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_1_扬州
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] 表 1_汇总表_1_扬州 创建成功
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] 正在为基地 扬州 执行数据聚合...
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_1_扬州' 行数: 11363
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] a表 'a采集点表_1_扬州' 行数: 86597
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_1_扬州' 行数: 8171
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('扬州基地', '一厂（晶运园区）-F3电池车间'), ('扬州基地', '一厂（晶运园区）-F2电池车间'), ('扬州基地', '一厂（晶运园区）-动力站F3'), ('扬州基地', '二厂（晶山园区）-晶山组件（M3）'), ('扬州基地', '一厂（晶运园区）-动力站-配电室')]
2025-08-29 12:03:38,994 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_1_扬州
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 原始表c的行数: 11363
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 汇总表的行数: 11363
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:38,995 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:38,996 - INFO - [2_table_aggregator.py] 行 1: ('LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '耗电', '7', '电池车间LPCVD自动化312#电能', '电池车间LPCVD自动化312', 'YZ-002-DC-58-206-0037#AE0005-FV', '85262', 'LPCVD自动化312（JAYZ2438173）', '90002', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-58-206-0037', '通过', '反馈值', '能耗类', '正向有功电度', 'LPCVD自动化', 'LPCVD自动化', '1', 'LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000250', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', 'LPCVD')
2025-08-29 12:03:38,996 - INFO - [2_table_aggregator.py] 行 2: ('硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '耗电', '7', '电池车间硼扩自动化317#电能', '电池车间硼扩自动化317', 'YZ-002-DC-43-156-0039#AE0005-FV', '85636', '硼扩自动化317（JAYZ23C7297）', '89886', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-43-156-0039', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩自动化', '硼扩自动化', '1', '硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000134', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', '硼扩')
2025-08-29 12:03:38,996 - INFO - [2_table_aggregator.py] 行 3: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-08-29 12:03:38,996 - INFO - [2_table_aggregator.py] 行 4: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-08-29 12:03:38,996 - INFO - [2_table_aggregator.py] 行 5: ('背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '运行状态', None, '电池车间背膜主机307#炉管5#设备运行状态', '电池车间背膜主机307', 'YZ-002-DC-53-175-0040#SN0005-RS', '90931', '背膜主机307（JAYZ2417811）', '90116', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-53-175-0040', '通过', '运行状态', '信号类', '状态信号', '背膜主机', '背膜主机', '1', '背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000358', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '背膜')
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_2_东台
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] 表 1_汇总表_2_东台 创建成功
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] 正在为基地 东台 执行数据聚合...
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_2_东台' 行数: 5767
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] a表 'a采集点表_2_东台' 行数: 77532
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_2_东台' 行数: 5131
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:38,997 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('东台基地', '一厂-电池车间1'), ('东台基地', '一厂-组件车间1'), ('东台基地', '一厂动力站'), ('东台基地', '一厂办公区'), ('东台基地', '其他区域')]
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_2_东台
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 原始表c的行数: 5767
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 汇总表的行数: 5767
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:38,998 - INFO - [2_table_aggregator.py] 行 1: ('BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '产量', '0', 'BSG上料2号机#产量下料', 'BSG上料2号机', 'DT-001-DC-45-160-0002#YE0004-FV', '384554', 'BSG下料-BSGX1002', '512016', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0002', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-08-29 12:03:39,367 - INFO - [2_table_aggregator.py] 行 2: ('BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '产量', '0', 'BSG上料4号机#产量下料', 'BSG上料4号机', 'DT-001-DC-45-160-0003#YE0004-FV', '384544', 'BSG下料-BSGX1004', '512018', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0003', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-08-29 12:03:39,367 - INFO - [2_table_aggregator.py] 行 3: ('BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '产量', '0', 'BSG上料6号机#产量下料', 'BSG上料6号机', 'DT-001-DC-45-160-0004#YE0004-FV', '384586', 'BSG下料-BSGX1006', '512019', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0004', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-08-29 12:03:39,367 - INFO - [2_table_aggregator.py] 行 4: ('BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '产量', '0', 'BSG上料8号机#产量下料', 'BSG上料8号机', 'DT-001-DC-45-160-0006#YE0004-FV', '384562', 'BSG下料-BSGX1008', '512022', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0006', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] 行 5: ('BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '产量', '0', 'BSG上料12号机#产量下料', 'BSG上料12号机', 'DT-001-DC-45-160-0008#YE0004-FV', '384488', 'BSG下料-BSGX1012', '512025', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0008', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_3_合肥
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] 表 1_汇总表_3_合肥 创建成功
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] 正在为基地 合肥 执行数据聚合...
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_3_合肥' 行数: 2417
2025-08-29 12:03:39,368 - INFO - [2_table_aggregator.py] a表 'a采集点表_3_合肥' 行数: 41670
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_3_合肥' 行数: 1890
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('合肥基地', '二厂（二部）-六车间（201#智慧工厂）'), ('合肥基地', '一厂（一部）-二车间（116#创新工厂）'), ('合肥基地', '207动力站'), ('合肥基地', '207动力站-配电室'), ('合肥基地', '一厂（一部）-四车间（110#领跑工厂）-配电室')]
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_3_合肥
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] 原始表c的行数: 2417
2025-08-29 12:03:39,369 - INFO - [2_table_aggregator.py] 汇总表的行数: 2417
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行 1: ('二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '耗电', '7', '智慧工厂一-6BL15002-总有功电度', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#AE0003-FV', '10', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000048', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行 2: ('二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '产量', '0', '智慧工厂一-6BL15002-产量', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#YE0005-FV', '12', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '统计类', '产量', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000049', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行 3: ('二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '运行状态', None, '智慧工厂一-6BL15002运行状态', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#SN0002-RS', '9', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'HF-EMC-RS-E-NS-NS-000000049', '设备管控', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行 4: ('二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '耗电', '7', '智慧工厂一-6CQ13002-总有功电度', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#AE0001-FV', '759', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000078', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-08-29 12:03:39,370 - INFO - [2_table_aggregator.py] 行 5: ('二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '产量', '0', '智慧工厂一-6CQ13002-产量', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#YE0002-FV', '760', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '统计类', '产量', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000079', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_4_鄂尔多斯
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] 表 1_汇总表_4_鄂尔多斯 创建成功
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] 正在为基地 鄂尔多斯 执行数据聚合...
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_4_鄂尔多斯' 行数: 484
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] a表 'a采集点表_4_鄂尔多斯' 行数: 14211
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_4_鄂尔多斯' 行数: 310
2025-08-29 12:03:39,371 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:39,372 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:40,284 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:40,284 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('鄂尔多斯', '二厂（B区）-B4-5GW组件车间2'), ('', '二厂（B区）-B4-5GW组件车间2')]
2025-08-29 12:03:40,284 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:40,284 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:40,284 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:40,285 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_4_鄂尔多斯
2025-08-29 12:03:40,285 - INFO - [2_table_aggregator.py] 原始表c的行数: 484
2025-08-29 12:03:40,285 - INFO - [2_table_aggregator.py] 汇总表的行数: 484
2025-08-29 12:03:40,285 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:40,285 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] 行 1: ('2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '运行状态', None, '2#串焊机01状态', '2#串焊机01', 'EE-019-ZJ-61-224-0002#SN0003-RS', '1143', '2#串焊机01（JAEEDS2020087）', '162', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0002', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000004', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] 行 2: ('2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '运行状态', None, '2#串焊机02状态', '2#串焊机02', 'EE-019-ZJ-61-224-0001#SN0005-RS', '1132', '2#串焊机02（JAEEDS2020088）', '160', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0001', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] 行 3: ('2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '运行状态', None, '2#串焊机03状态', '2#串焊机03', 'EE-019-ZJ-61-224-0004#SN0004-RS', '1161', '2#串焊机03（JAEEDS2020089）', '167', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0004', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000006', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] 行 4: ('2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '运行状态', None, '2#串焊机04状态', '2#串焊机04', 'EE-019-ZJ-61-224-0003#SN0001-RS', '1149', '2#串焊机04（JAEEDS2020090）', '164', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0003', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] 行 5: ('1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '产量', '0', '1#二道胶膜裁切机产量', '1#二道胶膜裁切机02', 'EE-019-ZJ-61-228-0001#YE0001-FV', '1115', '1#二道胶膜裁切机02（JAEEDS2020026）', '155', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-228-0001', '通过', '反馈值', '统计类', '产量', '裁切机', '裁切机', '1', '1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'EE-EMS-YE-E-NS-NS-000000016', '能源管理', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-08-29 12:03:40,286 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_5_曲靖
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] 表 1_汇总表_5_曲靖 创建成功
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] 正在为基地 曲靖 执行数据聚合...
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_5_曲靖' 行数: 14400
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] a表 'a采集点表_5_曲靖' 行数: 82370
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_5_曲靖' 行数: 8315
2025-08-29 12:03:40,287 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('曲靖基地', '三厂（三期）-电池一期车间（101）'), ('曲靖基地', '二厂（二期）-201拉晶车间'), ('曲靖基地', '二厂（二期）-201加工车间'), ('曲靖基地', '三厂（三期）-组件一期车间（104）'), ('曲靖基地', '二厂（二期）-202拉晶车间')]
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_5_曲靖
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] 原始表c的行数: 14400
2025-08-29 12:03:40,288 - INFO - [2_table_aggregator.py] 汇总表的行数: 14407
2025-08-29 12:03:40,289 - INFO - [2_table_aggregator.py] 警告: 行数不一致! 可能丢失了 -7 行数据
2025-08-29 12:03:40,289 - INFO - [2_table_aggregator.py] 建议检查连接条件和数据完整性
2025-08-29 12:03:40,289 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:40,289 - INFO - [2_table_aggregator.py] 行 1: ('西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '运行状态', None, '西区POLY尾气处理B19#运行状态', '西区POLY尾气处理B19', 'QJ-028-DC-56-199-0039#SN0001-RS', '1070', '西区POLY尾气处理B19（QJJAKJ12021493）', '145', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0039', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-08-29 12:03:40,289 - INFO - [2_table_aggregator.py] 行 2: ('西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '运行状态', None, '西区ALD尾气处理B01#运行状态', '西区ALD尾气处理B01', 'QJ-028-DC-56-199-0044#SN0001-RS', '1110', '西区ALD尾气处理B01（QJJAKJ12021632）', '151', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0044', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-08-29 12:03:40,972 - INFO - [2_table_aggregator.py] 行 3: ('西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '运行状态', None, '西区ALD尾气处理B02#运行状态', '西区ALD尾气处理B02', 'QJ-028-DC-56-199-0045#SN0001-RS', '1118', '西区ALD尾气处理B02（QJJAKJ12021633）', '152', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0045', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] 行 4: ('西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '运行状态', None, '西区ALD尾气处理B03#运行状态', '西区ALD尾气处理B03', 'QJ-028-DC-56-199-0046#SN0001-RS', '1126', '西区ALD尾气处理B03（QJJAKJ120216334）', '153', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0046', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] 行 5: ('西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '运行状态', None, '西区ALD尾气处理B04#运行状态', '西区ALD尾气处理B04', 'QJ-028-DC-56-199-0001#SN0001-RS', '8', '西区ALD尾气处理B04（QJJAKJ120216335）', '5', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0001', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000009', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_6_奉贤
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] 表 1_汇总表_6_奉贤 创建成功
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] 正在为基地 奉贤 执行数据聚合...
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_6_奉贤' 行数: 749
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] a表 'a采集点表_6_奉贤' 行数: 6128
2025-08-29 12:03:40,973 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_6_奉贤' 行数: 614
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('奉贤基地', '一厂-B2组件车间（北区）'), ('奉贤基地', '一厂-B1储能车间'), ('奉贤基地', '厂外-C2接线盒车间'), ('奉贤基地', 'E2动力站'), ('奉贤基地', '35KV变电站')]
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:40,974 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_6_奉贤
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 原始表c的行数: 749
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 汇总表的行数: 749
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行 1: ('自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '运行状态', None, '装工装_201_PLC#运行状态', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#SN0001-RS', '162', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '通过', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行 2: ('自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '耗电', '7', '装工装_201_PLC#总有功电度', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#AE0004-FV', '165', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行 3: ('在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '运行状态', None, '裁切机_501_PLC#运行状态', '裁切机_501_PLC', 'FX-002-ZJ-61-228-0001#SN0001-RS', '153', '在线裁切机一道-FX02CQ0501', '29', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-61-228-0001', '通过', '运行状态', '信号类', '状态信号', '一道EVA裁切机', '一道EVA裁切机', '1', '在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000079', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '焊接')
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行 4: ('自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '运行状态', None, '装工装_301_PLC#运行状态', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#SN0001-RS', '166', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000112', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 行 5: ('自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '耗电', '7', '装工装_301_PLC#总有功电度', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#AE0004-FV', '169', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000040', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_7_包头
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 表 1_汇总表_7_包头 创建成功
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] 正在为基地 包头 执行数据聚合...
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_7_包头' 行数: 7541
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] a表 'a采集点表_7_包头' 行数: 60067
2025-08-29 12:03:40,975 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_7_包头' 行数: 5228
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('包头基地', '二厂-拉晶车间'), ('包头基地', '三厂-拉晶车间'), ('包头基地', '二厂-加工车间'), ('包头基地', '四厂-组件车间'), ('包头基地', '三厂-切片车间-配电室')]
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_7_包头
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] 原始表c的行数: 7541
2025-08-29 12:03:40,976 - INFO - [2_table_aggregator.py] 汇总表的行数: 7541
2025-08-29 12:03:41,105 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:41,105 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] 行 1: ('二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '二厂-拉晶车间单晶炉1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] 行 2: ('二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '产量', '0', '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '二厂-拉晶车间单晶炉1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] 行 3: ('二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '耗电', '7', '单晶炉#电能', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#AE0003-FV', '9643', '二厂-拉晶车间单晶炉1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '反馈值', '能耗类', '正向有功电度', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'BT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] 行 4: ('二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '二厂-拉晶车间单晶炉1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] 行 5: ('二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '产量', '0', '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '二厂-拉晶车间单晶炉1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-08-29 12:03:41,106 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_8_义乌
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] 表 1_汇总表_8_义乌 创建成功
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] 正在为基地 义乌 执行数据聚合...
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_8_义乌' 行数: 1467
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] a表 'a采集点表_8_义乌' 行数: 9645
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_8_义乌' 行数: 1363
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:41,107 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('义乌基地', '一厂-组件车间一'), ('义乌基地', '仓库'), ('义乌基地', '动力站-配电室'), ('义乌基地', '一厂-电池车间一'), ('义乌基地', '二厂-电池车间二')]
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_8_义乌
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 原始表c的行数: 1467
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 汇总表的行数: 1467
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 行 1: ('1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '运行状态', None, '1上玻璃102-设备状态', 'KEP-HC', 'YW-003-ZJ-61-256-0010#SN0001-RS', '1', '1上玻璃102', '1', '一厂-组件车间一', '003', 'YW-003-ZJ-61-256-0010', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 行 2: ('1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '运行状态', None, '1汇流条竖起机141-设备状态', 'KEP-HC', 'YW-003-ZJ-60-211-0002#SN0001-RS', '100', '1汇流条竖起机141', '23', '一厂-组件车间一', '003', 'YW-003-ZJ-60-211-0002', '通过', '运行状态', '信号类', '状态信号', '自动捋引线', '自动捋引线', '1', '1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '装框')
2025-08-29 12:03:41,108 - INFO - [2_table_aggregator.py] 行 3: ('1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '运行状态', None, '1层压机101-02-设备状态', 'KEP-HC', 'YW-003-ZJ-62-230-0021#SN0003-RS', '1001', '1层压机101-02', '158', '一厂-组件车间一', '003', 'YW-003-ZJ-62-230-0021', '通过', '运行状态', '信号类', '状态信号', '层压机', '层压机', '1', '1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '层压')
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] 行 4: ('1排版机092-产量', '0#10_003_22#160#Sum', '产量', '0', '1排版机092-设备当班产能', 'KEP-HC', 'YW-003-ZJ-61-227-0015#YE0001-FV', '1004', '1排版机092', '160', '一厂-组件车间一', '003', 'YW-003-ZJ-61-227-0015', '通过', '反馈值', '统计类', '产量', '排版机', '排版机', '1', '1排版机092-产量', '0#10_003_22#160#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'YW-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] 行 5: ('1分档机111-耗电', '7#10_003_22#156#Sum', '耗电', '7', '1分档机111-电量', 'KEP-HC', 'YW-003-ZJ-64-239-0004#AE0005-FV', '1005', '1分档机111', '156', '一厂-组件车间一', '003', 'YW-003-ZJ-64-239-0004', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '1分档机111-耗电', '7#10_003_22#156#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YW-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '包装')
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_9_邢台
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] 表 1_汇总表_9_邢台 创建成功
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] 正在为基地 邢台 执行数据聚合...
2025-08-29 12:03:41,433 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_9_邢台' 行数: 933
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] a表 'a采集点表_9_邢台' 行数: 7098
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_9_邢台' 行数: 483
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('邢台基地', '三厂（三园区）-组件三车间'), ('邢台基地', '二厂（二园区）-组件一车间')]
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:41,434 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_9_邢台
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 原始表c的行数: 933
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 汇总表的行数: 933
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行 1: ('分档机1FD501-耗电', '7#2_004_22#249#Sum', '耗电', '7', '分档机1FD501#设备当前电能表示数', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#AE0002-FV', '801', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '分档机1FD501-耗电', '7#2_004_22#249#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'XT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '邢台基地', '组件工段', '包装')
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行 2: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', '0', '分档机1FD501#设备白班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0004-FV', '805', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行 3: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', '0', '分档机1FD501#设备夜班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0005-FV', '807', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行 4: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', '0', '裁切机1EC106#设备白班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0002-FV', '249', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 行 5: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', '0', '裁切机1EC106#设备夜班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0003-FV', '250', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_10_宁晋
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 表 1_汇总表_10_宁晋 创建成功
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] 正在为基地 宁晋 执行数据聚合...
2025-08-29 12:03:41,435 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_10_宁晋' 行数: 1933
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] a表 'a采集点表_10_宁晋' 行数: 25724
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_10_宁晋' 行数: 1238
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('宁晋基地', '宁晋东城-电池车间'), ('宁晋基地', '宁晋东城-电池车间-配电室'), ('宁晋基地', '动力车间'), ('', '宁晋东城-电池车间')]
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:41,436 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:41,437 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_10_宁晋
2025-08-29 12:03:41,437 - INFO - [2_table_aggregator.py] 原始表c的行数: 1933
2025-08-29 12:03:41,437 - INFO - [2_table_aggregator.py] 汇总表的行数: 1933
2025-08-29 12:03:41,437 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:41,438 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:41,438 - INFO - [2_table_aggregator.py] 行 1: ('制绒下料自动化401-产量', '7#7_001#111#Sum', '产量', '0', '宁晋电池-制绒下料自动化401-PLC---实时累计产出', '宁晋电池-制绒下料自动化401-PLC', 'NJ-001-DC-42-154-0002#YE0003-FV', '877', '制绒下料自动化401', '111', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0002', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化401-产量', '7#7_001#111#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-08-29 12:03:41,438 - INFO - [2_table_aggregator.py] 行 2: ('制绒下料自动化402-产量', '7#7_001#113#Sum', '产量', '0', '宁晋电池-制绒下料自动化402-PLC---实时累计产出', '宁晋电池-制绒下料自动化402-PLC', 'NJ-001-DC-42-154-0004#YE0003-FV', '882', '制绒下料自动化402', '113', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0004', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化402-产量', '7#7_001#113#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-08-29 12:03:42,305 - INFO - [2_table_aggregator.py] 行 3: ('制绒下料自动化403-产量', '7#7_001#115#Sum', '产量', '0', '宁晋电池-制绒下料自动化403-PLC---实时累计产出', '宁晋电池-制绒下料自动化403-PLC', 'NJ-001-DC-42-154-0006#YE0003-FV', '887', '制绒下料自动化403', '115', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0006', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化403-产量', '7#7_001#115#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] 行 4: ('制绒下料自动化404-产量', '7#7_001#117#Sum', '产量', '0', '宁晋电池-制绒下料自动化404-PLC---实时累计产出', '宁晋电池-制绒下料自动化404-PLC', 'NJ-001-DC-42-154-0008#YE0003-FV', '892', '制绒下料自动化404', '117', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0008', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化404-产量', '7#7_001#117#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] 行 5: ('制绒下料自动化405-产量', '7#7_001#119#Sum', '产量', '0', '宁晋电池-制绒下料自动化405-PLC---实时累计产出', '宁晋电池-制绒下料自动化405-PLC', 'NJ-001-DC-42-154-0010#YE0003-FV', '897', '制绒下料自动化405', '119', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0010', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化405-产量', '7#7_001#119#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_11_石家庄
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] 表 1_汇总表_11_石家庄 创建成功
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] 正在为基地 石家庄 执行数据聚合...
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:42,306 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_11_石家庄' 行数: 9846
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] a表 'a采集点表_11_石家庄' 行数: 82047
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_11_石家庄' 行数: 3694
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('石家庄基地', '一厂-动力站'), ('石家庄基地', '一厂-电池一期-配电室'), ('石家庄基地', '一厂-切片一期-配电室'), ('石家庄基地', '一厂-电池一期'), ('石家庄基地', '一厂-切片一期')]
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:42,307 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_11_石家庄
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 原始表c的行数: 9846
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 汇总表的行数: 9846
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行 1: ('重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '耗电', '7', '78AH07#仪表正向有功总', '动力配电室仪表2.4.6.8', 'SJ-003-ZZ-01-JQ-0207#AE0001-FV', '447079', '78AH07', '519381', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0207', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000480', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行 2: ('重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '耗电', '7', '71AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0102#AE0001-FV', '446711', '71AH07', '519013', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0102', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000182', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行 3: ('重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '耗电', '7', '75AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0138#AE0001-FV', '446807', '75AH07', '519109', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0138', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000236', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行 4: ('重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '耗电', '7', '77AH08#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0155#AE0001-FV', '446871', '77AH08', '519173', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0155', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000483', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-08-29 12:03:42,308 - INFO - [2_table_aggregator.py] 行 5: ('重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '耗电', '7', '71AH06#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0099#AE0001-FV', '446703', '71AH06', '519005', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0099', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000479', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_12_巴彦淖尔
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] 表 1_汇总表_12_巴彦淖尔 创建成功
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] 正在为基地 巴彦淖尔 执行数据聚合...
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_12_巴彦淖尔' 行数: 0
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] a表 'a采集点表_12_巴彦淖尔' 行数: 2119
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_12_巴彦淖尔' 行数: 0
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('巴彦淖尔', '一厂（一期）-5GW组件车间')]
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-08-29 12:03:42,309 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_12_巴彦淖尔
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 原始表c的行数: 0
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 汇总表的行数: 0
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 所有基地数据聚合完成!
2025-08-29 12:03:42,310 - INFO - [2_table_aggregator.py] 数据库连接已关闭
2025-08-29 12:03:42,328 - INFO - 脚本 2_table_aggregator.py 成功完成 (返回码: 0)
2025-08-29 12:03:42,328 - INFO - 脚本 2_table_aggregator.py 执行完成，继续下一个
2025-08-29 12:03:42,328 - INFO - 正在运行脚本: 3_merge_tables.py
2025-08-29 12:03:42,329 - INFO - 开始运行脚本: D:\JA\database\3_merge_tables.py
2025-08-29 12:03:42,329 - INFO - 工作目录: D:\JA\database
2025-08-29 12:28:03,527 - INFO - [3_merge_tables.py] 正在处理: 扬州基地...
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_1_扬州_20250829120343.xlsx
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_1_扬州_20250829120343.xlsx
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 正在处理: 东台基地...
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_2_东台_20250829120343.xlsx
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_2_东台_20250829120343.xlsx
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 正在处理: 合肥基地...
2025-08-29 12:28:03,528 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_3_合肥_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_3_合肥_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 鄂尔多斯基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_4_鄂尔多斯_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_4_鄂尔多斯_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 曲靖基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_5_曲靖_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_5_曲靖_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 奉贤基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_6_奉贤_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_6_奉贤_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 包头基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_7_包头_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_7_包头_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 义乌基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_8_义乌_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_8_义乌_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 邢台基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_9_邢台_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_9_邢台_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 宁晋基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_10_宁晋_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_10_宁晋_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 石家庄基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_11_石家庄_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_11_石家庄_20250829120343.xlsx
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 正在处理: 巴彦淖尔基地...
2025-08-29 12:28:03,529 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_12_巴彦淖尔_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已格式化: 2_采集点+设备合并表_12_巴彦淖尔_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 所有基地处理完成！
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 开始合并所有基地文件...
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 扬州基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 东台基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 合肥基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 鄂尔多斯基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 曲靖基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 奉贤基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 包头基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 义乌基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 邢台基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 宁晋基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 石家庄基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 已合并: 巴彦淖尔基地 -> 【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 正在格式化合并后的文件...
2025-08-29 12:28:03,531 - INFO - [3_merge_tables.py] 合并文件已生成: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\00汇总表\【合并】采集点+设备_20250829120343.xlsx
2025-08-29 12:28:24,547 - INFO - 脚本 3_merge_tables.py 成功完成 (返回码: 0)
2025-08-29 12:28:24,547 - INFO - 脚本 3_merge_tables.py 执行完成，继续下一个
2025-08-29 12:28:24,547 - INFO - 正在运行脚本: 4_merge_calc_tables.py
2025-08-29 12:28:24,547 - INFO - 开始运行脚本: D:\JA\database\4_merge_calc_tables.py
2025-08-29 12:28:24,547 - INFO - 工作目录: D:\JA\database
2025-08-29 12:29:10,529 - INFO - [4_merge_calc_tables.py] 开始导出数据...
2025-08-29 12:29:10,529 - INFO - [4_merge_calc_tables.py] 输出目录: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\00汇总表
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_1_扬州 已导出到Sheet: 扬州
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_2_东台 已导出到Sheet: 东台
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_3_合肥 已导出到Sheet: 合肥
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_4_鄂尔多斯 已导出到Sheet: 鄂尔多斯
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_5_曲靖 已导出到Sheet: 曲靖
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_6_奉贤 已导出到Sheet: 奉贤
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_7_包头 已导出到Sheet: 包头
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_8_义乌 已导出到Sheet: 义乌
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_9_邢台 已导出到Sheet: 邢台
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_10_宁晋 已导出到Sheet: 宁晋
2025-08-29 12:29:10,530 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_11_石家庄 已导出到Sheet: 石家庄
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_12_巴彦淖尔 已导出到Sheet: 巴彦淖尔
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 汇总Sheet已创建
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 文件已保存为: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\00汇总表\【合并】计算逻辑_20250829122825.xlsx
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 文件验证成功: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\00汇总表\【合并】计算逻辑_20250829122825.xlsx
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 文件大小: 23567.62 KB
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 导出完成，耗时: 45.01 秒
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] === 导出摘要 ===
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 输出文件: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\00汇总表\【合并】计算逻辑_20250829122825.xlsx
2025-08-29 12:29:10,531 - INFO - [4_merge_calc_tables.py] 包含工作表: 汇总 + 12个基地表
2025-08-29 12:29:12,303 - INFO - 脚本 4_merge_calc_tables.py 成功完成 (返回码: 0)
2025-08-29 12:29:12,303 - INFO - 脚本 4_merge_calc_tables.py 执行完成，继续下一个
2025-08-29 12:29:12,303 - INFO - 结束执行时间: 2025-08-29 12:29:12
2025-08-29 12:29:12,303 - INFO - ==================================================
2025-08-29 15:22:00,907 - INFO - ==================================================
2025-08-29 15:22:00,907 - INFO - 开始执行流水线 - 2025-08-29 15:22:00
2025-08-29 15:22:00,908 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-08-29 15:22:00,908 - INFO - Python版本: 3.12.4 (tags/v3.12.4:8e8a4ba, Jun  6 2024, 19:30:16) [MSC v.1940 64 bit (AMD64)]
2025-08-29 15:22:00,908 - ERROR - 错误: pymysql模块未找到
2025-08-29 15:22:00,908 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-08-29 15:22:00,909 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-08-29 15:22:00,909 - INFO - 工作目录: D:\JA\database
2025-08-29 15:22:00,991 - ERROR - [1_copy_to_local.py] Traceback (most recent call last):
2025-08-29 15:22:00,991 - ERROR - [1_copy_to_local.py] File "D:\JA\database\1_copy_to_local.py", line 1, in <module>
2025-08-29 15:22:00,993 - ERROR - [1_copy_to_local.py] import pymysql
2025-08-29 15:22:00,993 - ERROR - [1_copy_to_local.py] ModuleNotFoundError: No module named 'pymysql'
2025-08-29 15:22:01,003 - ERROR - 脚本 1_copy_to_local.py 失败 (返回码: 1)
2025-08-29 15:22:01,003 - ERROR - 检测到失败，停止后续执行
2025-08-29 15:22:01,003 - INFO - 结束执行时间: 2025-08-29 15:22:01
2025-08-29 15:22:01,004 - INFO - ==================================================
2025-09-01 10:22:27,793 - INFO - ==================================================
2025-09-01 10:22:27,794 - INFO - 开始执行流水线 - 2025-09-01 10:22:27
2025-09-01 10:22:27,794 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-09-01 10:22:27,794 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-09-01 10:22:27,824 - INFO - pymysql版本: 1.4.6
2025-09-01 10:22:27,824 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-09-01 10:22:27,824 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-09-01 10:22:27,824 - INFO - 工作目录: D:\JA\database
2025-09-01 10:22:28,305 - INFO - [1_copy_to_local.py] 开始数据库同步任务: 2025-09-01 10:22:28
2025-09-01 10:22:28,305 - INFO - [1_copy_to_local.py] 开始同步基地: 扬州
2025-09-01 10:22:28,485 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_1_扬州
2025-09-01 10:22:39,672 - INFO - [1_copy_to_local.py] |- 同步完成: 86597 条数据
2025-09-01 10:22:39,672 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_1_扬州
2025-09-01 10:22:40,726 - INFO - [1_copy_to_local.py] |- 同步完成: 8171 条数据
2025-09-01 10:22:40,726 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_1_扬州
2025-09-01 10:22:41,007 - INFO - [1_copy_to_local.py] |- 同步完成: 11363 条数据
2025-09-01 10:22:41,007 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_1_扬州
2025-09-01 10:22:41,086 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-01 10:22:41,086 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_1_扬州
2025-09-01 10:22:41,626 - INFO - [1_copy_to_local.py] |- 同步完成: 8147 条数据
2025-09-01 10:22:41,627 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_1_扬州
2025-09-01 10:22:42,237 - INFO - [1_copy_to_local.py] |- 同步完成: 6051 条数据
2025-09-01 10:22:42,237 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_1_扬州
2025-09-01 10:22:42,715 - INFO - [1_copy_to_local.py] |- 同步完成: 3410 条数据
2025-09-01 10:22:42,720 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 14.42秒
2025-09-01 10:22:42,721 - INFO - [1_copy_to_local.py] 开始同步基地: 东台
2025-09-01 10:22:42,887 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_2_东台
2025-09-01 10:22:50,578 - INFO - [1_copy_to_local.py] |- 同步完成: 77532 条数据
2025-09-01 10:22:50,578 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_2_东台
2025-09-01 10:22:51,256 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-01 10:22:51,256 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_2_东台
2025-09-01 10:22:51,416 - INFO - [1_copy_to_local.py] |- 同步完成: 5767 条数据
2025-09-01 10:22:51,416 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_2_东台
2025-09-01 10:22:51,487 - INFO - [1_copy_to_local.py] |- 同步完成: 12 条数据
2025-09-01 10:22:51,487 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_2_东台
2025-09-01 10:22:51,833 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-01 10:22:51,834 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_2_东台
2025-09-01 10:22:52,209 - INFO - [1_copy_to_local.py] |- 同步完成: 4604 条数据
2025-09-01 10:22:52,209 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_2_东台
2025-09-01 10:22:52,414 - INFO - [1_copy_to_local.py] |- 同步完成: 1921 条数据
2025-09-01 10:22:52,416 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 9.70秒
2025-09-01 10:22:52,418 - INFO - [1_copy_to_local.py] 开始同步基地: 合肥
2025-09-01 10:23:00,567 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_3_合肥
2025-09-01 10:23:02,775 - INFO - [1_copy_to_local.py] |- 同步完成: 41670 条数据
2025-09-01 10:23:02,775 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_3_合肥
2025-09-01 10:23:03,096 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-01 10:23:03,096 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_3_合肥
2025-09-01 10:23:03,203 - INFO - [1_copy_to_local.py] |- 同步完成: 2417 条数据
2025-09-01 10:23:03,203 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_3_合肥
2025-09-01 10:23:03,277 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-01 10:23:03,278 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_3_合肥
2025-09-01 10:23:03,409 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-01 10:23:03,409 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_3_合肥
2025-09-01 10:23:03,575 - INFO - [1_copy_to_local.py] |- 同步完成: 2023 条数据
2025-09-01 10:23:03,575 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_3_合肥
2025-09-01 10:23:03,681 - INFO - [1_copy_to_local.py] |- 同步完成: 855 条数据
2025-09-01 10:23:03,684 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 11.27秒
2025-09-01 10:23:03,684 - INFO - [1_copy_to_local.py] 开始同步基地: 鄂尔多斯
2025-09-01 10:23:11,800 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_4_鄂尔多斯
2025-09-01 10:23:13,968 - INFO - [1_copy_to_local.py] |- 同步完成: 14164 条数据
2025-09-01 10:23:13,968 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_4_鄂尔多斯
2025-09-01 10:23:14,088 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-01 10:23:14,088 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_4_鄂尔多斯
2025-09-01 10:23:14,146 - INFO - [1_copy_to_local.py] |- 同步完成: 484 条数据
2025-09-01 10:23:14,146 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_4_鄂尔多斯
2025-09-01 10:23:14,201 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-01 10:23:14,201 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_4_鄂尔多斯
2025-09-01 10:23:14,262 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-01 10:23:14,263 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_4_鄂尔多斯
2025-09-01 10:23:14,395 - INFO - [1_copy_to_local.py] |- 同步完成: 794 条数据
2025-09-01 10:23:14,395 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_4_鄂尔多斯
2025-09-01 10:23:14,457 - INFO - [1_copy_to_local.py] |- 同步完成: 152 条数据
2025-09-01 10:23:14,458 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 10.77秒
2025-09-01 10:23:14,459 - INFO - [1_copy_to_local.py] 开始同步基地: 曲靖
2025-09-01 10:23:14,748 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_5_曲靖
2025-09-01 10:23:19,661 - INFO - [1_copy_to_local.py] |- 同步完成: 82370 条数据
2025-09-01 10:23:19,661 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_5_曲靖
2025-09-01 10:23:20,528 - INFO - [1_copy_to_local.py] |- 同步完成: 8315 条数据
2025-09-01 10:23:20,528 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_5_曲靖
2025-09-01 10:23:20,862 - INFO - [1_copy_to_local.py] |- 同步完成: 14880 条数据
2025-09-01 10:23:20,862 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_5_曲靖
2025-09-01 10:23:20,989 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-01 10:23:20,989 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_5_曲靖
2025-09-01 10:23:21,427 - INFO - [1_copy_to_local.py] |- 同步完成: 8316 条数据
2025-09-01 10:23:21,427 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_5_曲靖
2025-09-01 10:23:22,210 - INFO - [1_copy_to_local.py] |- 同步完成: 13973 条数据
2025-09-01 10:23:22,210 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_5_曲靖
2025-09-01 10:23:22,567 - INFO - [1_copy_to_local.py] |- 同步完成: 2491 条数据
2025-09-01 10:23:22,575 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 8.12秒
2025-09-01 10:23:22,577 - INFO - [1_copy_to_local.py] 开始同步基地: 奉贤
2025-09-01 10:23:22,752 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_6_奉贤
2025-09-01 10:23:23,320 - INFO - [1_copy_to_local.py] |- 同步完成: 6128 条数据
2025-09-01 10:23:23,320 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_6_奉贤
2025-09-01 10:23:23,452 - INFO - [1_copy_to_local.py] |- 同步完成: 614 条数据
2025-09-01 10:23:23,452 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_6_奉贤
2025-09-01 10:23:23,541 - INFO - [1_copy_to_local.py] |- 同步完成: 749 条数据
2025-09-01 10:23:23,541 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_6_奉贤
2025-09-01 10:23:23,631 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-01 10:23:23,631 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_6_奉贤
2025-09-01 10:23:23,727 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-09-01 10:23:23,727 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_6_奉贤
2025-09-01 10:23:23,837 - INFO - [1_copy_to_local.py] |- 同步完成: 667 条数据
2025-09-01 10:23:23,837 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_6_奉贤
2025-09-01 10:23:23,939 - INFO - [1_copy_to_local.py] |- 同步完成: 274 条数据
2025-09-01 10:23:23,940 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.36秒
2025-09-01 10:23:23,940 - INFO - [1_copy_to_local.py] 开始同步基地: 包头
2025-09-01 10:23:24,049 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_7_包头
2025-09-01 10:23:27,016 - INFO - [1_copy_to_local.py] |- 同步完成: 60067 条数据
2025-09-01 10:23:27,016 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_7_包头
2025-09-01 10:23:27,439 - INFO - [1_copy_to_local.py] |- 同步完成: 5228 条数据
2025-09-01 10:23:27,439 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_7_包头
2025-09-01 10:23:27,610 - INFO - [1_copy_to_local.py] |- 同步完成: 7861 条数据
2025-09-01 10:23:27,610 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_7_包头
2025-09-01 10:23:27,672 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-01 10:23:27,672 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_7_包头
2025-09-01 10:23:27,931 - INFO - [1_copy_to_local.py] |- 同步完成: 5228 条数据
2025-09-01 10:23:27,931 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_7_包头
2025-09-01 10:23:28,204 - INFO - [1_copy_to_local.py] |- 同步完成: 5828 条数据
2025-09-01 10:23:28,204 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_7_包头
2025-09-01 10:23:28,381 - INFO - [1_copy_to_local.py] |- 同步完成: 2019 条数据
2025-09-01 10:23:28,385 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 4.44秒
2025-09-01 10:23:28,386 - INFO - [1_copy_to_local.py] 开始同步基地: 义乌
2025-09-01 10:23:28,596 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_8_义乌
2025-09-01 10:23:29,286 - INFO - [1_copy_to_local.py] |- 同步完成: 9645 条数据
2025-09-01 10:23:29,286 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_8_义乌
2025-09-01 10:23:29,436 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-01 10:23:29,436 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_8_义乌
2025-09-01 10:23:29,555 - INFO - [1_copy_to_local.py] |- 同步完成: 1467 条数据
2025-09-01 10:23:29,556 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_8_义乌
2025-09-01 10:23:29,644 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-01 10:23:29,644 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_8_义乌
2025-09-01 10:23:29,779 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-01 10:23:29,779 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_8_义乌
2025-09-01 10:23:29,970 - INFO - [1_copy_to_local.py] |- 同步完成: 2776 条数据
2025-09-01 10:23:29,970 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_8_义乌
2025-09-01 10:23:30,065 - INFO - [1_copy_to_local.py] |- 同步完成: 4 条数据
2025-09-01 10:23:30,066 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.68秒
2025-09-01 10:23:30,066 - INFO - [1_copy_to_local.py] 开始同步基地: 邢台
2025-09-01 10:23:30,189 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_9_邢台
2025-09-01 10:23:30,700 - INFO - [1_copy_to_local.py] |- 同步完成: 7098 条数据
2025-09-01 10:23:30,700 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_9_邢台
2025-09-01 10:23:30,797 - INFO - [1_copy_to_local.py] |- 同步完成: 483 条数据
2025-09-01 10:23:30,797 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_9_邢台
2025-09-01 10:23:30,879 - INFO - [1_copy_to_local.py] |- 同步完成: 933 条数据
2025-09-01 10:23:30,879 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_9_邢台
2025-09-01 10:23:30,949 - INFO - [1_copy_to_local.py] |- 同步完成: 5 条数据
2025-09-01 10:23:30,949 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_9_邢台
2025-09-01 10:23:31,034 - INFO - [1_copy_to_local.py] |- 同步完成: 483 条数据
2025-09-01 10:23:31,034 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_9_邢台
2025-09-01 10:23:31,122 - INFO - [1_copy_to_local.py] |- 同步完成: 741 条数据
2025-09-01 10:23:31,122 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_9_邢台
2025-09-01 10:23:31,201 - INFO - [1_copy_to_local.py] |- 同步完成: 266 条数据
2025-09-01 10:23:31,202 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.14秒
2025-09-01 10:23:31,203 - INFO - [1_copy_to_local.py] 开始同步基地: 宁晋
2025-09-01 10:23:31,306 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_10_宁晋
2025-09-01 10:23:32,905 - INFO - [1_copy_to_local.py] |- 同步完成: 25724 条数据
2025-09-01 10:23:32,905 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_10_宁晋
2025-09-01 10:23:33,218 - INFO - [1_copy_to_local.py] |- 同步完成: 1238 条数据
2025-09-01 10:23:33,218 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_10_宁晋
2025-09-01 10:23:33,293 - INFO - [1_copy_to_local.py] |- 同步完成: 1933 条数据
2025-09-01 10:23:33,293 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_10_宁晋
2025-09-01 10:23:33,344 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-01 10:23:33,344 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_10_宁晋
2025-09-01 10:23:33,442 - INFO - [1_copy_to_local.py] |- 同步完成: 1238 条数据
2025-09-01 10:23:33,442 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_10_宁晋
2025-09-01 10:23:33,532 - INFO - [1_copy_to_local.py] |- 同步完成: 850 条数据
2025-09-01 10:23:33,533 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_10_宁晋
2025-09-01 10:23:33,600 - INFO - [1_copy_to_local.py] |- 同步完成: 377 条数据
2025-09-01 10:23:33,601 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 2.40秒
2025-09-01 10:23:33,601 - INFO - [1_copy_to_local.py] 开始同步基地: 石家庄
2025-09-01 10:23:33,700 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_11_石家庄
2025-09-01 10:23:39,185 - INFO - [1_copy_to_local.py] |- 同步完成: 82182 条数据
2025-09-01 10:23:39,185 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_11_石家庄
2025-09-01 10:23:39,620 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-09-01 10:23:39,621 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_11_石家庄
2025-09-01 10:23:39,801 - INFO - [1_copy_to_local.py] |- 同步完成: 9846 条数据
2025-09-01 10:23:39,801 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_11_石家庄
2025-09-01 10:23:39,853 - INFO - [1_copy_to_local.py] |- 同步完成: 16 条数据
2025-09-01 10:23:39,853 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_11_石家庄
2025-09-01 10:23:40,064 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-09-01 10:23:40,064 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_11_石家庄
2025-09-01 10:23:40,374 - INFO - [1_copy_to_local.py] |- 同步完成: 6433 条数据
2025-09-01 10:23:40,374 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_11_石家庄
2025-09-01 10:23:40,482 - INFO - [1_copy_to_local.py] |- 同步完成: 1208 条数据
2025-09-01 10:23:40,484 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 6.88秒
2025-09-01 10:23:40,486 - INFO - [1_copy_to_local.py] 开始同步基地: 巴彦淖尔
2025-09-01 10:23:40,644 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_12_巴彦淖尔
2025-09-01 10:23:40,996 - INFO - [1_copy_to_local.py] |- 同步完成: 2119 条数据
2025-09-01 10:23:40,996 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_12_巴彦淖尔
2025-09-01 10:23:41,069 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-01 10:23:41,069 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_12_巴彦淖尔
2025-09-01 10:23:41,135 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-01 10:23:41,135 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_12_巴彦淖尔
2025-09-01 10:23:41,198 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-01 10:23:41,198 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_12_巴彦淖尔
2025-09-01 10:23:41,264 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-01 10:23:41,264 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_12_巴彦淖尔
2025-09-01 10:23:41,351 - INFO - [1_copy_to_local.py] |- 同步完成: 158 条数据
2025-09-01 10:23:41,351 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_12_巴彦淖尔
2025-09-01 10:23:41,446 - INFO - [1_copy_to_local.py] |- 同步完成: 157 条数据
2025-09-01 10:23:41,447 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 0.96秒
2025-09-01 10:23:41,448 - INFO - [1_copy_to_local.py] 所有同步任务完成: 2025-09-01 10:23:41
2025-09-01 10:23:41,510 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-09-01 10:23:41,510 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-09-01 10:23:41,510 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-09-01 10:23:41,510 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-09-01 10:23:41,510 - INFO - 工作目录: D:\JA\database
2025-09-01 10:23:42,086 - INFO - [2_table_aggregator.py] 开始数据聚合流程...
2025-09-01 10:23:42,086 - INFO - [2_table_aggregator.py] 加载配置文件: 2_table_aggregator_config.json
2025-09-01 10:23:42,210 - INFO - [2_table_aggregator.py] 数据库连接成功
2025-09-01 10:23:42,212 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_1_扬州
2025-09-01 10:23:42,221 - INFO - [2_table_aggregator.py] 表 1_汇总表_1_扬州 创建成功
2025-09-01 10:23:42,221 - INFO - [2_table_aggregator.py] 正在为基地 扬州 执行数据聚合...
2025-09-01 10:23:42,223 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:42,228 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_1_扬州' 行数: 11363
2025-09-01 10:23:42,254 - INFO - [2_table_aggregator.py] a表 'a采集点表_1_扬州' 行数: 86597
2025-09-01 10:23:42,263 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_1_扬州' 行数: 8171
2025-09-01 10:23:42,265 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:42,267 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:42,267 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:42,352 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('扬州基地', '一厂（晶运园区）-F3电池车间'), ('扬州基地', '一厂（晶运园区）-F2电池车间'), ('扬州基地', '一厂（晶运园区）-动力站F3'), ('扬州基地', '二厂（晶山园区）-晶山组件（M3）'), ('扬州基地', '一厂（晶运园区）-动力站-配电室')]
2025-09-01 10:23:42,613 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:42,614 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:42,628 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:43,259 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_1_扬州
2025-09-01 10:23:43,259 - INFO - [2_table_aggregator.py] 原始表c的行数: 11363
2025-09-01 10:23:43,259 - INFO - [2_table_aggregator.py] 汇总表的行数: 11363
2025-09-01 10:23:43,259 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-01 10:23:43,260 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-01 10:23:43,260 - INFO - [2_table_aggregator.py] 行 1: ('LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '耗电', '7', '电池车间LPCVD自动化312#电能', '电池车间LPCVD自动化312', 'YZ-002-DC-58-206-0037#AE0005-FV', '85262', 'LPCVD自动化312（JAYZ2438173）', '90002', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-58-206-0037', '通过', '反馈值', '能耗类', '正向有功电度', 'LPCVD自动化', 'LPCVD自动化', '1', 'LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000250', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', 'LPCVD')
2025-09-01 10:23:43,260 - INFO - [2_table_aggregator.py] 行 2: ('硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '耗电', '7', '电池车间硼扩自动化317#电能', '电池车间硼扩自动化317', 'YZ-002-DC-43-156-0039#AE0005-FV', '85636', '硼扩自动化317（JAYZ23C7297）', '89886', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-43-156-0039', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩自动化', '硼扩自动化', '1', '硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000134', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', '硼扩')
2025-09-01 10:23:43,260 - INFO - [2_table_aggregator.py] 行 3: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-01 10:23:43,260 - INFO - [2_table_aggregator.py] 行 4: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-01 10:23:43,260 - INFO - [2_table_aggregator.py] 行 5: ('背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '运行状态', None, '电池车间背膜主机307#炉管5#设备运行状态', '电池车间背膜主机307', 'YZ-002-DC-53-175-0040#SN0005-RS', '90931', '背膜主机307（JAYZ2417811）', '90116', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-53-175-0040', '通过', '运行状态', '信号类', '状态信号', '背膜主机', '背膜主机', '1', '背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000358', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '背膜')
2025-09-01 10:23:43,262 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:43,262 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_2_东台
2025-09-01 10:23:43,272 - INFO - [2_table_aggregator.py] 表 1_汇总表_2_东台 创建成功
2025-09-01 10:23:43,272 - INFO - [2_table_aggregator.py] 正在为基地 东台 执行数据聚合...
2025-09-01 10:23:43,273 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:43,276 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_2_东台' 行数: 5767
2025-09-01 10:23:43,298 - INFO - [2_table_aggregator.py] a表 'a采集点表_2_东台' 行数: 77532
2025-09-01 10:23:43,306 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_2_东台' 行数: 5131
2025-09-01 10:23:43,307 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:43,307 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:43,307 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:43,346 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('东台基地', '一厂-电池车间1'), ('东台基地', '一厂-组件车间1'), ('东台基地', '一厂动力站'), ('东台基地', '一厂办公区'), ('东台基地', '其他区域')]
2025-09-01 10:23:43,395 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:43,395 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:43,409 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:43,831 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_2_东台
2025-09-01 10:23:43,831 - INFO - [2_table_aggregator.py] 原始表c的行数: 5767
2025-09-01 10:23:43,831 - INFO - [2_table_aggregator.py] 汇总表的行数: 5767
2025-09-01 10:23:43,831 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-01 10:23:43,832 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-01 10:23:43,832 - INFO - [2_table_aggregator.py] 行 1: ('BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '产量', '0', 'BSG上料2号机#产量下料', 'BSG上料2号机', 'DT-001-DC-45-160-0002#YE0004-FV', '384554', 'BSG下料-BSGX1002', '512016', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0002', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-01 10:23:43,832 - INFO - [2_table_aggregator.py] 行 2: ('BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '产量', '0', 'BSG上料4号机#产量下料', 'BSG上料4号机', 'DT-001-DC-45-160-0003#YE0004-FV', '384544', 'BSG下料-BSGX1004', '512018', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0003', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-01 10:23:43,832 - INFO - [2_table_aggregator.py] 行 3: ('BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '产量', '0', 'BSG上料6号机#产量下料', 'BSG上料6号机', 'DT-001-DC-45-160-0004#YE0004-FV', '384586', 'BSG下料-BSGX1006', '512019', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0004', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-01 10:23:43,832 - INFO - [2_table_aggregator.py] 行 4: ('BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '产量', '0', 'BSG上料8号机#产量下料', 'BSG上料8号机', 'DT-001-DC-45-160-0006#YE0004-FV', '384562', 'BSG下料-BSGX1008', '512022', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0006', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-01 10:23:43,832 - INFO - [2_table_aggregator.py] 行 5: ('BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '产量', '0', 'BSG上料12号机#产量下料', 'BSG上料12号机', 'DT-001-DC-45-160-0008#YE0004-FV', '384488', 'BSG下料-BSGX1012', '512025', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0008', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-01 10:23:43,832 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:43,834 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_3_合肥
2025-09-01 10:23:43,843 - INFO - [2_table_aggregator.py] 表 1_汇总表_3_合肥 创建成功
2025-09-01 10:23:43,843 - INFO - [2_table_aggregator.py] 正在为基地 合肥 执行数据聚合...
2025-09-01 10:23:43,844 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:43,846 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_3_合肥' 行数: 2417
2025-09-01 10:23:43,866 - INFO - [2_table_aggregator.py] a表 'a采集点表_3_合肥' 行数: 41670
2025-09-01 10:23:43,870 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_3_合肥' 行数: 1890
2025-09-01 10:23:43,870 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:43,871 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:43,871 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:43,880 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('合肥基地', '二厂（二部）-六车间（201#智慧工厂）'), ('合肥基地', '一厂（一部）-二车间（116#创新工厂）'), ('合肥基地', '207动力站'), ('合肥基地', '207动力站-配电室'), ('合肥基地', '一厂（一部）-四车间（110#领跑工厂）-配电室')]
2025-09-01 10:23:43,888 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:43,888 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:43,900 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:44,073 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_3_合肥
2025-09-01 10:23:44,073 - INFO - [2_table_aggregator.py] 原始表c的行数: 2417
2025-09-01 10:23:44,073 - INFO - [2_table_aggregator.py] 汇总表的行数: 2417
2025-09-01 10:23:44,073 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-01 10:23:44,073 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-01 10:23:44,073 - INFO - [2_table_aggregator.py] 行 1: ('二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '耗电', '7', '智慧工厂一-6BL15002-总有功电度', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#AE0003-FV', '10', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000048', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-01 10:23:44,073 - INFO - [2_table_aggregator.py] 行 2: ('二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '产量', '0', '智慧工厂一-6BL15002-产量', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#YE0005-FV', '12', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '统计类', '产量', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000049', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-01 10:23:44,073 - INFO - [2_table_aggregator.py] 行 3: ('二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '运行状态', None, '智慧工厂一-6BL15002运行状态', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#SN0002-RS', '9', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'HF-EMC-RS-E-NS-NS-000000049', '设备管控', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-01 10:23:44,075 - INFO - [2_table_aggregator.py] 行 4: ('二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '耗电', '7', '智慧工厂一-6CQ13002-总有功电度', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#AE0001-FV', '759', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000078', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-01 10:23:44,075 - INFO - [2_table_aggregator.py] 行 5: ('二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '产量', '0', '智慧工厂一-6CQ13002-产量', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#YE0002-FV', '760', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '统计类', '产量', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000079', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-01 10:23:44,075 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:44,076 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_4_鄂尔多斯
2025-09-01 10:23:44,086 - INFO - [2_table_aggregator.py] 表 1_汇总表_4_鄂尔多斯 创建成功
2025-09-01 10:23:44,086 - INFO - [2_table_aggregator.py] 正在为基地 鄂尔多斯 执行数据聚合...
2025-09-01 10:23:44,087 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:44,089 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_4_鄂尔多斯' 行数: 484
2025-09-01 10:23:44,103 - INFO - [2_table_aggregator.py] a表 'a采集点表_4_鄂尔多斯' 行数: 14164
2025-09-01 10:23:44,106 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_4_鄂尔多斯' 行数: 310
2025-09-01 10:23:44,106 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:44,107 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:44,107 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:44,120 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('鄂尔多斯', '二厂（B区）-B4-5GW组件车间2'), ('', '二厂（B区）-B4-5GW组件车间2')]
2025-09-01 10:23:44,124 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:44,124 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:44,137 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:44,197 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_4_鄂尔多斯
2025-09-01 10:23:44,197 - INFO - [2_table_aggregator.py] 原始表c的行数: 484
2025-09-01 10:23:44,197 - INFO - [2_table_aggregator.py] 汇总表的行数: 484
2025-09-01 10:23:44,197 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-01 10:23:44,197 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-01 10:23:44,197 - INFO - [2_table_aggregator.py] 行 1: ('2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '运行状态', None, '2#串焊机01状态', '2#串焊机01', 'EE-019-ZJ-61-224-0002#SN0003-RS', '1143', '2#串焊机01（JAEEDS2020087）', '162', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0002', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000004', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-01 10:23:44,197 - INFO - [2_table_aggregator.py] 行 2: ('2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '运行状态', None, '2#串焊机02状态', '2#串焊机02', 'EE-019-ZJ-61-224-0001#SN0005-RS', '1132', '2#串焊机02（JAEEDS2020088）', '160', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0001', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-01 10:23:44,197 - INFO - [2_table_aggregator.py] 行 3: ('2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '运行状态', None, '2#串焊机03状态', '2#串焊机03', 'EE-019-ZJ-61-224-0004#SN0004-RS', '1161', '2#串焊机03（JAEEDS2020089）', '167', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0004', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000006', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-01 10:23:44,198 - INFO - [2_table_aggregator.py] 行 4: ('2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '运行状态', None, '2#串焊机04状态', '2#串焊机04', 'EE-019-ZJ-61-224-0003#SN0001-RS', '1149', '2#串焊机04（JAEEDS2020090）', '164', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0003', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-01 10:23:44,198 - INFO - [2_table_aggregator.py] 行 5: ('1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '产量', '0', '1#二道胶膜裁切机产量', '1#二道胶膜裁切机02', 'EE-019-ZJ-61-228-0001#YE0001-FV', '1115', '1#二道胶膜裁切机02（JAEEDS2020026）', '155', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-228-0001', '通过', '反馈值', '统计类', '产量', '裁切机', '裁切机', '1', '1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'EE-EMS-YE-E-NS-NS-000000016', '能源管理', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-01 10:23:44,200 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:44,200 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_5_曲靖
2025-09-01 10:23:44,212 - INFO - [2_table_aggregator.py] 表 1_汇总表_5_曲靖 创建成功
2025-09-01 10:23:44,212 - INFO - [2_table_aggregator.py] 正在为基地 曲靖 执行数据聚合...
2025-09-01 10:23:44,213 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:44,217 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_5_曲靖' 行数: 14880
2025-09-01 10:23:44,241 - INFO - [2_table_aggregator.py] a表 'a采集点表_5_曲靖' 行数: 82370
2025-09-01 10:23:44,251 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_5_曲靖' 行数: 8315
2025-09-01 10:23:44,252 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:44,253 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:44,253 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:44,266 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('曲靖基地', '三厂（三期）-电池一期车间（101）'), ('曲靖基地', '二厂（二期）-201拉晶车间'), ('曲靖基地', '二厂（二期）-201加工车间'), ('曲靖基地', '三厂（三期）-组件一期车间（104）'), ('曲靖基地', '二厂（二期）-202拉晶车间')]
2025-09-01 10:23:44,279 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:44,279 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:44,294 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:44,993 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_5_曲靖
2025-09-01 10:23:44,993 - INFO - [2_table_aggregator.py] 原始表c的行数: 14880
2025-09-01 10:23:44,993 - INFO - [2_table_aggregator.py] 汇总表的行数: 14887
2025-09-01 10:23:44,993 - INFO - [2_table_aggregator.py] 警告: 行数不一致! 可能丢失了 -7 行数据
2025-09-01 10:23:44,993 - INFO - [2_table_aggregator.py] 建议检查连接条件和数据完整性
2025-09-01 10:23:44,994 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-01 10:23:44,994 - INFO - [2_table_aggregator.py] 行 1: ('西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '运行状态', None, '西区POLY尾气处理B19#运行状态', '西区POLY尾气处理B19', 'QJ-028-DC-56-199-0039#SN0001-RS', '1070', '西区POLY尾气处理B19（QJJAKJ12021493）', '145', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0039', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-01 10:23:44,994 - INFO - [2_table_aggregator.py] 行 2: ('西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '运行状态', None, '西区ALD尾气处理B01#运行状态', '西区ALD尾气处理B01', 'QJ-028-DC-56-199-0044#SN0001-RS', '1110', '西区ALD尾气处理B01（QJJAKJ12021632）', '151', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0044', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-01 10:23:44,994 - INFO - [2_table_aggregator.py] 行 3: ('西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '运行状态', None, '西区ALD尾气处理B02#运行状态', '西区ALD尾气处理B02', 'QJ-028-DC-56-199-0045#SN0001-RS', '1118', '西区ALD尾气处理B02（QJJAKJ12021633）', '152', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0045', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-01 10:23:44,994 - INFO - [2_table_aggregator.py] 行 4: ('西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '运行状态', None, '西区ALD尾气处理B03#运行状态', '西区ALD尾气处理B03', 'QJ-028-DC-56-199-0046#SN0001-RS', '1126', '西区ALD尾气处理B03（QJJAKJ120216334）', '153', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0046', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-01 10:23:44,996 - INFO - [2_table_aggregator.py] 行 5: ('西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '运行状态', None, '西区ALD尾气处理B04#运行状态', '西区ALD尾气处理B04', 'QJ-028-DC-56-199-0001#SN0001-RS', '8', '西区ALD尾气处理B04（QJJAKJ120216335）', '5', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0001', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000009', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-01 10:23:44,996 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:44,996 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_6_奉贤
2025-09-01 10:23:45,003 - INFO - [2_table_aggregator.py] 表 1_汇总表_6_奉贤 创建成功
2025-09-01 10:23:45,003 - INFO - [2_table_aggregator.py] 正在为基地 奉贤 执行数据聚合...
2025-09-01 10:23:45,003 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:45,006 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_6_奉贤' 行数: 749
2025-09-01 10:23:45,016 - INFO - [2_table_aggregator.py] a表 'a采集点表_6_奉贤' 行数: 6128
2025-09-01 10:23:45,018 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_6_奉贤' 行数: 614
2025-09-01 10:23:45,019 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:45,019 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:45,020 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:45,022 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('奉贤基地', '一厂-B2组件车间（北区）'), ('奉贤基地', '一厂-B1储能车间'), ('奉贤基地', '厂外-C2接线盒车间'), ('奉贤基地', 'E2动力站'), ('奉贤基地', '35KV变电站')]
2025-09-01 10:23:45,026 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:45,026 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:45,038 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:45,091 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_6_奉贤
2025-09-01 10:23:45,091 - INFO - [2_table_aggregator.py] 原始表c的行数: 749
2025-09-01 10:23:45,091 - INFO - [2_table_aggregator.py] 汇总表的行数: 749
2025-09-01 10:23:45,092 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-01 10:23:45,092 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-01 10:23:45,092 - INFO - [2_table_aggregator.py] 行 1: ('自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '运行状态', None, '装工装_201_PLC#运行状态', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#SN0001-RS', '162', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '通过', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-01 10:23:45,092 - INFO - [2_table_aggregator.py] 行 2: ('自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '耗电', '7', '装工装_201_PLC#总有功电度', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#AE0004-FV', '165', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-01 10:23:45,092 - INFO - [2_table_aggregator.py] 行 3: ('在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '运行状态', None, '裁切机_501_PLC#运行状态', '裁切机_501_PLC', 'FX-002-ZJ-61-228-0001#SN0001-RS', '153', '在线裁切机一道-FX02CQ0501', '29', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-61-228-0001', '通过', '运行状态', '信号类', '状态信号', '一道EVA裁切机', '一道EVA裁切机', '1', '在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000079', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '焊接')
2025-09-01 10:23:45,092 - INFO - [2_table_aggregator.py] 行 4: ('自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '运行状态', None, '装工装_301_PLC#运行状态', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#SN0001-RS', '166', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000112', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-01 10:23:45,092 - INFO - [2_table_aggregator.py] 行 5: ('自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '耗电', '7', '装工装_301_PLC#总有功电度', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#AE0004-FV', '169', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000040', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-01 10:23:45,095 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:45,095 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_7_包头
2025-09-01 10:23:45,105 - INFO - [2_table_aggregator.py] 表 1_汇总表_7_包头 创建成功
2025-09-01 10:23:45,105 - INFO - [2_table_aggregator.py] 正在为基地 包头 执行数据聚合...
2025-09-01 10:23:45,106 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:45,111 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_7_包头' 行数: 7861
2025-09-01 10:23:45,135 - INFO - [2_table_aggregator.py] a表 'a采集点表_7_包头' 行数: 60067
2025-09-01 10:23:45,145 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_7_包头' 行数: 5228
2025-09-01 10:23:45,146 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:45,147 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:45,147 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:45,155 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('包头基地', '二厂-拉晶车间'), ('包头基地', '三厂-拉晶车间'), ('包头基地', '二厂-加工车间'), ('包头基地', '四厂-组件车间'), ('包头基地', '三厂-切片车间-配电室')]
2025-09-01 10:23:45,167 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:45,167 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:45,178 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:45,541 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_7_包头
2025-09-01 10:23:45,542 - INFO - [2_table_aggregator.py] 原始表c的行数: 7861
2025-09-01 10:23:45,542 - INFO - [2_table_aggregator.py] 汇总表的行数: 7861
2025-09-01 10:23:45,542 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-01 10:23:45,542 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-01 10:23:45,542 - INFO - [2_table_aggregator.py] 行 1: ('二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '二厂-拉晶车间单晶炉1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-01 10:23:45,542 - INFO - [2_table_aggregator.py] 行 2: ('二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '产量', '0', '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '二厂-拉晶车间单晶炉1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-01 10:23:45,542 - INFO - [2_table_aggregator.py] 行 3: ('二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '耗电', '7', '单晶炉#电能', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#AE0003-FV', '9643', '二厂-拉晶车间单晶炉1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '反馈值', '能耗类', '正向有功电度', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'BT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-01 10:23:45,542 - INFO - [2_table_aggregator.py] 行 4: ('二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '二厂-拉晶车间单晶炉1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-01 10:23:45,542 - INFO - [2_table_aggregator.py] 行 5: ('二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '产量', '0', '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '二厂-拉晶车间单晶炉1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-01 10:23:45,543 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:45,560 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_8_义乌
2025-09-01 10:23:45,572 - INFO - [2_table_aggregator.py] 表 1_汇总表_8_义乌 创建成功
2025-09-01 10:23:45,572 - INFO - [2_table_aggregator.py] 正在为基地 义乌 执行数据聚合...
2025-09-01 10:23:45,572 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:45,574 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_8_义乌' 行数: 1467
2025-09-01 10:23:45,588 - INFO - [2_table_aggregator.py] a表 'a采集点表_8_义乌' 行数: 9645
2025-09-01 10:23:45,592 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_8_义乌' 行数: 1363
2025-09-01 10:23:45,593 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:45,594 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:45,594 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:45,605 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('义乌基地', '一厂-组件车间一'), ('义乌基地', '仓库'), ('义乌基地', '动力站-配电室'), ('义乌基地', '一厂-电池车间一'), ('义乌基地', '二厂-电池车间二')]
2025-09-01 10:23:45,611 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:45,611 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:45,624 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:45,705 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_8_义乌
2025-09-01 10:23:45,706 - INFO - [2_table_aggregator.py] 原始表c的行数: 1467
2025-09-01 10:23:45,706 - INFO - [2_table_aggregator.py] 汇总表的行数: 1467
2025-09-01 10:23:45,706 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-01 10:23:45,706 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-01 10:23:45,706 - INFO - [2_table_aggregator.py] 行 1: ('1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '运行状态', None, '1上玻璃102-设备状态', 'KEP-HC', 'YW-003-ZJ-61-256-0010#SN0001-RS', '1', '1上玻璃102', '1', '一厂-组件车间一', '003', 'YW-003-ZJ-61-256-0010', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-01 10:23:45,706 - INFO - [2_table_aggregator.py] 行 2: ('1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '运行状态', None, '1汇流条竖起机141-设备状态', 'KEP-HC', 'YW-003-ZJ-60-211-0002#SN0001-RS', '100', '1汇流条竖起机141', '23', '一厂-组件车间一', '003', 'YW-003-ZJ-60-211-0002', '通过', '运行状态', '信号类', '状态信号', '自动捋引线', '自动捋引线', '1', '1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '装框')
2025-09-01 10:23:45,706 - INFO - [2_table_aggregator.py] 行 3: ('1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '运行状态', None, '1层压机101-02-设备状态', 'KEP-HC', 'YW-003-ZJ-62-230-0021#SN0003-RS', '1001', '1层压机101-02', '158', '一厂-组件车间一', '003', 'YW-003-ZJ-62-230-0021', '通过', '运行状态', '信号类', '状态信号', '层压机', '层压机', '1', '1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '层压')
2025-09-01 10:23:45,706 - INFO - [2_table_aggregator.py] 行 4: ('1排版机092-产量', '0#10_003_22#160#Sum', '产量', '0', '1排版机092-设备当班产能', 'KEP-HC', 'YW-003-ZJ-61-227-0015#YE0001-FV', '1004', '1排版机092', '160', '一厂-组件车间一', '003', 'YW-003-ZJ-61-227-0015', '通过', '反馈值', '统计类', '产量', '排版机', '排版机', '1', '1排版机092-产量', '0#10_003_22#160#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'YW-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-01 10:23:45,706 - INFO - [2_table_aggregator.py] 行 5: ('1分档机111-耗电', '7#10_003_22#156#Sum', '耗电', '7', '1分档机111-电量', 'KEP-HC', 'YW-003-ZJ-64-239-0004#AE0005-FV', '1005', '1分档机111', '156', '一厂-组件车间一', '003', 'YW-003-ZJ-64-239-0004', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '1分档机111-耗电', '7#10_003_22#156#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YW-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '包装')
2025-09-01 10:23:45,707 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:45,707 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_9_邢台
2025-09-01 10:23:45,718 - INFO - [2_table_aggregator.py] 表 1_汇总表_9_邢台 创建成功
2025-09-01 10:23:45,718 - INFO - [2_table_aggregator.py] 正在为基地 邢台 执行数据聚合...
2025-09-01 10:23:45,718 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:45,720 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_9_邢台' 行数: 933
2025-09-01 10:23:45,729 - INFO - [2_table_aggregator.py] a表 'a采集点表_9_邢台' 行数: 7098
2025-09-01 10:23:45,731 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_9_邢台' 行数: 483
2025-09-01 10:23:45,732 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:45,733 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:45,733 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:45,742 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('邢台基地', '三厂（三园区）-组件三车间'), ('邢台基地', '二厂（二园区）-组件一车间')]
2025-09-01 10:23:45,747 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:45,747 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:45,760 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:45,825 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_9_邢台
2025-09-01 10:23:45,825 - INFO - [2_table_aggregator.py] 原始表c的行数: 933
2025-09-01 10:23:45,825 - INFO - [2_table_aggregator.py] 汇总表的行数: 933
2025-09-01 10:23:45,825 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-01 10:23:45,826 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-01 10:23:45,826 - INFO - [2_table_aggregator.py] 行 1: ('分档机1FD501-耗电', '7#2_004_22#249#Sum', '耗电', '7', '分档机1FD501#设备当前电能表示数', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#AE0002-FV', '801', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '分档机1FD501-耗电', '7#2_004_22#249#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'XT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '邢台基地', '组件工段', '包装')
2025-09-01 10:23:45,826 - INFO - [2_table_aggregator.py] 行 2: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', '0', '分档机1FD501#设备白班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0004-FV', '805', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-01 10:23:45,826 - INFO - [2_table_aggregator.py] 行 3: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', '0', '分档机1FD501#设备夜班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0005-FV', '807', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-01 10:23:45,826 - INFO - [2_table_aggregator.py] 行 4: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', '0', '裁切机1EC106#设备白班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0002-FV', '249', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-01 10:23:45,826 - INFO - [2_table_aggregator.py] 行 5: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', '0', '裁切机1EC106#设备夜班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0003-FV', '250', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-01 10:23:45,826 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:45,830 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_10_宁晋
2025-09-01 10:23:45,836 - INFO - [2_table_aggregator.py] 表 1_汇总表_10_宁晋 创建成功
2025-09-01 10:23:45,836 - INFO - [2_table_aggregator.py] 正在为基地 宁晋 执行数据聚合...
2025-09-01 10:23:45,837 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:45,839 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_10_宁晋' 行数: 1933
2025-09-01 10:23:45,859 - INFO - [2_table_aggregator.py] a表 'a采集点表_10_宁晋' 行数: 25724
2025-09-01 10:23:45,862 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_10_宁晋' 行数: 1238
2025-09-01 10:23:45,863 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:45,865 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:45,865 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:45,884 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('宁晋基地', '宁晋东城-电池车间'), ('宁晋基地', '宁晋东城-电池车间-配电室'), ('宁晋基地', '动力车间'), ('', '宁晋东城-电池车间')]
2025-09-01 10:23:45,887 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:45,887 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:45,902 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:46,031 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_10_宁晋
2025-09-01 10:23:46,032 - INFO - [2_table_aggregator.py] 原始表c的行数: 1933
2025-09-01 10:23:46,032 - INFO - [2_table_aggregator.py] 汇总表的行数: 1933
2025-09-01 10:23:46,032 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-01 10:23:46,032 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-01 10:23:46,032 - INFO - [2_table_aggregator.py] 行 1: ('制绒下料自动化401-产量', '7#7_001#111#Sum', '产量', '0', '宁晋电池-制绒下料自动化401-PLC---实时累计产出', '宁晋电池-制绒下料自动化401-PLC', 'NJ-001-DC-42-154-0002#YE0003-FV', '877', '制绒下料自动化401', '111', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0002', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化401-产量', '7#7_001#111#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-09-01 10:23:46,032 - INFO - [2_table_aggregator.py] 行 2: ('制绒下料自动化402-产量', '7#7_001#113#Sum', '产量', '0', '宁晋电池-制绒下料自动化402-PLC---实时累计产出', '宁晋电池-制绒下料自动化402-PLC', 'NJ-001-DC-42-154-0004#YE0003-FV', '882', '制绒下料自动化402', '113', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0004', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化402-产量', '7#7_001#113#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-09-01 10:23:46,032 - INFO - [2_table_aggregator.py] 行 3: ('制绒下料自动化403-产量', '7#7_001#115#Sum', '产量', '0', '宁晋电池-制绒下料自动化403-PLC---实时累计产出', '宁晋电池-制绒下料自动化403-PLC', 'NJ-001-DC-42-154-0006#YE0003-FV', '887', '制绒下料自动化403', '115', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0006', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化403-产量', '7#7_001#115#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-09-01 10:23:46,032 - INFO - [2_table_aggregator.py] 行 4: ('制绒下料自动化404-产量', '7#7_001#117#Sum', '产量', '0', '宁晋电池-制绒下料自动化404-PLC---实时累计产出', '宁晋电池-制绒下料自动化404-PLC', 'NJ-001-DC-42-154-0008#YE0003-FV', '892', '制绒下料自动化404', '117', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0008', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化404-产量', '7#7_001#117#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-09-01 10:23:46,032 - INFO - [2_table_aggregator.py] 行 5: ('制绒下料自动化405-产量', '7#7_001#119#Sum', '产量', '0', '宁晋电池-制绒下料自动化405-PLC---实时累计产出', '宁晋电池-制绒下料自动化405-PLC', 'NJ-001-DC-42-154-0010#YE0003-FV', '897', '制绒下料自动化405', '119', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0010', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化405-产量', '7#7_001#119#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-09-01 10:23:46,035 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:46,035 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_11_石家庄
2025-09-01 10:23:46,047 - INFO - [2_table_aggregator.py] 表 1_汇总表_11_石家庄 创建成功
2025-09-01 10:23:46,047 - INFO - [2_table_aggregator.py] 正在为基地 石家庄 执行数据聚合...
2025-09-01 10:23:46,048 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:46,050 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_11_石家庄' 行数: 9846
2025-09-01 10:23:46,067 - INFO - [2_table_aggregator.py] a表 'a采集点表_11_石家庄' 行数: 82182
2025-09-01 10:23:46,068 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_11_石家庄' 行数: 3694
2025-09-01 10:23:46,069 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:46,070 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:46,070 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:46,121 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('石家庄基地', '一厂-动力站'), ('石家庄基地', '一厂-电池一期-配电室'), ('石家庄基地', '一厂-切片一期-配电室'), ('石家庄基地', '一厂-电池一期'), ('石家庄基地', '一厂-切片一期')]
2025-09-01 10:23:46,287 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:46,288 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:46,302 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:46,784 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_11_石家庄
2025-09-01 10:23:46,784 - INFO - [2_table_aggregator.py] 原始表c的行数: 9846
2025-09-01 10:23:46,784 - INFO - [2_table_aggregator.py] 汇总表的行数: 9846
2025-09-01 10:23:46,784 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-01 10:23:46,784 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-01 10:23:46,784 - INFO - [2_table_aggregator.py] 行 1: ('重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '耗电', '7', '78AH07#仪表正向有功总', '动力配电室仪表2.4.6.8', 'SJ-003-ZZ-01-JQ-0207#AE0001-FV', '447079', '78AH07', '519381', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0207', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000480', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-01 10:23:46,784 - INFO - [2_table_aggregator.py] 行 2: ('重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '耗电', '7', '71AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0102#AE0001-FV', '446711', '71AH07', '519013', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0102', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000182', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-01 10:23:46,784 - INFO - [2_table_aggregator.py] 行 3: ('重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '耗电', '7', '75AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0138#AE0001-FV', '446807', '75AH07', '519109', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0138', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000236', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-01 10:23:46,785 - INFO - [2_table_aggregator.py] 行 4: ('重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '耗电', '7', '77AH08#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0155#AE0001-FV', '446871', '77AH08', '519173', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0155', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000483', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-01 10:23:46,785 - INFO - [2_table_aggregator.py] 行 5: ('重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '耗电', '7', '71AH06#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0099#AE0001-FV', '446703', '71AH06', '519005', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0099', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000479', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-01 10:23:46,787 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:46,787 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_12_巴彦淖尔
2025-09-01 10:23:46,795 - INFO - [2_table_aggregator.py] 表 1_汇总表_12_巴彦淖尔 创建成功
2025-09-01 10:23:46,795 - INFO - [2_table_aggregator.py] 正在为基地 巴彦淖尔 执行数据聚合...
2025-09-01 10:23:46,796 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-01 10:23:46,796 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_12_巴彦淖尔' 行数: 0
2025-09-01 10:23:46,798 - INFO - [2_table_aggregator.py] a表 'a采集点表_12_巴彦淖尔' 行数: 2119
2025-09-01 10:23:46,799 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_12_巴彦淖尔' 行数: 0
2025-09-01 10:23:46,800 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 43
2025-09-01 10:23:46,800 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-01 10:23:46,801 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-01 10:23:46,803 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('巴彦淖尔', '一厂（一期）-5GW组件车间')]
2025-09-01 10:23:46,805 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-01 10:23:46,805 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-01 10:23:46,818 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-01 10:23:46,820 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_12_巴彦淖尔
2025-09-01 10:23:46,820 - INFO - [2_table_aggregator.py] 原始表c的行数: 0
2025-09-01 10:23:46,820 - INFO - [2_table_aggregator.py] 汇总表的行数: 0
2025-09-01 10:23:46,820 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-01 10:23:46,820 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-01 10:23:46,820 - INFO - [2_table_aggregator.py] 所有基地数据聚合完成!
2025-09-01 10:23:46,820 - INFO - [2_table_aggregator.py] 数据库连接已关闭
2025-09-01 10:23:46,872 - INFO - 脚本 2_table_aggregator.py 成功完成 (返回码: 0)
2025-09-01 10:23:46,872 - INFO - 脚本 2_table_aggregator.py 执行完成，继续下一个
2025-09-01 10:23:46,872 - INFO - 正在运行脚本: 3_merge_tables.py
2025-09-01 10:23:46,872 - INFO - 开始运行脚本: D:\JA\database\3_merge_tables.py
2025-09-01 10:23:46,872 - INFO - 工作目录: D:\JA\database
2025-09-01 10:23:47,678 - INFO - [3_merge_tables.py] 开始处理 12 个基地...
2025-09-01 10:23:47,695 - INFO - [3_merge_tables.py] 正在处理: 扬州基地...
2025-09-01 10:23:47,695 - INFO - [3_merge_tables.py] 正在处理: 东台基地...
2025-09-01 10:23:47,696 - INFO - [3_merge_tables.py] 正在处理: 合肥基地...
2025-09-01 10:23:47,696 - INFO - [3_merge_tables.py] 正在处理: 鄂尔多斯基地...
2025-09-01 10:23:47,706 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_1_扬州
2025-09-01 10:23:47,707 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_2_东台
2025-09-01 10:23:47,707 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_3_合肥
2025-09-01 10:23:47,708 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-01 10:23:47,708 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_1_扬州
2025-09-01 10:23:47,708 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_2_东台
2025-09-01 10:23:47,709 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_3_合肥
2025-09-01 10:23:47,709 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-01 10:23:47,997 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-01 10:23:48,152 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:23:48,152 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:23:48,157 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\04鄂尔多斯基地\2_采集点+设备合并表_4_鄂尔多斯_20250901102347.xlsx
2025-09-01 10:23:48,561 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_3_合肥
2025-09-01 10:23:48,998 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_2_东台
2025-09-01 10:23:49,040 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_1_扬州
2025-09-01 10:23:51,917 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:23:51,918 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:23:51,939 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\03合肥基地\2_采集点+设备合并表_3_合肥_20250901102347.xlsx
2025-09-01 10:23:56,177 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_4_鄂尔多斯_20250901102347.xlsx
2025-09-01 10:23:56,178 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:24:03,710 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:24:03,711 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:24:03,746 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\02东台基地\2_采集点+设备合并表_2_东台_20250901102347.xlsx
2025-09-01 10:24:13,232 - INFO - [3_merge_tables.py] 正在处理: 曲靖基地...
2025-09-01 10:24:13,303 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_5_曲靖
2025-09-01 10:24:13,306 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_5_曲靖
2025-09-01 10:24:14,103 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_5_曲靖
2025-09-01 10:24:14,598 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:24:14,599 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:24:14,648 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\01扬州基地\2_采集点+设备合并表_1_扬州_20250901102347.xlsx
2025-09-01 10:24:31,831 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_3_合肥_20250901102347.xlsx
2025-09-01 10:24:31,831 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:24:43,464 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:24:43,465 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:24:43,499 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\05曲靖基地\2_采集点+设备合并表_5_曲靖_20250901102347.xlsx
2025-09-01 10:24:57,798 - INFO - [3_merge_tables.py] 正在处理: 奉贤基地...
2025-09-01 10:24:57,802 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_6_奉贤
2025-09-01 10:24:57,803 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_6_奉贤
2025-09-01 10:24:57,841 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_2_东台_20250901102347.xlsx
2025-09-01 10:24:57,841 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:24:57,911 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_6_奉贤
2025-09-01 10:25:00,652 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:25:00,652 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:25:00,669 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\06奉贤基地\2_采集点+设备合并表_6_奉贤_20250901102347.xlsx
2025-09-01 10:25:07,690 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_6_奉贤_20250901102347.xlsx
2025-09-01 10:25:07,694 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:25:17,195 - INFO - [3_merge_tables.py] 正在处理: 包头基地...
2025-09-01 10:25:17,239 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_7_包头
2025-09-01 10:25:17,244 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_7_包头
2025-09-01 10:25:17,798 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_7_包头
2025-09-01 10:25:19,715 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_1_扬州_20250901102347.xlsx
2025-09-01 10:25:19,715 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:25:41,093 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_5_曲靖_20250901102347.xlsx
2025-09-01 10:25:41,096 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:25:49,067 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:25:49,068 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:25:49,111 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\07包头基地\2_采集点+设备合并表_7_包头_20250901102347.xlsx
2025-09-01 10:26:20,268 - INFO - [3_merge_tables.py] 正在处理: 义乌基地...
2025-09-01 10:26:20,296 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_8_义乌
2025-09-01 10:26:20,298 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_8_义乌
2025-09-01 10:26:20,470 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_8_义乌
2025-09-01 10:26:20,696 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:26:20,696 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:26:20,700 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\08义乌基地\2_采集点+设备合并表_8_义乌_20250901102347.xlsx
2025-09-01 10:26:22,341 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_7_包头_20250901102347.xlsx
2025-09-01 10:26:22,343 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:26:29,224 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_8_义乌_20250901102347.xlsx
2025-09-01 10:26:29,226 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:26:38,242 - INFO - [3_merge_tables.py] 处理包头基地时出错: [Errno 13] Permission denied: 'D:\\工作\\PARA\\1.PROJECTS\\【置顶00】各基地计算逻辑和采集点\\07包头基地\\2_采集点+设备合并表_7_包头_20250901102347.xlsx'
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] Traceback (most recent call last):
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] File "D:\JA\database\3_merge_tables.py", line 204, in process_base
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] apply_minimal_formatting(filepath)
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] File "D:\JA\database\3_merge_tables.py", line 38, in apply_minimal_formatting
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] wb.save(filepath)
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] File "D:\JA\database\.venv\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] save_workbook(self, filename)
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] File "D:\JA\database\.venv\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] File "C:\Program Files\Python312\Lib\zipfile\__init__.py", line 1336, in __init__
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] self.fp = io.open(file, filemode)
2025-09-01 10:26:38,244 - ERROR - [3_merge_tables.py] ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-01 10:26:38,245 - ERROR - [3_merge_tables.py] PermissionError: [Errno 13] Permission denied: 'D:\\工作\\PARA\\1.PROJECTS\\【置顶00】各基地计算逻辑和采集点\\07包头基地\\2_采集点+设备合并表_7_包头_20250901102347.xlsx'
2025-09-01 10:26:38,301 - INFO - [3_merge_tables.py] 正在处理: 邢台基地...
2025-09-01 10:26:38,307 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_9_邢台
2025-09-01 10:26:38,309 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_9_邢台
2025-09-01 10:26:38,453 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_9_邢台
2025-09-01 10:26:38,494 - INFO - [3_merge_tables.py] 正在处理: 宁晋基地...
2025-09-01 10:26:38,506 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_10_宁晋
2025-09-01 10:26:38,508 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_10_宁晋
2025-09-01 10:26:38,682 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:26:38,682 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:26:38,737 - INFO - [3_merge_tables.py] 正在处理: 石家庄基地...
2025-09-01 10:26:38,738 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\09邢台基地\2_采集点+设备合并表_9_邢台_20250901102347.xlsx
2025-09-01 10:26:39,020 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_10_宁晋
2025-09-01 10:26:39,248 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_11_石家庄
2025-09-01 10:26:39,365 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_11_石家庄
2025-09-01 10:26:40,385 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_11_石家庄
2025-09-01 10:26:40,694 - INFO - [3_merge_tables.py] 正在处理: 巴彦淖尔基地...
2025-09-01 10:26:40,705 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-01 10:26:40,708 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-01 10:26:40,775 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-01 10:26:40,829 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_9_邢台_20250901102347.xlsx
2025-09-01 10:26:40,829 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:26:41,540 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:26:41,542 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:26:41,554 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\12巴彦淖尔基地\2_采集点+设备合并表_12_巴彦淖尔_20250901102347.xlsx
2025-09-01 10:26:43,387 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_12_巴彦淖尔_20250901102347.xlsx
2025-09-01 10:26:43,387 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:26:44,143 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:26:44,143 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:26:44,157 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\10宁晋基地\2_采集点+设备合并表_10_宁晋_20250901102347.xlsx
2025-09-01 10:26:53,607 - INFO - [3_merge_tables.py] 重命名列
2025-09-01 10:26:53,607 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-01 10:26:53,641 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\11石家庄基地\2_采集点+设备合并表_11_石家庄_20250901102347.xlsx
2025-09-01 10:27:07,437 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_10_宁晋_20250901102347.xlsx
2025-09-01 10:27:07,440 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:27:15,579 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_11_石家庄_20250901102347.xlsx
2025-09-01 10:27:15,579 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-01 10:27:40,153 - INFO - [3_merge_tables.py] 所有基地处理完成! 总耗时: 232.48秒
2025-09-01 10:27:40,153 - INFO - [3_merge_tables.py] 开始合并所有基地文件...
2025-09-01 10:27:40,154 - INFO - [3_merge_tables.py] 正在合并: 扬州基地...
2025-09-01 10:27:55,183 - INFO - [3_merge_tables.py] 正在合并: 东台基地...
2025-09-01 10:28:07,923 - INFO - [3_merge_tables.py] 正在合并: 合肥基地...
2025-09-01 10:28:14,229 - INFO - [3_merge_tables.py] 正在合并: 鄂尔多斯基地...
2025-09-01 10:28:16,733 - INFO - [3_merge_tables.py] 正在合并: 曲靖基地...
2025-09-01 10:28:29,428 - INFO - [3_merge_tables.py] 正在合并: 奉贤基地...
2025-09-01 10:28:30,295 - INFO - [3_merge_tables.py] 正在合并: 义乌基地...
2025-09-01 10:28:31,700 - INFO - [3_merge_tables.py] 正在合并: 邢台基地...
2025-09-01 10:28:33,484 - INFO - [3_merge_tables.py] 正在合并: 宁晋基地...
2025-09-01 10:28:37,081 - INFO - [3_merge_tables.py] 正在合并: 石家庄基地...
2025-09-01 10:28:51,464 - INFO - [3_merge_tables.py] 正在合并: 巴彦淖尔基地...
2025-09-01 10:30:40,395 - INFO - [3_merge_tables.py] 合并完成! 耗时: 180.24秒
2025-09-01 10:30:40,395 - INFO - [3_merge_tables.py] 正在应用基本格式...
2025-09-01 10:34:41,009 - INFO - [3_merge_tables.py] 合并文件已生成: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】采集点+设备_20250901102347.xlsx
2025-09-01 10:34:41,010 - INFO - [3_merge_tables.py] 程序已正常退出
2025-09-01 10:34:58,998 - INFO - 脚本 3_merge_tables.py 成功完成 (返回码: 0)
2025-09-01 10:34:58,998 - INFO - 脚本 3_merge_tables.py 执行完成，继续下一个
2025-09-01 10:34:58,998 - INFO - 正在运行脚本: 4_merge_calc_tables.py
2025-09-01 10:34:58,998 - INFO - 开始运行脚本: D:\JA\database\4_merge_calc_tables.py
2025-09-01 10:34:58,998 - INFO - 工作目录: D:\JA\database
2025-09-01 10:34:59,739 - INFO - [4_merge_calc_tables.py] 开始导出数据...
2025-09-01 10:34:59,739 - INFO - [4_merge_calc_tables.py] 输出目录: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点
2025-09-01 10:35:01,668 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_1_扬州 已导出到Sheet: 扬州
2025-09-01 10:35:02,600 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_2_东台 已导出到Sheet: 东台
2025-09-01 10:35:02,889 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_3_合肥 已导出到Sheet: 合肥
2025-09-01 10:35:02,952 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_4_鄂尔多斯 已导出到Sheet: 鄂尔多斯
2025-09-01 10:35:05,945 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_5_曲靖 已导出到Sheet: 曲靖
2025-09-01 10:35:06,078 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_6_奉贤 已导出到Sheet: 奉贤
2025-09-01 10:35:07,994 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_7_包头 已导出到Sheet: 包头
2025-09-01 10:35:08,267 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_8_义乌 已导出到Sheet: 义乌
2025-09-01 10:35:08,480 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_9_邢台 已导出到Sheet: 邢台
2025-09-01 10:35:08,814 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_10_宁晋 已导出到Sheet: 宁晋
2025-09-01 10:35:10,943 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_11_石家庄 已导出到Sheet: 石家庄
2025-09-01 10:35:10,951 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_12_巴彦淖尔 已导出到Sheet: 巴彦淖尔
2025-09-01 10:35:20,475 - INFO - [4_merge_calc_tables.py] 汇总Sheet已创建
2025-09-01 10:35:51,157 - INFO - [4_merge_calc_tables.py] 文件已保存为: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250901103459.xlsx
2025-09-01 10:35:51,191 - INFO - [4_merge_calc_tables.py] 文件验证成功: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250901103459.xlsx
2025-09-01 10:35:51,191 - INFO - [4_merge_calc_tables.py] 文件大小: 23894.58 KB
2025-09-01 10:35:51,191 - INFO - [4_merge_calc_tables.py] 导出完成，耗时: 51.45 秒
2025-09-01 10:35:51,191 - INFO - [4_merge_calc_tables.py] === 导出摘要 ===
2025-09-01 10:35:51,191 - INFO - [4_merge_calc_tables.py] 输出文件: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250901103459.xlsx
2025-09-01 10:35:51,191 - INFO - [4_merge_calc_tables.py] 包含工作表: 汇总 + 12个基地表
2025-09-01 10:35:52,930 - INFO - 脚本 4_merge_calc_tables.py 成功完成 (返回码: 0)
2025-09-01 10:35:52,931 - INFO - 脚本 4_merge_calc_tables.py 执行完成，继续下一个
2025-09-01 10:35:52,931 - INFO - 结束执行时间: 2025-09-01 10:35:52
2025-09-01 10:35:52,931 - INFO - ==================================================
2025-09-02 15:45:18,450 - INFO - ==================================================
2025-09-02 15:45:18,455 - INFO - 开始执行流水线 - 2025-09-02 15:45:18
2025-09-02 15:45:18,455 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-09-02 15:45:18,455 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-09-02 15:45:18,484 - INFO - pymysql版本: 1.4.6
2025-09-02 15:45:18,484 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-09-02 15:45:18,484 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-09-02 15:45:18,484 - INFO - 工作目录: D:\JA\database
2025-09-02 15:45:18,979 - INFO - [1_copy_to_local.py] 开始数据库同步任务: 2025-09-02 15:45:18
2025-09-02 15:45:18,979 - INFO - [1_copy_to_local.py] 开始同步基地: 扬州
2025-09-02 15:45:19,146 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_1_扬州
2025-09-02 15:45:28,118 - INFO - [1_copy_to_local.py] |- 同步完成: 86597 条数据
2025-09-02 15:45:28,118 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_1_扬州
2025-09-02 15:45:29,041 - INFO - [1_copy_to_local.py] |- 同步完成: 8171 条数据
2025-09-02 15:45:29,041 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_1_扬州
2025-09-02 15:45:29,325 - INFO - [1_copy_to_local.py] |- 同步完成: 11363 条数据
2025-09-02 15:45:29,325 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_1_扬州
2025-09-02 15:45:29,412 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-02 15:45:29,413 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_1_扬州
2025-09-02 15:45:30,030 - INFO - [1_copy_to_local.py] |- 同步完成: 8147 条数据
2025-09-02 15:45:30,030 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_1_扬州
2025-09-02 15:45:30,609 - INFO - [1_copy_to_local.py] |- 同步完成: 6051 条数据
2025-09-02 15:45:30,609 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_1_扬州
2025-09-02 15:45:31,047 - INFO - [1_copy_to_local.py] |- 同步完成: 3410 条数据
2025-09-02 15:45:31,053 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 12.07秒
2025-09-02 15:45:31,054 - INFO - [1_copy_to_local.py] 开始同步基地: 东台
2025-09-02 15:45:31,219 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_2_东台
2025-09-02 15:45:39,368 - INFO - [1_copy_to_local.py] |- 同步完成: 77532 条数据
2025-09-02 15:45:39,368 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_2_东台
2025-09-02 15:45:39,984 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-02 15:45:39,984 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_2_东台
2025-09-02 15:45:40,154 - INFO - [1_copy_to_local.py] |- 同步完成: 5767 条数据
2025-09-02 15:45:40,154 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_2_东台
2025-09-02 15:45:40,224 - INFO - [1_copy_to_local.py] |- 同步完成: 12 条数据
2025-09-02 15:45:40,224 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_2_东台
2025-09-02 15:45:40,546 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-02 15:45:40,546 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_2_东台
2025-09-02 15:45:40,874 - INFO - [1_copy_to_local.py] |- 同步完成: 4618 条数据
2025-09-02 15:45:40,874 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_2_东台
2025-09-02 15:45:41,062 - INFO - [1_copy_to_local.py] |- 同步完成: 1921 条数据
2025-09-02 15:45:41,066 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 10.01秒
2025-09-02 15:45:41,067 - INFO - [1_copy_to_local.py] 开始同步基地: 合肥
2025-09-02 15:45:49,228 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_3_合肥
2025-09-02 15:45:51,083 - INFO - [1_copy_to_local.py] |- 同步完成: 41670 条数据
2025-09-02 15:45:51,083 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_3_合肥
2025-09-02 15:45:51,363 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-02 15:45:51,363 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_3_合肥
2025-09-02 15:45:51,468 - INFO - [1_copy_to_local.py] |- 同步完成: 2417 条数据
2025-09-02 15:45:51,468 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_3_合肥
2025-09-02 15:45:51,542 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-02 15:45:51,542 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_3_合肥
2025-09-02 15:45:51,683 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-02 15:45:51,683 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_3_合肥
2025-09-02 15:45:51,841 - INFO - [1_copy_to_local.py] |- 同步完成: 2023 条数据
2025-09-02 15:45:51,841 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_3_合肥
2025-09-02 15:45:51,950 - INFO - [1_copy_to_local.py] |- 同步完成: 855 条数据
2025-09-02 15:45:51,952 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 10.88秒
2025-09-02 15:45:51,953 - INFO - [1_copy_to_local.py] 开始同步基地: 鄂尔多斯
2025-09-02 15:46:00,097 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_4_鄂尔多斯
2025-09-02 15:46:04,388 - INFO - [1_copy_to_local.py] |- 同步完成: 14164 条数据
2025-09-02 15:46:04,388 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_4_鄂尔多斯
2025-09-02 15:46:04,591 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-02 15:46:04,591 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_4_鄂尔多斯
2025-09-02 15:46:04,708 - INFO - [1_copy_to_local.py] |- 同步完成: 484 条数据
2025-09-02 15:46:04,708 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_4_鄂尔多斯
2025-09-02 15:46:04,779 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-02 15:46:04,779 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_4_鄂尔多斯
2025-09-02 15:46:04,955 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-02 15:46:04,955 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_4_鄂尔多斯
2025-09-02 15:46:05,186 - INFO - [1_copy_to_local.py] |- 同步完成: 794 条数据
2025-09-02 15:46:05,186 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_4_鄂尔多斯
2025-09-02 15:46:05,271 - INFO - [1_copy_to_local.py] |- 同步完成: 152 条数据
2025-09-02 15:46:05,272 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 13.32秒
2025-09-02 15:46:05,273 - INFO - [1_copy_to_local.py] 开始同步基地: 曲靖
2025-09-02 15:46:05,545 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_5_曲靖
2025-09-02 15:46:09,581 - INFO - [1_copy_to_local.py] |- 同步完成: 82370 条数据
2025-09-02 15:46:09,581 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_5_曲靖
2025-09-02 15:46:10,261 - INFO - [1_copy_to_local.py] |- 同步完成: 8315 条数据
2025-09-02 15:46:10,261 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_5_曲靖
2025-09-02 15:46:10,596 - INFO - [1_copy_to_local.py] |- 同步完成: 14880 条数据
2025-09-02 15:46:10,596 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_5_曲靖
2025-09-02 15:46:10,725 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-02 15:46:10,725 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_5_曲靖
2025-09-02 15:46:11,124 - INFO - [1_copy_to_local.py] |- 同步完成: 8316 条数据
2025-09-02 15:46:11,125 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_5_曲靖
2025-09-02 15:46:11,756 - INFO - [1_copy_to_local.py] |- 同步完成: 13973 条数据
2025-09-02 15:46:11,756 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_5_曲靖
2025-09-02 15:46:12,085 - INFO - [1_copy_to_local.py] |- 同步完成: 2491 条数据
2025-09-02 15:46:12,095 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 6.82秒
2025-09-02 15:46:12,097 - INFO - [1_copy_to_local.py] 开始同步基地: 奉贤
2025-09-02 15:46:12,277 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_6_奉贤
2025-09-02 15:46:12,866 - INFO - [1_copy_to_local.py] |- 同步完成: 6128 条数据
2025-09-02 15:46:12,866 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_6_奉贤
2025-09-02 15:46:12,978 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-09-02 15:46:12,979 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_6_奉贤
2025-09-02 15:46:13,065 - INFO - [1_copy_to_local.py] |- 同步完成: 648 条数据
2025-09-02 15:46:13,065 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_6_奉贤
2025-09-02 15:46:13,153 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-02 15:46:13,153 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_6_奉贤
2025-09-02 15:46:13,256 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-09-02 15:46:13,256 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_6_奉贤
2025-09-02 15:46:13,368 - INFO - [1_copy_to_local.py] |- 同步完成: 667 条数据
2025-09-02 15:46:13,369 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_6_奉贤
2025-09-02 15:46:13,463 - INFO - [1_copy_to_local.py] |- 同步完成: 274 条数据
2025-09-02 15:46:13,464 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.37秒
2025-09-02 15:46:13,465 - INFO - [1_copy_to_local.py] 开始同步基地: 包头
2025-09-02 15:46:13,584 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_7_包头
2025-09-02 15:47:06,054 - INFO - [1_copy_to_local.py] |- 同步完成: 60068 条数据
2025-09-02 15:47:06,054 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_7_包头
2025-09-02 15:47:09,055 - INFO - [1_copy_to_local.py] |- 同步完成: 5229 条数据
2025-09-02 15:47:09,055 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_7_包头
2025-09-02 15:47:09,998 - INFO - [1_copy_to_local.py] |- 同步完成: 10402 条数据
2025-09-02 15:47:09,998 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_7_包头
2025-09-02 15:47:10,053 - INFO - [1_copy_to_local.py] |- 同步完成: 10 条数据
2025-09-02 15:47:10,053 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_7_包头
2025-09-02 15:47:12,665 - INFO - [1_copy_to_local.py] |- 同步完成: 5229 条数据
2025-09-02 15:47:12,665 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_7_包头
2025-09-02 15:47:16,065 - INFO - [1_copy_to_local.py] |- 同步完成: 5827 条数据
2025-09-02 15:47:16,065 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_7_包头
2025-09-02 15:47:17,611 - INFO - [1_copy_to_local.py] |- 同步完成: 2019 条数据
2025-09-02 15:47:17,615 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 64.15秒
2025-09-02 15:47:17,616 - INFO - [1_copy_to_local.py] 开始同步基地: 义乌
2025-09-02 15:47:17,811 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_8_义乌
2025-09-02 15:47:20,995 - INFO - [1_copy_to_local.py] |- 同步完成: 9645 条数据
2025-09-02 15:47:20,995 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_8_义乌
2025-09-02 15:47:21,407 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-02 15:47:21,407 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_8_义乌
2025-09-02 15:47:21,514 - INFO - [1_copy_to_local.py] |- 同步完成: 1467 条数据
2025-09-02 15:47:21,515 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_8_义乌
2025-09-02 15:47:21,607 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-02 15:47:21,608 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_8_义乌
2025-09-02 15:47:21,841 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-02 15:47:21,841 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_8_义乌
2025-09-02 15:47:22,348 - INFO - [1_copy_to_local.py] |- 同步完成: 2776 条数据
2025-09-02 15:47:22,348 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_8_义乌
2025-09-02 15:47:22,438 - INFO - [1_copy_to_local.py] |- 同步完成: 4 条数据
2025-09-02 15:47:22,440 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 4.82秒
2025-09-02 15:47:22,440 - INFO - [1_copy_to_local.py] 开始同步基地: 邢台
2025-09-02 15:47:22,615 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_9_邢台
2025-09-02 15:47:23,424 - INFO - [1_copy_to_local.py] |- 同步完成: 8063 条数据
2025-09-02 15:47:23,424 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_9_邢台
2025-09-02 15:47:23,545 - INFO - [1_copy_to_local.py] |- 同步完成: 483 条数据
2025-09-02 15:47:23,545 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_9_邢台
2025-09-02 15:47:23,639 - INFO - [1_copy_to_local.py] |- 同步完成: 933 条数据
2025-09-02 15:47:23,639 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_9_邢台
2025-09-02 15:47:23,728 - INFO - [1_copy_to_local.py] |- 同步完成: 5 条数据
2025-09-02 15:47:23,728 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_9_邢台
2025-09-02 15:47:23,830 - INFO - [1_copy_to_local.py] |- 同步完成: 483 条数据
2025-09-02 15:47:23,831 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_9_邢台
2025-09-02 15:47:23,944 - INFO - [1_copy_to_local.py] |- 同步完成: 744 条数据
2025-09-02 15:47:23,944 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_9_邢台
2025-09-02 15:47:24,045 - INFO - [1_copy_to_local.py] |- 同步完成: 267 条数据
2025-09-02 15:47:24,046 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.61秒
2025-09-02 15:47:24,047 - INFO - [1_copy_to_local.py] 开始同步基地: 宁晋
2025-09-02 15:47:24,255 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_10_宁晋
2025-09-02 15:47:25,905 - INFO - [1_copy_to_local.py] |- 同步完成: 25728 条数据
2025-09-02 15:47:25,906 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_10_宁晋
2025-09-02 15:47:26,099 - INFO - [1_copy_to_local.py] |- 同步完成: 1222 条数据
2025-09-02 15:47:26,099 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_10_宁晋
2025-09-02 15:47:26,231 - INFO - [1_copy_to_local.py] |- 同步完成: 1917 条数据
2025-09-02 15:47:26,231 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_10_宁晋
2025-09-02 15:47:26,323 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-02 15:47:26,323 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_10_宁晋
2025-09-02 15:47:26,451 - INFO - [1_copy_to_local.py] |- 同步完成: 1222 条数据
2025-09-02 15:47:26,451 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_10_宁晋
2025-09-02 15:47:26,567 - INFO - [1_copy_to_local.py] |- 同步完成: 850 条数据
2025-09-02 15:47:26,567 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_10_宁晋
2025-09-02 15:47:26,688 - INFO - [1_copy_to_local.py] |- 同步完成: 377 条数据
2025-09-02 15:47:26,689 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 2.64秒
2025-09-02 15:47:26,689 - INFO - [1_copy_to_local.py] 开始同步基地: 石家庄
2025-09-02 15:47:26,764 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_11_石家庄
2025-09-02 15:47:33,372 - INFO - [1_copy_to_local.py] |- 同步完成: 82183 条数据
2025-09-02 15:47:33,373 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_11_石家庄
2025-09-02 15:47:33,865 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-09-02 15:47:33,865 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_11_石家庄
2025-09-02 15:47:34,056 - INFO - [1_copy_to_local.py] |- 同步完成: 9846 条数据
2025-09-02 15:47:34,056 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_11_石家庄
2025-09-02 15:47:34,133 - INFO - [1_copy_to_local.py] |- 同步完成: 16 条数据
2025-09-02 15:47:34,133 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_11_石家庄
2025-09-02 15:47:34,368 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-09-02 15:47:34,368 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_11_石家庄
2025-09-02 15:47:34,755 - INFO - [1_copy_to_local.py] |- 同步完成: 6433 条数据
2025-09-02 15:47:34,755 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_11_石家庄
2025-09-02 15:47:34,877 - INFO - [1_copy_to_local.py] |- 同步完成: 1208 条数据
2025-09-02 15:47:34,879 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 8.19秒
2025-09-02 15:47:34,881 - INFO - [1_copy_to_local.py] 开始同步基地: 巴彦淖尔
2025-09-02 15:47:35,016 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_12_巴彦淖尔
2025-09-02 15:47:35,520 - INFO - [1_copy_to_local.py] |- 同步完成: 2119 条数据
2025-09-02 15:47:35,520 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_12_巴彦淖尔
2025-09-02 15:47:35,604 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-02 15:47:35,604 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_12_巴彦淖尔
2025-09-02 15:47:35,669 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-02 15:47:35,669 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_12_巴彦淖尔
2025-09-02 15:47:35,742 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-02 15:47:35,742 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_12_巴彦淖尔
2025-09-02 15:47:35,812 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-02 15:47:35,812 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_12_巴彦淖尔
2025-09-02 15:47:35,908 - INFO - [1_copy_to_local.py] |- 同步完成: 158 条数据
2025-09-02 15:47:35,908 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_12_巴彦淖尔
2025-09-02 15:47:36,004 - INFO - [1_copy_to_local.py] |- 同步完成: 157 条数据
2025-09-02 15:47:36,005 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.12秒
2025-09-02 15:47:36,005 - INFO - [1_copy_to_local.py] 所有同步任务完成: 2025-09-02 15:47:36
2025-09-02 15:47:36,070 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-09-02 15:47:36,071 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-09-02 15:47:36,071 - INFO - 正在运行脚本: 1_copy_ems_to_local.py
2025-09-02 15:47:36,071 - INFO - 开始运行脚本: D:\JA\database\1_copy_ems_to_local.py
2025-09-02 15:47:36,071 - INFO - 工作目录: D:\JA\database
2025-09-02 15:47:36,590 - INFO - [1_copy_ems_to_local.py] 连接源数据库: 172.25.4.87:5432/ems_test
2025-09-02 15:47:36,933 - INFO - [1_copy_ems_to_local.py] 连接目标数据库: localhost:3306/mzr_db
2025-09-02 15:47:36,940 - INFO - [1_copy_ems_to_local.py] 开始迁移表: from_demo.dim_base -> x【字典】基地编码
2025-09-02 15:47:37,089 - INFO - [1_copy_ems_to_local.py] 表 x【字典】基地编码 创建成功
2025-09-02 15:47:37,153 - INFO - [1_copy_ems_to_local.py] 插入 12 行到 x【字典】基地编码
2025-09-02 15:47:37,153 - INFO - [1_copy_ems_to_local.py] 共插入 12 行到 x【字典】基地编码
2025-09-02 15:47:37,153 - INFO - [1_copy_ems_to_local.py] 表 from_demo.dim_base -> x【字典】基地编码 迁移完成
2025-09-02 15:47:37,153 - INFO - [1_copy_ems_to_local.py] 开始迁移表: from_demo.dim_system_type -> w【字典】系统编码
2025-09-02 15:47:37,243 - INFO - [1_copy_ems_to_local.py] 表 w【字典】系统编码 创建成功
2025-09-02 15:47:37,300 - INFO - [1_copy_ems_to_local.py] 插入 26 行到 w【字典】系统编码
2025-09-02 15:47:37,301 - INFO - [1_copy_ems_to_local.py] 共插入 26 行到 w【字典】系统编码
2025-09-02 15:47:37,301 - INFO - [1_copy_ems_to_local.py] 表 from_demo.dim_system_type -> w【字典】系统编码 迁移完成
2025-09-02 15:47:37,301 - INFO - [1_copy_ems_to_local.py] PostgreSQL连接已关闭
2025-09-02 15:47:37,301 - INFO - [1_copy_ems_to_local.py] MySQL连接已关闭
2025-09-02 15:47:37,301 - INFO - [1_copy_ems_to_local.py] 数据库连接已关闭
2025-09-02 15:47:37,354 - INFO - 脚本 1_copy_ems_to_local.py 成功完成 (返回码: 0)
2025-09-02 15:47:37,355 - INFO - 脚本 1_copy_ems_to_local.py 执行完成，继续下一个
2025-09-02 15:47:37,355 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-09-02 15:47:37,355 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-09-02 15:47:37,355 - INFO - 工作目录: D:\JA\database
2025-09-02 15:47:37,913 - INFO - [2_table_aggregator.py] 开始数据聚合流程...
2025-09-02 15:47:37,913 - INFO - [2_table_aggregator.py] 加载配置文件: 2_table_aggregator_config.json
2025-09-02 15:47:38,041 - INFO - [2_table_aggregator.py] 数据库连接成功
2025-09-02 15:47:38,043 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_1_扬州
2025-09-02 15:47:38,052 - INFO - [2_table_aggregator.py] 表 1_汇总表_1_扬州 创建成功
2025-09-02 15:47:38,052 - INFO - [2_table_aggregator.py] 正在为基地 扬州 执行数据聚合...
2025-09-02 15:47:38,056 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:38,062 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_1_扬州' 行数: 11363
2025-09-02 15:47:38,086 - INFO - [2_table_aggregator.py] a表 'a采集点表_1_扬州' 行数: 86597
2025-09-02 15:47:38,095 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_1_扬州' 行数: 8171
2025-09-02 15:47:38,097 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:38,099 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:38,099 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:38,182 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('扬州基地', '一厂（晶运园区）-F3电池车间'), ('扬州基地', '一厂（晶运园区）-F2电池车间'), ('扬州基地', '一厂（晶运园区）-动力站F3'), ('扬州基地', '二厂（晶山园区）-晶山组件（M3）'), ('扬州基地', '一厂（晶运园区）-动力站-配电室')]
2025-09-02 15:47:38,431 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:38,431 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:38,447 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:39,115 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_1_扬州
2025-09-02 15:47:39,115 - INFO - [2_table_aggregator.py] 原始表c的行数: 11363
2025-09-02 15:47:39,115 - INFO - [2_table_aggregator.py] 汇总表的行数: 11363
2025-09-02 15:47:39,115 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-02 15:47:39,115 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-02 15:47:39,115 - INFO - [2_table_aggregator.py] 行 1: ('LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '耗电', '7', '电池车间LPCVD自动化312#电能', '电池车间LPCVD自动化312', 'YZ-002-DC-58-206-0037#AE0005-FV', '85262', 'LPCVD自动化312（JAYZ2438173）', '90002', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-58-206-0037', '通过', '反馈值', '能耗类', '正向有功电度', 'LPCVD自动化', 'LPCVD自动化', '1', 'LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000250', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', 'LPCVD')
2025-09-02 15:47:39,115 - INFO - [2_table_aggregator.py] 行 2: ('硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '耗电', '7', '电池车间硼扩自动化317#电能', '电池车间硼扩自动化317', 'YZ-002-DC-43-156-0039#AE0005-FV', '85636', '硼扩自动化317（JAYZ23C7297）', '89886', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-43-156-0039', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩自动化', '硼扩自动化', '1', '硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000134', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', '硼扩')
2025-09-02 15:47:39,115 - INFO - [2_table_aggregator.py] 行 3: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-02 15:47:39,115 - INFO - [2_table_aggregator.py] 行 4: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-02 15:47:39,115 - INFO - [2_table_aggregator.py] 行 5: ('背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '运行状态', None, '电池车间背膜主机307#炉管5#设备运行状态', '电池车间背膜主机307', 'YZ-002-DC-53-175-0040#SN0005-RS', '90931', '背膜主机307（JAYZ2417811）', '90116', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-53-175-0040', '通过', '运行状态', '信号类', '状态信号', '背膜主机', '背膜主机', '1', '背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000358', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '背膜')
2025-09-02 15:47:39,117 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:39,118 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_2_东台
2025-09-02 15:47:39,126 - INFO - [2_table_aggregator.py] 表 1_汇总表_2_东台 创建成功
2025-09-02 15:47:39,126 - INFO - [2_table_aggregator.py] 正在为基地 东台 执行数据聚合...
2025-09-02 15:47:39,129 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:39,133 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_2_东台' 行数: 5767
2025-09-02 15:47:39,153 - INFO - [2_table_aggregator.py] a表 'a采集点表_2_东台' 行数: 77532
2025-09-02 15:47:39,166 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_2_东台' 行数: 5131
2025-09-02 15:47:39,167 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:39,168 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:39,168 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:39,207 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('东台基地', '一厂-电池车间1'), ('东台基地', '一厂-组件车间1'), ('东台基地', '一厂动力站'), ('东台基地', '一厂办公区'), ('东台基地', '其他区域')]
2025-09-02 15:47:39,218 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:39,218 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:39,230 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:39,711 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_2_东台
2025-09-02 15:47:39,711 - INFO - [2_table_aggregator.py] 原始表c的行数: 5767
2025-09-02 15:47:39,711 - INFO - [2_table_aggregator.py] 汇总表的行数: 5767
2025-09-02 15:47:39,711 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-02 15:47:39,712 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-02 15:47:39,712 - INFO - [2_table_aggregator.py] 行 1: ('BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '产量', None, 'BSG上料2号机#产量下料', 'BSG上料2号机', 'DT-001-DC-45-160-0002#YE0004-FV', '384554', 'BSG下料-BSGX1002', '512016', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0002', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-02 15:47:39,712 - INFO - [2_table_aggregator.py] 行 2: ('BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '产量', None, 'BSG上料4号机#产量下料', 'BSG上料4号机', 'DT-001-DC-45-160-0003#YE0004-FV', '384544', 'BSG下料-BSGX1004', '512018', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0003', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-02 15:47:39,712 - INFO - [2_table_aggregator.py] 行 3: ('BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '产量', None, 'BSG上料6号机#产量下料', 'BSG上料6号机', 'DT-001-DC-45-160-0004#YE0004-FV', '384586', 'BSG下料-BSGX1006', '512019', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0004', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-02 15:47:39,712 - INFO - [2_table_aggregator.py] 行 4: ('BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '产量', None, 'BSG上料8号机#产量下料', 'BSG上料8号机', 'DT-001-DC-45-160-0006#YE0004-FV', '384562', 'BSG下料-BSGX1008', '512022', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0006', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-02 15:47:39,712 - INFO - [2_table_aggregator.py] 行 5: ('BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '产量', None, 'BSG上料12号机#产量下料', 'BSG上料12号机', 'DT-001-DC-45-160-0008#YE0004-FV', '384488', 'BSG下料-BSGX1012', '512025', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0008', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-02 15:47:39,712 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:39,717 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_3_合肥
2025-09-02 15:47:39,724 - INFO - [2_table_aggregator.py] 表 1_汇总表_3_合肥 创建成功
2025-09-02 15:47:39,724 - INFO - [2_table_aggregator.py] 正在为基地 合肥 执行数据聚合...
2025-09-02 15:47:39,725 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:39,727 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_3_合肥' 行数: 2417
2025-09-02 15:47:39,750 - INFO - [2_table_aggregator.py] a表 'a采集点表_3_合肥' 行数: 41670
2025-09-02 15:47:39,754 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_3_合肥' 行数: 1890
2025-09-02 15:47:39,755 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:39,756 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:39,756 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:39,765 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('合肥基地', '二厂（二部）-六车间（201#智慧工厂）'), ('合肥基地', '一厂（一部）-二车间（116#创新工厂）'), ('合肥基地', '207动力站'), ('合肥基地', '207动力站-配电室'), ('合肥基地', '一厂（一部）-四车间（110#领跑工厂）-配电室')]
2025-09-02 15:47:39,774 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:39,774 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:39,787 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:39,966 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_3_合肥
2025-09-02 15:47:39,966 - INFO - [2_table_aggregator.py] 原始表c的行数: 2417
2025-09-02 15:47:39,967 - INFO - [2_table_aggregator.py] 汇总表的行数: 2417
2025-09-02 15:47:39,967 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-02 15:47:39,967 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-02 15:47:39,967 - INFO - [2_table_aggregator.py] 行 1: ('二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '耗电', '7', '智慧工厂一-6BL15002-总有功电度', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#AE0003-FV', '10', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000048', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-02 15:47:39,967 - INFO - [2_table_aggregator.py] 行 2: ('二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '产量', None, '智慧工厂一-6BL15002-产量', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#YE0005-FV', '12', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '统计类', '产量', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000049', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-02 15:47:39,967 - INFO - [2_table_aggregator.py] 行 3: ('二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '运行状态', None, '智慧工厂一-6BL15002运行状态', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#SN0002-RS', '9', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'HF-EMC-RS-E-NS-NS-000000049', '设备管控', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-02 15:47:39,967 - INFO - [2_table_aggregator.py] 行 4: ('二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '耗电', '7', '智慧工厂一-6CQ13002-总有功电度', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#AE0001-FV', '759', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000078', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-02 15:47:39,967 - INFO - [2_table_aggregator.py] 行 5: ('二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '产量', None, '智慧工厂一-6CQ13002-产量', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#YE0002-FV', '760', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '统计类', '产量', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000079', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-02 15:47:39,969 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:39,969 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_4_鄂尔多斯
2025-09-02 15:47:39,982 - INFO - [2_table_aggregator.py] 表 1_汇总表_4_鄂尔多斯 创建成功
2025-09-02 15:47:39,982 - INFO - [2_table_aggregator.py] 正在为基地 鄂尔多斯 执行数据聚合...
2025-09-02 15:47:39,985 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:39,987 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_4_鄂尔多斯' 行数: 484
2025-09-02 15:47:40,001 - INFO - [2_table_aggregator.py] a表 'a采集点表_4_鄂尔多斯' 行数: 14164
2025-09-02 15:47:40,003 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_4_鄂尔多斯' 行数: 310
2025-09-02 15:47:40,003 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:40,005 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:40,006 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:40,019 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('鄂尔多斯', '二厂（B区）-B4-5GW组件车间2'), ('', '二厂（B区）-B4-5GW组件车间2')]
2025-09-02 15:47:40,024 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:40,024 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:40,040 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:40,100 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_4_鄂尔多斯
2025-09-02 15:47:40,100 - INFO - [2_table_aggregator.py] 原始表c的行数: 484
2025-09-02 15:47:40,100 - INFO - [2_table_aggregator.py] 汇总表的行数: 484
2025-09-02 15:47:40,100 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-02 15:47:40,101 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-02 15:47:40,101 - INFO - [2_table_aggregator.py] 行 1: ('2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '运行状态', None, '2#串焊机01状态', '2#串焊机01', 'EE-019-ZJ-61-224-0002#SN0003-RS', '1143', '2#串焊机01（JAEEDS2020087）', '162', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0002', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000004', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-02 15:47:40,101 - INFO - [2_table_aggregator.py] 行 2: ('2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '运行状态', None, '2#串焊机02状态', '2#串焊机02', 'EE-019-ZJ-61-224-0001#SN0005-RS', '1132', '2#串焊机02（JAEEDS2020088）', '160', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0001', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-02 15:47:40,101 - INFO - [2_table_aggregator.py] 行 3: ('2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '运行状态', None, '2#串焊机03状态', '2#串焊机03', 'EE-019-ZJ-61-224-0004#SN0004-RS', '1161', '2#串焊机03（JAEEDS2020089）', '167', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0004', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000006', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-02 15:47:40,101 - INFO - [2_table_aggregator.py] 行 4: ('2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '运行状态', None, '2#串焊机04状态', '2#串焊机04', 'EE-019-ZJ-61-224-0003#SN0001-RS', '1149', '2#串焊机04（JAEEDS2020090）', '164', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0003', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-02 15:47:40,101 - INFO - [2_table_aggregator.py] 行 5: ('1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '产量', None, '1#二道胶膜裁切机产量', '1#二道胶膜裁切机02', 'EE-019-ZJ-61-228-0001#YE0001-FV', '1115', '1#二道胶膜裁切机02（JAEEDS2020026）', '155', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-228-0001', '通过', '反馈值', '统计类', '产量', '裁切机', '裁切机', '1', '1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'EE-EMS-YE-E-NS-NS-000000016', '能源管理', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-02 15:47:40,102 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:40,102 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_5_曲靖
2025-09-02 15:47:40,112 - INFO - [2_table_aggregator.py] 表 1_汇总表_5_曲靖 创建成功
2025-09-02 15:47:40,112 - INFO - [2_table_aggregator.py] 正在为基地 曲靖 执行数据聚合...
2025-09-02 15:47:40,113 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:40,120 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_5_曲靖' 行数: 14880
2025-09-02 15:47:40,142 - INFO - [2_table_aggregator.py] a表 'a采集点表_5_曲靖' 行数: 82370
2025-09-02 15:47:40,155 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_5_曲靖' 行数: 8315
2025-09-02 15:47:40,156 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:40,156 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:40,157 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:40,173 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('曲靖基地', '三厂（三期）-电池一期车间（101）'), ('曲靖基地', '二厂（二期）-201拉晶车间'), ('曲靖基地', '二厂（二期）-201加工车间'), ('曲靖基地', '三厂（三期）-组件一期车间（104）'), ('曲靖基地', '二厂（二期）-202拉晶车间')]
2025-09-02 15:47:40,188 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:40,188 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:40,203 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:40,838 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_5_曲靖
2025-09-02 15:47:40,838 - INFO - [2_table_aggregator.py] 原始表c的行数: 14880
2025-09-02 15:47:40,838 - INFO - [2_table_aggregator.py] 汇总表的行数: 14887
2025-09-02 15:47:40,838 - INFO - [2_table_aggregator.py] 警告: 行数不一致! 可能丢失了 -7 行数据
2025-09-02 15:47:40,839 - INFO - [2_table_aggregator.py] 建议检查连接条件和数据完整性
2025-09-02 15:47:40,839 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-02 15:47:40,839 - INFO - [2_table_aggregator.py] 行 1: ('西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '运行状态', None, '西区POLY尾气处理B19#运行状态', '西区POLY尾气处理B19', 'QJ-028-DC-56-199-0039#SN0001-RS', '1070', '西区POLY尾气处理B19（QJJAKJ12021493）', '145', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0039', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-02 15:47:40,839 - INFO - [2_table_aggregator.py] 行 2: ('西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '运行状态', None, '西区ALD尾气处理B01#运行状态', '西区ALD尾气处理B01', 'QJ-028-DC-56-199-0044#SN0001-RS', '1110', '西区ALD尾气处理B01（QJJAKJ12021632）', '151', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0044', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-02 15:47:40,839 - INFO - [2_table_aggregator.py] 行 3: ('西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '运行状态', None, '西区ALD尾气处理B02#运行状态', '西区ALD尾气处理B02', 'QJ-028-DC-56-199-0045#SN0001-RS', '1118', '西区ALD尾气处理B02（QJJAKJ12021633）', '152', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0045', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-02 15:47:40,839 - INFO - [2_table_aggregator.py] 行 4: ('西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '运行状态', None, '西区ALD尾气处理B03#运行状态', '西区ALD尾气处理B03', 'QJ-028-DC-56-199-0046#SN0001-RS', '1126', '西区ALD尾气处理B03（QJJAKJ120216334）', '153', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0046', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-02 15:47:40,843 - INFO - [2_table_aggregator.py] 行 5: ('西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '运行状态', None, '西区ALD尾气处理B04#运行状态', '西区ALD尾气处理B04', 'QJ-028-DC-56-199-0001#SN0001-RS', '8', '西区ALD尾气处理B04（QJJAKJ120216335）', '5', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0001', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000009', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-02 15:47:40,843 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:40,843 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_6_奉贤
2025-09-02 15:47:40,849 - INFO - [2_table_aggregator.py] 表 1_汇总表_6_奉贤 创建成功
2025-09-02 15:47:40,849 - INFO - [2_table_aggregator.py] 正在为基地 奉贤 执行数据聚合...
2025-09-02 15:47:40,850 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:40,852 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_6_奉贤' 行数: 648
2025-09-02 15:47:40,866 - INFO - [2_table_aggregator.py] a表 'a采集点表_6_奉贤' 行数: 6128
2025-09-02 15:47:40,868 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_6_奉贤' 行数: 513
2025-09-02 15:47:40,869 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:40,869 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:40,870 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:40,872 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('奉贤基地', '一厂-B2组件车间（北区）'), ('奉贤基地', '一厂-B1储能车间'), ('奉贤基地', '厂外-C2接线盒车间'), ('奉贤基地', 'E2动力站'), ('奉贤基地', '35KV变电站')]
2025-09-02 15:47:40,877 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:40,877 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:40,890 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:41,230 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_6_奉贤
2025-09-02 15:47:41,230 - INFO - [2_table_aggregator.py] 原始表c的行数: 648
2025-09-02 15:47:41,230 - INFO - [2_table_aggregator.py] 汇总表的行数: 648
2025-09-02 15:47:41,230 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-02 15:47:41,230 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-02 15:47:41,230 - INFO - [2_table_aggregator.py] 行 1: ('自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '运行状态', None, '装工装_201_PLC#运行状态', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#SN0001-RS', '162', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '通过', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-02 15:47:41,230 - INFO - [2_table_aggregator.py] 行 2: ('自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '耗电', '7', '装工装_201_PLC#总有功电度', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#AE0004-FV', '165', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-02 15:47:41,230 - INFO - [2_table_aggregator.py] 行 3: ('在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '运行状态', None, '裁切机_501_PLC#运行状态', '裁切机_501_PLC', 'FX-002-ZJ-61-228-0001#SN0001-RS', '153', '在线裁切机一道-FX02CQ0501', '29', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-61-228-0001', '通过', '运行状态', '信号类', '状态信号', '一道EVA裁切机', '一道EVA裁切机', '1', '在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000079', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '焊接')
2025-09-02 15:47:41,230 - INFO - [2_table_aggregator.py] 行 4: ('自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '运行状态', None, '装工装_301_PLC#运行状态', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#SN0001-RS', '166', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000112', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-02 15:47:41,230 - INFO - [2_table_aggregator.py] 行 5: ('自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '耗电', '7', '装工装_301_PLC#总有功电度', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#AE0004-FV', '169', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000040', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-02 15:47:41,232 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:41,232 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_7_包头
2025-09-02 15:47:41,241 - INFO - [2_table_aggregator.py] 表 1_汇总表_7_包头 创建成功
2025-09-02 15:47:41,241 - INFO - [2_table_aggregator.py] 正在为基地 包头 执行数据聚合...
2025-09-02 15:47:41,244 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:41,249 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_7_包头' 行数: 10402
2025-09-02 15:47:41,268 - INFO - [2_table_aggregator.py] a表 'a采集点表_7_包头' 行数: 60068
2025-09-02 15:47:41,275 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_7_包头' 行数: 5229
2025-09-02 15:47:41,277 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:41,277 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:41,277 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:41,285 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('包头基地', '二厂-拉晶车间'), ('包头基地', '三厂-拉晶车间'), ('包头基地', '二厂-加工车间'), ('包头基地', '四厂-组件车间'), ('包头基地', '三厂-切片车间-配电室')]
2025-09-02 15:47:41,294 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:41,296 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:41,307 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:41,812 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_7_包头
2025-09-02 15:47:41,813 - INFO - [2_table_aggregator.py] 原始表c的行数: 10402
2025-09-02 15:47:41,813 - INFO - [2_table_aggregator.py] 汇总表的行数: 10402
2025-09-02 15:47:41,813 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-02 15:47:41,813 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-02 15:47:41,813 - INFO - [2_table_aggregator.py] 行 1: ('二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-02 15:47:41,813 - INFO - [2_table_aggregator.py] 行 2: ('二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '产量', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-02 15:47:41,813 - INFO - [2_table_aggregator.py] 行 3: ('二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '耗电', '7', '单晶炉#电能', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#AE0003-FV', '9643', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '反馈值', '能耗类', '正向有功电度', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'BT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-02 15:47:41,813 - INFO - [2_table_aggregator.py] 行 4: ('二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '单晶炉_阳光1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-02 15:47:41,813 - INFO - [2_table_aggregator.py] 行 5: ('二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '产量', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '单晶炉_阳光1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-02 15:47:41,816 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:41,816 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_8_义乌
2025-09-02 15:47:41,825 - INFO - [2_table_aggregator.py] 表 1_汇总表_8_义乌 创建成功
2025-09-02 15:47:41,825 - INFO - [2_table_aggregator.py] 正在为基地 义乌 执行数据聚合...
2025-09-02 15:47:41,826 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:41,828 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_8_义乌' 行数: 1467
2025-09-02 15:47:41,842 - INFO - [2_table_aggregator.py] a表 'a采集点表_8_义乌' 行数: 9645
2025-09-02 15:47:41,846 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_8_义乌' 行数: 1363
2025-09-02 15:47:41,847 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:41,847 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:41,848 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:41,857 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('义乌基地', '一厂-组件车间一'), ('义乌基地', '仓库'), ('义乌基地', '动力站-配电室'), ('义乌基地', '一厂-电池车间一'), ('义乌基地', '二厂-电池车间二')]
2025-09-02 15:47:41,861 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:41,861 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:41,873 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:41,953 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_8_义乌
2025-09-02 15:47:41,953 - INFO - [2_table_aggregator.py] 原始表c的行数: 1467
2025-09-02 15:47:41,953 - INFO - [2_table_aggregator.py] 汇总表的行数: 1467
2025-09-02 15:47:41,953 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-02 15:47:41,954 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-02 15:47:41,954 - INFO - [2_table_aggregator.py] 行 1: ('1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '运行状态', None, '1上玻璃102-设备状态', 'KEP-HC', 'YW-003-ZJ-61-256-0010#SN0001-RS', '1', '1上玻璃102', '1', '一厂-组件车间一', '003', 'YW-003-ZJ-61-256-0010', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-02 15:47:41,954 - INFO - [2_table_aggregator.py] 行 2: ('1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '运行状态', None, '1汇流条竖起机141-设备状态', 'KEP-HC', 'YW-003-ZJ-60-211-0002#SN0001-RS', '100', '1汇流条竖起机141', '23', '一厂-组件车间一', '003', 'YW-003-ZJ-60-211-0002', '通过', '运行状态', '信号类', '状态信号', '自动捋引线', '自动捋引线', '1', '1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '装框')
2025-09-02 15:47:41,954 - INFO - [2_table_aggregator.py] 行 3: ('1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '运行状态', None, '1层压机101-02-设备状态', 'KEP-HC', 'YW-003-ZJ-62-230-0021#SN0003-RS', '1001', '1层压机101-02', '158', '一厂-组件车间一', '003', 'YW-003-ZJ-62-230-0021', '通过', '运行状态', '信号类', '状态信号', '层压机', '层压机', '1', '1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '层压')
2025-09-02 15:47:41,954 - INFO - [2_table_aggregator.py] 行 4: ('1排版机092-产量', '0#10_003_22#160#Sum', '产量', None, '1排版机092-设备当班产能', 'KEP-HC', 'YW-003-ZJ-61-227-0015#YE0001-FV', '1004', '1排版机092', '160', '一厂-组件车间一', '003', 'YW-003-ZJ-61-227-0015', '通过', '反馈值', '统计类', '产量', '排版机', '排版机', '1', '1排版机092-产量', '0#10_003_22#160#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'YW-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-02 15:47:41,954 - INFO - [2_table_aggregator.py] 行 5: ('1分档机111-耗电', '7#10_003_22#156#Sum', '耗电', '7', '1分档机111-电量', 'KEP-HC', 'YW-003-ZJ-64-239-0004#AE0005-FV', '1005', '1分档机111', '156', '一厂-组件车间一', '003', 'YW-003-ZJ-64-239-0004', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '1分档机111-耗电', '7#10_003_22#156#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YW-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '包装')
2025-09-02 15:47:41,958 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:41,958 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_9_邢台
2025-09-02 15:47:41,963 - INFO - [2_table_aggregator.py] 表 1_汇总表_9_邢台 创建成功
2025-09-02 15:47:41,963 - INFO - [2_table_aggregator.py] 正在为基地 邢台 执行数据聚合...
2025-09-02 15:47:41,964 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:41,965 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_9_邢台' 行数: 933
2025-09-02 15:47:41,974 - INFO - [2_table_aggregator.py] a表 'a采集点表_9_邢台' 行数: 8063
2025-09-02 15:47:41,977 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_9_邢台' 行数: 483
2025-09-02 15:47:41,978 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:41,978 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:41,978 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:41,986 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('邢台基地', '三厂（三园区）-组件三车间'), ('邢台基地', '二厂（二园区）-组件一车间')]
2025-09-02 15:47:41,990 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:41,990 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:42,002 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:42,058 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_9_邢台
2025-09-02 15:47:42,058 - INFO - [2_table_aggregator.py] 原始表c的行数: 933
2025-09-02 15:47:42,058 - INFO - [2_table_aggregator.py] 汇总表的行数: 933
2025-09-02 15:47:42,058 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-02 15:47:42,058 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-02 15:47:42,058 - INFO - [2_table_aggregator.py] 行 1: ('分档机1FD501-耗电', '7#2_004_22#249#Sum', '耗电', '7', '分档机1FD501#设备当前电能表示数', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#AE0002-FV', '801', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '分档机1FD501-耗电', '7#2_004_22#249#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'XT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '邢台基地', '组件工段', '包装')
2025-09-02 15:47:42,058 - INFO - [2_table_aggregator.py] 行 2: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', None, '分档机1FD501#设备白班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0004-FV', '805', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-02 15:47:42,058 - INFO - [2_table_aggregator.py] 行 3: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', None, '分档机1FD501#设备夜班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0005-FV', '807', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-02 15:47:42,059 - INFO - [2_table_aggregator.py] 行 4: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', None, '裁切机1EC106#设备白班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0002-FV', '249', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-02 15:47:42,059 - INFO - [2_table_aggregator.py] 行 5: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', None, '裁切机1EC106#设备夜班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0003-FV', '250', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-02 15:47:42,059 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:42,063 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_10_宁晋
2025-09-02 15:47:42,068 - INFO - [2_table_aggregator.py] 表 1_汇总表_10_宁晋 创建成功
2025-09-02 15:47:42,068 - INFO - [2_table_aggregator.py] 正在为基地 宁晋 执行数据聚合...
2025-09-02 15:47:42,069 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:42,071 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_10_宁晋' 行数: 1917
2025-09-02 15:47:42,089 - INFO - [2_table_aggregator.py] a表 'a采集点表_10_宁晋' 行数: 25728
2025-09-02 15:47:42,093 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_10_宁晋' 行数: 1222
2025-09-02 15:47:42,094 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:42,095 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:42,095 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:42,116 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('宁晋基地', '宁晋东城-电池车间'), ('宁晋基地', '宁晋东城-电池车间-配电室'), ('宁晋基地', '动力车间'), ('', '宁晋东城-电池车间')]
2025-09-02 15:47:42,122 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:42,122 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:42,137 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:42,316 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_10_宁晋
2025-09-02 15:47:42,316 - INFO - [2_table_aggregator.py] 原始表c的行数: 1917
2025-09-02 15:47:42,316 - INFO - [2_table_aggregator.py] 汇总表的行数: 1917
2025-09-02 15:47:42,316 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-02 15:47:42,317 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-02 15:47:42,317 - INFO - [2_table_aggregator.py] 行 1: ('制绒下料自动化401-产量', '7#7_001#111#Sum', '产量', None, '宁晋电池-制绒下料自动化401-PLC---实时累计产出', '宁晋电池-制绒下料自动化401-PLC', 'NJ-001-DC-42-154-0002#YE0003-FV', '877', '制绒下料自动化401', '111', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0002', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化401-产量', '7#7_001#111#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-09-02 15:47:42,317 - INFO - [2_table_aggregator.py] 行 2: ('制绒下料自动化402-产量', '7#7_001#113#Sum', '产量', None, '宁晋电池-制绒下料自动化402-PLC---实时累计产出', '宁晋电池-制绒下料自动化402-PLC', 'NJ-001-DC-42-154-0004#YE0003-FV', '882', '制绒下料自动化402', '113', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0004', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化402-产量', '7#7_001#113#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-09-02 15:47:42,317 - INFO - [2_table_aggregator.py] 行 3: ('制绒下料自动化403-产量', '7#7_001#115#Sum', '产量', None, '宁晋电池-制绒下料自动化403-PLC---实时累计产出', '宁晋电池-制绒下料自动化403-PLC', 'NJ-001-DC-42-154-0006#YE0003-FV', '887', '制绒下料自动化403', '115', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0006', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化403-产量', '7#7_001#115#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-09-02 15:47:42,317 - INFO - [2_table_aggregator.py] 行 4: ('制绒下料自动化404-产量', '7#7_001#117#Sum', '产量', None, '宁晋电池-制绒下料自动化404-PLC---实时累计产出', '宁晋电池-制绒下料自动化404-PLC', 'NJ-001-DC-42-154-0008#YE0003-FV', '892', '制绒下料自动化404', '117', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0008', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化404-产量', '7#7_001#117#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-09-02 15:47:42,317 - INFO - [2_table_aggregator.py] 行 5: ('制绒下料自动化405-产量', '7#7_001#119#Sum', '产量', None, '宁晋电池-制绒下料自动化405-PLC---实时累计产出', '宁晋电池-制绒下料自动化405-PLC', 'NJ-001-DC-42-154-0010#YE0003-FV', '897', '制绒下料自动化405', '119', '宁晋东城-电池车间', '001', 'NJ-001-DC-42-154-0010', '通过', '反馈值', '统计类', '产量', '制绒自动化', '制绒自动化', '1', '制绒下料自动化405-产量', '7#7_001#119#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'NJ-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '制绒')
2025-09-02 15:47:42,318 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:42,318 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_11_石家庄
2025-09-02 15:47:42,335 - INFO - [2_table_aggregator.py] 表 1_汇总表_11_石家庄 创建成功
2025-09-02 15:47:42,335 - INFO - [2_table_aggregator.py] 正在为基地 石家庄 执行数据聚合...
2025-09-02 15:47:42,338 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:42,340 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_11_石家庄' 行数: 9846
2025-09-02 15:47:42,363 - INFO - [2_table_aggregator.py] a表 'a采集点表_11_石家庄' 行数: 82183
2025-09-02 15:47:42,368 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_11_石家庄' 行数: 3694
2025-09-02 15:47:42,371 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:42,371 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:42,372 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:42,433 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('石家庄基地', '一厂-动力站'), ('石家庄基地', '一厂-电池一期-配电室'), ('石家庄基地', '一厂-切片一期-配电室'), ('石家庄基地', '一厂-电池一期'), ('石家庄基地', '一厂-切片一期')]
2025-09-02 15:47:42,602 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:42,602 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:42,619 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:43,185 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_11_石家庄
2025-09-02 15:47:43,185 - INFO - [2_table_aggregator.py] 原始表c的行数: 9846
2025-09-02 15:47:43,185 - INFO - [2_table_aggregator.py] 汇总表的行数: 9846
2025-09-02 15:47:43,185 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-02 15:47:43,186 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-02 15:47:43,186 - INFO - [2_table_aggregator.py] 行 1: ('重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '耗电', '7', '78AH07#仪表正向有功总', '动力配电室仪表2.4.6.8', 'SJ-003-ZZ-01-JQ-0207#AE0001-FV', '447079', '78AH07', '519381', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0207', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000480', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-02 15:47:43,186 - INFO - [2_table_aggregator.py] 行 2: ('重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '耗电', '7', '71AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0102#AE0001-FV', '446711', '71AH07', '519013', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0102', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000182', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-02 15:47:43,186 - INFO - [2_table_aggregator.py] 行 3: ('重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '耗电', '7', '75AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0138#AE0001-FV', '446807', '75AH07', '519109', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0138', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000236', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-02 15:47:43,186 - INFO - [2_table_aggregator.py] 行 4: ('重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '耗电', '7', '77AH08#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0155#AE0001-FV', '446871', '77AH08', '519173', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0155', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000483', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-02 15:47:43,186 - INFO - [2_table_aggregator.py] 行 5: ('重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '耗电', '7', '71AH06#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0099#AE0001-FV', '446703', '71AH06', '519005', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0099', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000479', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-02 15:47:43,191 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:43,191 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_12_巴彦淖尔
2025-09-02 15:47:43,196 - INFO - [2_table_aggregator.py] 表 1_汇总表_12_巴彦淖尔 创建成功
2025-09-02 15:47:43,196 - INFO - [2_table_aggregator.py] 正在为基地 巴彦淖尔 执行数据聚合...
2025-09-02 15:47:43,198 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-02 15:47:43,200 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_12_巴彦淖尔' 行数: 0
2025-09-02 15:47:43,204 - INFO - [2_table_aggregator.py] a表 'a采集点表_12_巴彦淖尔' 行数: 2119
2025-09-02 15:47:43,205 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_12_巴彦淖尔' 行数: 0
2025-09-02 15:47:43,206 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-02 15:47:43,207 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-02 15:47:43,207 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-02 15:47:43,209 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('巴彦淖尔', '一厂（一期）-5GW组件车间')]
2025-09-02 15:47:43,211 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-02 15:47:43,211 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-02 15:47:43,223 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-02 15:47:43,225 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_12_巴彦淖尔
2025-09-02 15:47:43,225 - INFO - [2_table_aggregator.py] 原始表c的行数: 0
2025-09-02 15:47:43,225 - INFO - [2_table_aggregator.py] 汇总表的行数: 0
2025-09-02 15:47:43,225 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-02 15:47:43,225 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-02 15:47:43,225 - INFO - [2_table_aggregator.py] 所有基地数据聚合完成!
2025-09-02 15:47:43,225 - INFO - [2_table_aggregator.py] 数据库连接已关闭
2025-09-02 15:47:43,282 - INFO - 脚本 2_table_aggregator.py 成功完成 (返回码: 0)
2025-09-02 15:47:43,282 - INFO - 脚本 2_table_aggregator.py 执行完成，继续下一个
2025-09-02 15:47:43,282 - INFO - 正在运行脚本: 3_merge_tables.py
2025-09-02 15:47:43,282 - INFO - 开始运行脚本: D:\JA\database\3_merge_tables.py
2025-09-02 15:47:43,282 - INFO - 工作目录: D:\JA\database
2025-09-02 15:47:44,080 - INFO - [3_merge_tables.py] 开始处理 12 个基地...
2025-09-02 15:47:44,094 - INFO - [3_merge_tables.py] 正在处理: 扬州基地...
2025-09-02 15:47:44,094 - INFO - [3_merge_tables.py] 正在处理: 鄂尔多斯基地...正在处理: 东台基地...
2025-09-02 15:47:44,094 - INFO - [3_merge_tables.py] 正在处理: 合肥基地...
2025-09-02 15:47:44,105 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_3_合肥
2025-09-02 15:47:44,105 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-02 15:47:44,106 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_1_扬州
2025-09-02 15:47:44,106 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_2_东台
2025-09-02 15:47:44,106 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_3_合肥
2025-09-02 15:47:44,106 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_1_扬州
2025-09-02 15:47:44,108 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-02 15:47:44,109 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_2_东台
2025-09-02 15:47:44,351 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-02 15:47:44,513 - INFO - [3_merge_tables.py] 重命名列
2025-09-02 15:47:44,513 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:47:44,524 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\04鄂尔多斯基地\2_采集点+设备合并表_4_鄂尔多斯_20250902154744.xlsx
2025-09-02 15:47:44,887 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_3_合肥
2025-09-02 15:47:45,321 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_2_东台
2025-09-02 15:47:45,367 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_1_扬州
2025-09-02 15:47:48,446 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_4_鄂尔多斯_20250902154744.xlsx
2025-09-02 15:47:48,446 - INFO - [3_merge_tables.py] 应用基本格式...  重命名列
2025-09-02 15:47:48,448 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:47:48,467 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\03合肥基地\2_采集点+设备合并表_3_合肥_20250902154744.xlsx
2025-09-02 15:48:00,784 - INFO - [3_merge_tables.py] 重命名列
2025-09-02 15:48:00,784 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:48:00,822 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\02东台基地\2_采集点+设备合并表_2_东台_20250902154744.xlsx
2025-09-02 15:48:08,384 - INFO - [3_merge_tables.py] 正在处理: 曲靖基地...
2025-09-02 15:48:08,444 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_5_曲靖
2025-09-02 15:48:08,450 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_5_曲靖
2025-09-02 15:48:09,124 - INFO - [3_merge_tables.py] 重命名列
2025-09-02 15:48:09,127 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:48:09,183 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\01扬州基地\2_采集点+设备合并表_1_扬州_20250902154744.xlsx
2025-09-02 15:48:10,027 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_5_曲靖
2025-09-02 15:48:30,957 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_3_合肥_20250902154744.xlsx
2025-09-02 15:48:30,957 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-02 15:48:39,964 - INFO - [3_merge_tables.py] 重命名列
2025-09-02 15:48:39,964 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:48:40,015 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\05曲靖基地\2_采集点+设备合并表_5_曲靖_20250902154744.xlsx
2025-09-02 15:48:57,369 - INFO - [3_merge_tables.py] 正在处理: 奉贤基地...
2025-09-02 15:48:57,397 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_6_奉贤
2025-09-02 15:48:57,398 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_6_奉贤
2025-09-02 15:48:57,412 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_2_东台_20250902154744.xlsx
2025-09-02 15:48:57,413 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-02 15:48:57,509 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_6_奉贤
2025-09-02 15:49:00,657 - INFO - [3_merge_tables.py] 重命名列
2025-09-02 15:49:00,657 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:49:00,672 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\06奉贤基地\2_采集点+设备合并表_6_奉贤_20250902154744.xlsx
2025-09-02 15:49:07,812 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_6_奉贤_20250902154744.xlsx
2025-09-02 15:49:07,812 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-02 15:49:13,043 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_1_扬州_20250902154744.xlsx
2025-09-02 15:49:13,043 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-02 15:49:19,949 - INFO - [3_merge_tables.py] 正在处理: 包头基地...
2025-09-02 15:49:20,074 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_7_包头
2025-09-02 15:49:20,079 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_7_包头
2025-09-02 15:49:20,658 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_7_包头
2025-09-02 15:49:40,662 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_5_曲靖_20250902154744.xlsx
2025-09-02 15:49:40,662 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-02 15:49:56,845 - INFO - [3_merge_tables.py] 重命名列
2025-09-02 15:49:56,845 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:49:56,890 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\07包头基地\2_采集点+设备合并表_7_包头_20250902154744.xlsx
2025-09-02 15:50:19,458 - INFO - [3_merge_tables.py] 正在处理: 义乌基地...
2025-09-02 15:50:19,462 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_8_义乌
2025-09-02 15:50:19,464 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_8_义乌
2025-09-02 15:50:19,601 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_8_义乌
2025-09-02 15:50:19,754 - INFO - [3_merge_tables.py] 重命名列
2025-09-02 15:50:19,754 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:50:19,759 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\08义乌基地\2_采集点+设备合并表_8_义乌_20250902154744.xlsx
2025-09-02 15:50:21,179 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_7_包头_20250902154744.xlsx
2025-09-02 15:50:21,179 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-02 15:50:23,662 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_8_义乌_20250902154744.xlsx
2025-09-02 15:50:23,668 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-02 15:50:34,511 - INFO - [3_merge_tables.py] 正在处理: 邢台基地...
2025-09-02 15:50:34,573 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_9_邢台
2025-09-02 15:50:34,578 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_9_邢台
2025-09-02 15:50:34,751 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_9_邢台
2025-09-02 15:50:39,391 - INFO - [3_merge_tables.py] 正在处理: 宁晋基地...
2025-09-02 15:50:39,456 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_10_宁晋
2025-09-02 15:50:39,469 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_10_宁晋
2025-09-02 15:50:39,753 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_10_宁晋
2025-09-02 15:50:40,266 - INFO - [3_merge_tables.py] 重命名列
2025-09-02 15:50:40,266 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:50:40,287 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\09邢台基地\2_采集点+设备合并表_9_邢台_20250902154744.xlsx
2025-09-02 15:50:44,394 - INFO - [3_merge_tables.py] 正在处理: 石家庄基地...
2025-09-02 15:50:44,400 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_11_石家庄
2025-09-02 15:50:44,401 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_11_石家庄
2025-09-02 15:50:44,538 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_9_邢台_20250902154744.xlsx
2025-09-02 15:50:44,538 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-02 15:50:45,393 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_11_石家庄
2025-09-02 15:50:46,029 - INFO - [3_merge_tables.py] 重命名列
2025-09-02 15:50:46,031 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:50:46,047 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\10宁晋基地\2_采集点+设备合并表_10_宁晋_20250902154744.xlsx
2025-09-02 15:50:53,048 - INFO - [3_merge_tables.py] 正在处理: 巴彦淖尔基地...
2025-09-02 15:50:53,056 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-02 15:50:53,064 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-02 15:50:53,121 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-02 15:50:53,210 - INFO - [3_merge_tables.py] 重命名列
2025-09-02 15:50:53,210 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:50:53,213 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\12巴彦淖尔基地\2_采集点+设备合并表_12_巴彦淖尔_20250902154744.xlsx
2025-09-02 15:50:53,633 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_12_巴彦淖尔_20250902154744.xlsx
2025-09-02 15:50:53,633 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-02 15:50:54,887 - INFO - [3_merge_tables.py] 重命名列
2025-09-02 15:50:54,887 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-02 15:50:54,923 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\11石家庄基地\2_采集点+设备合并表_11_石家庄_20250902154744.xlsx
2025-09-02 15:51:06,003 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_10_宁晋_20250902154744.xlsx
2025-09-02 15:51:06,003 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-02 15:51:18,068 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_11_石家庄_20250902154744.xlsx
2025-09-02 15:51:18,068 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-02 15:51:41,937 - INFO - [3_merge_tables.py] 所有基地处理完成! 总耗时: 237.86秒
2025-09-02 15:51:41,937 - INFO - [3_merge_tables.py] 开始合并所有基地文件...
2025-09-02 15:51:41,939 - INFO - [3_merge_tables.py] 正在合并: 扬州基地...
2025-09-02 15:51:56,492 - INFO - [3_merge_tables.py] 正在合并: 东台基地...
2025-09-02 15:52:08,887 - INFO - [3_merge_tables.py] 正在合并: 合肥基地...
2025-09-02 15:52:15,013 - INFO - [3_merge_tables.py] 正在合并: 鄂尔多斯基地...
2025-09-02 15:52:17,491 - INFO - [3_merge_tables.py] 正在合并: 曲靖基地...
2025-09-02 15:52:30,118 - INFO - [3_merge_tables.py] 正在合并: 奉贤基地...
2025-09-02 15:52:30,987 - INFO - [3_merge_tables.py] 正在合并: 包头基地...
2025-09-02 15:52:40,138 - INFO - [3_merge_tables.py] 正在合并: 义乌基地...
2025-09-02 15:52:42,453 - INFO - [3_merge_tables.py] 正在合并: 邢台基地...
2025-09-02 15:52:43,523 - INFO - [3_merge_tables.py] 正在合并: 宁晋基地...
2025-09-02 15:52:47,033 - INFO - [3_merge_tables.py] 正在合并: 石家庄基地...
2025-09-02 15:52:59,383 - INFO - [3_merge_tables.py] 正在合并: 巴彦淖尔基地...
2025-09-02 15:55:01,122 - INFO - [3_merge_tables.py] 合并完成! 耗时: 199.18秒
2025-09-02 15:55:01,122 - INFO - [3_merge_tables.py] 正在应用基本格式...
2025-09-02 15:59:52,029 - INFO - [3_merge_tables.py] 合并文件已生成: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】采集点+设备_20250902154744.xlsx
2025-09-02 15:59:52,029 - INFO - [3_merge_tables.py] 程序已正常退出
2025-09-02 16:00:14,010 - INFO - 脚本 3_merge_tables.py 成功完成 (返回码: 0)
2025-09-02 16:00:14,013 - INFO - 脚本 3_merge_tables.py 执行完成，继续下一个
2025-09-02 16:00:14,013 - INFO - 正在运行脚本: 4_merge_calc_tables.py
2025-09-02 16:00:14,013 - INFO - 开始运行脚本: D:\JA\database\4_merge_calc_tables.py
2025-09-02 16:00:14,013 - INFO - 工作目录: D:\JA\database
2025-09-02 16:00:15,220 - INFO - [4_merge_calc_tables.py] 开始导出数据...
2025-09-02 16:00:15,220 - INFO - [4_merge_calc_tables.py] 输出目录: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点
2025-09-02 16:00:17,262 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_1_扬州 已导出到Sheet: 扬州
2025-09-02 16:00:18,190 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_2_东台 已导出到Sheet: 东台
2025-09-02 16:00:18,474 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_3_合肥 已导出到Sheet: 合肥
2025-09-02 16:00:18,534 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_4_鄂尔多斯 已导出到Sheet: 鄂尔多斯
2025-09-02 16:00:21,052 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_5_曲靖 已导出到Sheet: 曲靖
2025-09-02 16:00:21,152 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_6_奉贤 已导出到Sheet: 奉贤
2025-09-02 16:00:22,839 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_7_包头 已导出到Sheet: 包头
2025-09-02 16:00:23,076 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_8_义乌 已导出到Sheet: 义乌
2025-09-02 16:00:23,194 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_9_邢台 已导出到Sheet: 邢台
2025-09-02 16:00:23,480 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_10_宁晋 已导出到Sheet: 宁晋
2025-09-02 16:00:25,340 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_11_石家庄 已导出到Sheet: 石家庄
2025-09-02 16:00:25,350 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_12_巴彦淖尔 已导出到Sheet: 巴彦淖尔
2025-09-02 16:00:34,526 - INFO - [4_merge_calc_tables.py] 汇总Sheet已创建
2025-09-02 16:01:01,423 - INFO - [4_merge_calc_tables.py] 文件已保存为: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250902160015.xlsx
2025-09-02 16:01:01,464 - INFO - [4_merge_calc_tables.py] 文件验证成功: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250902160015.xlsx
2025-09-02 16:01:01,464 - INFO - [4_merge_calc_tables.py] 文件大小: 24794.63 KB
2025-09-02 16:01:01,464 - INFO - [4_merge_calc_tables.py] 导出完成，耗时: 46.24 秒
2025-09-02 16:01:01,464 - INFO - [4_merge_calc_tables.py] === 导出摘要 ===
2025-09-02 16:01:01,464 - INFO - [4_merge_calc_tables.py] 输出文件: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250902160015.xlsx
2025-09-02 16:01:01,464 - INFO - [4_merge_calc_tables.py] 包含工作表: 汇总 + 12个基地表
2025-09-02 16:01:03,277 - INFO - 脚本 4_merge_calc_tables.py 成功完成 (返回码: 0)
2025-09-02 16:01:03,277 - INFO - 脚本 4_merge_calc_tables.py 执行完成，继续下一个
2025-09-02 16:01:03,279 - INFO - 结束执行时间: 2025-09-02 16:01:03
2025-09-02 16:01:03,279 - INFO - ==================================================
2025-09-03 15:47:36,614 - INFO - ==================================================
2025-09-03 15:47:36,614 - INFO - 开始执行流水线 - 2025-09-03 15:47:36
2025-09-03 15:47:36,614 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-09-03 15:47:36,614 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-09-03 15:47:36,853 - INFO - pymysql版本: 1.4.6
2025-09-03 15:47:36,853 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-09-03 15:47:36,853 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-09-03 15:47:36,853 - INFO - 工作目录: D:\JA\database
2025-09-03 15:47:37,340 - INFO - [1_copy_to_local.py] 开始数据库同步任务: 2025-09-03 15:47:37
2025-09-03 15:47:37,340 - INFO - [1_copy_to_local.py] 开始同步基地: 扬州
2025-09-03 15:47:37,534 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_1_扬州
2025-09-03 15:47:44,188 - INFO - [1_copy_to_local.py] |- 同步完成: 86597 条数据
2025-09-03 15:47:44,188 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_1_扬州
2025-09-03 15:47:45,041 - INFO - [1_copy_to_local.py] |- 同步完成: 8171 条数据
2025-09-03 15:47:45,041 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_1_扬州
2025-09-03 15:47:45,312 - INFO - [1_copy_to_local.py] |- 同步完成: 11363 条数据
2025-09-03 15:47:45,312 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_1_扬州
2025-09-03 15:47:45,402 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-03 15:47:45,402 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_1_扬州
2025-09-03 15:47:45,956 - INFO - [1_copy_to_local.py] |- 同步完成: 8147 条数据
2025-09-03 15:47:45,956 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_1_扬州
2025-09-03 15:47:46,489 - INFO - [1_copy_to_local.py] |- 同步完成: 6052 条数据
2025-09-03 15:47:46,489 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_1_扬州
2025-09-03 15:47:46,877 - INFO - [1_copy_to_local.py] |- 同步完成: 3411 条数据
2025-09-03 15:47:46,888 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 9.55秒
2025-09-03 15:47:46,890 - INFO - [1_copy_to_local.py] 开始同步基地: 东台
2025-09-03 15:47:47,027 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_2_东台
2025-09-03 15:47:50,641 - INFO - [1_copy_to_local.py] |- 同步完成: 77532 条数据
2025-09-03 15:47:50,642 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_2_东台
2025-09-03 15:47:51,151 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-03 15:47:51,151 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_2_东台
2025-09-03 15:47:51,310 - INFO - [1_copy_to_local.py] |- 同步完成: 5767 条数据
2025-09-03 15:47:51,310 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_2_东台
2025-09-03 15:47:51,391 - INFO - [1_copy_to_local.py] |- 同步完成: 12 条数据
2025-09-03 15:47:51,391 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_2_东台
2025-09-03 15:47:51,654 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-03 15:47:51,655 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_2_东台
2025-09-03 15:47:51,889 - INFO - [1_copy_to_local.py] |- 同步完成: 4618 条数据
2025-09-03 15:47:51,889 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_2_东台
2025-09-03 15:47:52,043 - INFO - [1_copy_to_local.py] |- 同步完成: 1921 条数据
2025-09-03 15:47:52,047 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 5.16秒
2025-09-03 15:47:52,048 - INFO - [1_copy_to_local.py] 开始同步基地: 合肥
2025-09-03 15:48:00,224 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_3_合肥
2025-09-03 15:48:03,355 - INFO - [1_copy_to_local.py] |- 同步完成: 41670 条数据
2025-09-03 15:48:03,355 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_3_合肥
2025-09-03 15:48:03,692 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-03 15:48:03,692 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_3_合肥
2025-09-03 15:48:03,805 - INFO - [1_copy_to_local.py] |- 同步完成: 2417 条数据
2025-09-03 15:48:03,805 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_3_合肥
2025-09-03 15:48:03,883 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-03 15:48:03,883 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_3_合肥
2025-09-03 15:48:04,063 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-03 15:48:04,063 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_3_合肥
2025-09-03 15:48:04,309 - INFO - [1_copy_to_local.py] |- 同步完成: 2023 条数据
2025-09-03 15:48:04,309 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_3_合肥
2025-09-03 15:48:04,449 - INFO - [1_copy_to_local.py] |- 同步完成: 855 条数据
2025-09-03 15:48:04,452 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 12.40秒
2025-09-03 15:48:04,452 - INFO - [1_copy_to_local.py] 开始同步基地: 鄂尔多斯
2025-09-03 15:48:12,586 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_4_鄂尔多斯
2025-09-03 15:48:13,742 - INFO - [1_copy_to_local.py] |- 同步完成: 14404 条数据
2025-09-03 15:48:13,742 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_4_鄂尔多斯
2025-09-03 15:48:13,885 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-03 15:48:13,885 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_4_鄂尔多斯
2025-09-03 15:48:13,972 - INFO - [1_copy_to_local.py] |- 同步完成: 484 条数据
2025-09-03 15:48:13,972 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_4_鄂尔多斯
2025-09-03 15:48:14,053 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-03 15:48:14,053 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_4_鄂尔多斯
2025-09-03 15:48:14,140 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-03 15:48:14,140 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_4_鄂尔多斯
2025-09-03 15:48:14,294 - INFO - [1_copy_to_local.py] |- 同步完成: 794 条数据
2025-09-03 15:48:14,294 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_4_鄂尔多斯
2025-09-03 15:48:14,382 - INFO - [1_copy_to_local.py] |- 同步完成: 152 条数据
2025-09-03 15:48:14,384 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 9.93秒
2025-09-03 15:48:14,384 - INFO - [1_copy_to_local.py] 开始同步基地: 曲靖
2025-09-03 15:48:14,663 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_5_曲靖
2025-09-03 15:48:18,591 - INFO - [1_copy_to_local.py] |- 同步完成: 82370 条数据
2025-09-03 15:48:18,591 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_5_曲靖
2025-09-03 15:48:19,442 - INFO - [1_copy_to_local.py] |- 同步完成: 8315 条数据
2025-09-03 15:48:19,442 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_5_曲靖
2025-09-03 15:48:19,809 - INFO - [1_copy_to_local.py] |- 同步完成: 14880 条数据
2025-09-03 15:48:19,809 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_5_曲靖
2025-09-03 15:48:19,943 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-03 15:48:19,944 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_5_曲靖
2025-09-03 15:48:20,390 - INFO - [1_copy_to_local.py] |- 同步完成: 8316 条数据
2025-09-03 15:48:20,390 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_5_曲靖
2025-09-03 15:48:21,047 - INFO - [1_copy_to_local.py] |- 同步完成: 13973 条数据
2025-09-03 15:48:21,047 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_5_曲靖
2025-09-03 15:48:21,379 - INFO - [1_copy_to_local.py] |- 同步完成: 2491 条数据
2025-09-03 15:48:21,384 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 7.00秒
2025-09-03 15:48:21,386 - INFO - [1_copy_to_local.py] 开始同步基地: 奉贤
2025-09-03 15:48:21,573 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_6_奉贤
2025-09-03 15:48:22,238 - INFO - [1_copy_to_local.py] |- 同步完成: 6134 条数据
2025-09-03 15:48:22,238 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_6_奉贤
2025-09-03 15:48:22,369 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-09-03 15:48:22,369 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_6_奉贤
2025-09-03 15:48:22,462 - INFO - [1_copy_to_local.py] |- 同步完成: 648 条数据
2025-09-03 15:48:22,462 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_6_奉贤
2025-09-03 15:48:22,552 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-03 15:48:22,552 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_6_奉贤
2025-09-03 15:48:22,659 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-09-03 15:48:22,659 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_6_奉贤
2025-09-03 15:48:22,772 - INFO - [1_copy_to_local.py] |- 同步完成: 667 条数据
2025-09-03 15:48:22,773 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_6_奉贤
2025-09-03 15:48:22,875 - INFO - [1_copy_to_local.py] |- 同步完成: 277 条数据
2025-09-03 15:48:22,877 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.49秒
2025-09-03 15:48:22,878 - INFO - [1_copy_to_local.py] 开始同步基地: 包头
2025-09-03 15:48:22,994 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_7_包头
2025-09-03 15:48:25,509 - INFO - [1_copy_to_local.py] |- 同步完成: 59305 条数据
2025-09-03 15:48:25,509 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_7_包头
2025-09-03 15:48:25,890 - INFO - [1_copy_to_local.py] |- 同步完成: 4806 条数据
2025-09-03 15:48:25,890 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_7_包头
2025-09-03 15:48:26,086 - INFO - [1_copy_to_local.py] |- 同步完成: 10009 条数据
2025-09-03 15:48:26,086 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_7_包头
2025-09-03 15:48:26,158 - INFO - [1_copy_to_local.py] |- 同步完成: 10 条数据
2025-09-03 15:48:26,158 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_7_包头
2025-09-03 15:48:26,377 - INFO - [1_copy_to_local.py] |- 同步完成: 4805 条数据
2025-09-03 15:48:26,379 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_7_包头
2025-09-03 15:48:26,622 - INFO - [1_copy_to_local.py] |- 同步完成: 5573 条数据
2025-09-03 15:48:26,622 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_7_包头
2025-09-03 15:48:26,792 - INFO - [1_copy_to_local.py] |- 同步完成: 2019 条数据
2025-09-03 15:48:26,801 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 3.92秒
2025-09-03 15:48:26,802 - INFO - [1_copy_to_local.py] 开始同步基地: 义乌
2025-09-03 15:48:27,010 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_8_义乌
2025-09-03 15:48:27,888 - INFO - [1_copy_to_local.py] |- 同步完成: 9645 条数据
2025-09-03 15:48:27,888 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_8_义乌
2025-09-03 15:48:28,078 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-03 15:48:28,078 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_8_义乌
2025-09-03 15:48:28,197 - INFO - [1_copy_to_local.py] |- 同步完成: 1467 条数据
2025-09-03 15:48:28,197 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_8_义乌
2025-09-03 15:48:28,290 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-03 15:48:28,290 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_8_义乌
2025-09-03 15:48:28,427 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-03 15:48:28,427 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_8_义乌
2025-09-03 15:48:28,664 - INFO - [1_copy_to_local.py] |- 同步完成: 2776 条数据
2025-09-03 15:48:28,664 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_8_义乌
2025-09-03 15:48:28,759 - INFO - [1_copy_to_local.py] |- 同步完成: 4 条数据
2025-09-03 15:48:28,761 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.96秒
2025-09-03 15:48:28,761 - INFO - [1_copy_to_local.py] 开始同步基地: 邢台
2025-09-03 15:48:28,948 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_9_邢台
2025-09-03 15:48:29,679 - INFO - [1_copy_to_local.py] |- 同步完成: 8174 条数据
2025-09-03 15:48:29,679 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_9_邢台
2025-09-03 15:48:29,811 - INFO - [1_copy_to_local.py] |- 同步完成: 488 条数据
2025-09-03 15:48:29,811 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_9_邢台
2025-09-03 15:48:29,919 - INFO - [1_copy_to_local.py] |- 同步完成: 943 条数据
2025-09-03 15:48:29,919 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_9_邢台
2025-09-03 15:48:30,005 - INFO - [1_copy_to_local.py] |- 同步完成: 5 条数据
2025-09-03 15:48:30,006 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_9_邢台
2025-09-03 15:48:30,128 - INFO - [1_copy_to_local.py] |- 同步完成: 488 条数据
2025-09-03 15:48:30,128 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_9_邢台
2025-09-03 15:48:30,251 - INFO - [1_copy_to_local.py] |- 同步完成: 814 条数据
2025-09-03 15:48:30,251 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_9_邢台
2025-09-03 15:48:30,361 - INFO - [1_copy_to_local.py] |- 同步完成: 300 条数据
2025-09-03 15:48:30,363 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.60秒
2025-09-03 15:48:30,363 - INFO - [1_copy_to_local.py] 开始同步基地: 宁晋
2025-09-03 15:48:30,722 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_10_宁晋
2025-09-03 15:48:33,206 - INFO - [1_copy_to_local.py] |- 同步完成: 25728 条数据
2025-09-03 15:48:33,206 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_10_宁晋
2025-09-03 15:48:33,382 - INFO - [1_copy_to_local.py] |- 同步完成: 1223 条数据
2025-09-03 15:48:33,382 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_10_宁晋
2025-09-03 15:48:33,462 - INFO - [1_copy_to_local.py] |- 同步完成: 1921 条数据
2025-09-03 15:48:33,462 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_10_宁晋
2025-09-03 15:48:33,520 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-03 15:48:33,520 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_10_宁晋
2025-09-03 15:48:33,625 - INFO - [1_copy_to_local.py] |- 同步完成: 1223 条数据
2025-09-03 15:48:33,625 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_10_宁晋
2025-09-03 15:48:33,726 - INFO - [1_copy_to_local.py] |- 同步完成: 850 条数据
2025-09-03 15:48:33,726 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_10_宁晋
2025-09-03 15:48:33,798 - INFO - [1_copy_to_local.py] |- 同步完成: 377 条数据
2025-09-03 15:48:33,800 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 3.44秒
2025-09-03 15:48:33,800 - INFO - [1_copy_to_local.py] 开始同步基地: 石家庄
2025-09-03 15:48:33,902 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_11_石家庄
2025-09-03 15:48:38,235 - INFO - [1_copy_to_local.py] |- 同步完成: 82294 条数据
2025-09-03 15:48:38,235 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_11_石家庄
2025-09-03 15:48:38,565 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-09-03 15:48:38,565 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_11_石家庄
2025-09-03 15:48:38,785 - INFO - [1_copy_to_local.py] |- 同步完成: 9846 条数据
2025-09-03 15:48:38,785 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_11_石家庄
2025-09-03 15:48:38,835 - INFO - [1_copy_to_local.py] |- 同步完成: 16 条数据
2025-09-03 15:48:38,836 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_11_石家庄
2025-09-03 15:48:39,013 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-09-03 15:48:39,013 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_11_石家庄
2025-09-03 15:48:39,369 - INFO - [1_copy_to_local.py] |- 同步完成: 6433 条数据
2025-09-03 15:48:39,369 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_11_石家庄
2025-09-03 15:48:39,480 - INFO - [1_copy_to_local.py] |- 同步完成: 1208 条数据
2025-09-03 15:48:39,481 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 5.68秒
2025-09-03 15:48:39,482 - INFO - [1_copy_to_local.py] 开始同步基地: 巴彦淖尔
2025-09-03 15:48:39,606 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_12_巴彦淖尔
2025-09-03 15:48:40,054 - INFO - [1_copy_to_local.py] |- 同步完成: 2119 条数据
2025-09-03 15:48:40,054 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_12_巴彦淖尔
2025-09-03 15:48:40,136 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-03 15:48:40,136 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_12_巴彦淖尔
2025-09-03 15:48:40,227 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-03 15:48:40,227 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_12_巴彦淖尔
2025-09-03 15:48:40,292 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-03 15:48:40,292 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_12_巴彦淖尔
2025-09-03 15:48:40,378 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-03 15:48:40,378 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_12_巴彦淖尔
2025-09-03 15:48:40,462 - INFO - [1_copy_to_local.py] |- 同步完成: 158 条数据
2025-09-03 15:48:40,463 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_12_巴彦淖尔
2025-09-03 15:48:40,561 - INFO - [1_copy_to_local.py] |- 同步完成: 157 条数据
2025-09-03 15:48:40,563 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.08秒
2025-09-03 15:48:40,563 - INFO - [1_copy_to_local.py] 所有同步任务完成: 2025-09-03 15:48:40
2025-09-03 15:48:40,631 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-09-03 15:48:40,631 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-09-03 15:48:40,631 - INFO - 正在运行脚本: 1_copy_ems_to_local.py
2025-09-03 15:48:40,631 - INFO - 开始运行脚本: D:\JA\database\1_copy_ems_to_local.py
2025-09-03 15:48:40,631 - INFO - 工作目录: D:\JA\database
2025-09-03 15:48:41,172 - INFO - [1_copy_ems_to_local.py] 连接源数据库: 172.25.4.87:5432/ems_test
2025-09-03 15:48:41,469 - INFO - [1_copy_ems_to_local.py] 连接目标数据库: localhost:3306/mzr_db
2025-09-03 15:48:41,497 - INFO - [1_copy_ems_to_local.py] 开始迁移表: from_demo.dim_base -> x【字典】基地编码
2025-09-03 15:48:41,656 - INFO - [1_copy_ems_to_local.py] 表 x【字典】基地编码 创建成功
2025-09-03 15:48:41,719 - INFO - [1_copy_ems_to_local.py] 插入 12 行到 x【字典】基地编码
2025-09-03 15:48:41,720 - INFO - [1_copy_ems_to_local.py] 共插入 12 行到 x【字典】基地编码
2025-09-03 15:48:41,720 - INFO - [1_copy_ems_to_local.py] 表 from_demo.dim_base -> x【字典】基地编码 迁移完成
2025-09-03 15:48:41,720 - INFO - [1_copy_ems_to_local.py] 开始迁移表: from_demo.dim_system_type -> w【字典】系统编码
2025-09-03 15:48:41,790 - INFO - [1_copy_ems_to_local.py] 表 w【字典】系统编码 创建成功
2025-09-03 15:48:41,845 - INFO - [1_copy_ems_to_local.py] 插入 26 行到 w【字典】系统编码
2025-09-03 15:48:41,846 - INFO - [1_copy_ems_to_local.py] 共插入 26 行到 w【字典】系统编码
2025-09-03 15:48:41,846 - INFO - [1_copy_ems_to_local.py] 表 from_demo.dim_system_type -> w【字典】系统编码 迁移完成
2025-09-03 15:48:41,846 - INFO - [1_copy_ems_to_local.py] PostgreSQL连接已关闭
2025-09-03 15:48:41,847 - INFO - [1_copy_ems_to_local.py] MySQL连接已关闭
2025-09-03 15:48:41,847 - INFO - [1_copy_ems_to_local.py] 数据库连接已关闭
2025-09-03 15:48:41,900 - INFO - 脚本 1_copy_ems_to_local.py 成功完成 (返回码: 0)
2025-09-03 15:48:41,900 - INFO - 脚本 1_copy_ems_to_local.py 执行完成，继续下一个
2025-09-03 15:48:41,900 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-09-03 15:48:41,900 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-09-03 15:48:41,900 - INFO - 工作目录: D:\JA\database
2025-09-03 15:48:42,489 - INFO - [2_table_aggregator.py] 开始数据聚合流程...
2025-09-03 15:48:42,489 - INFO - [2_table_aggregator.py] 加载配置文件: 2_table_aggregator_config.json
2025-09-03 15:48:42,610 - INFO - [2_table_aggregator.py] 数据库连接成功
2025-09-03 15:48:42,621 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_1_扬州
2025-09-03 15:48:42,630 - INFO - [2_table_aggregator.py] 表 1_汇总表_1_扬州 创建成功
2025-09-03 15:48:42,630 - INFO - [2_table_aggregator.py] 正在为基地 扬州 执行数据聚合...
2025-09-03 15:48:42,634 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:42,641 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_1_扬州' 行数: 11363
2025-09-03 15:48:42,665 - INFO - [2_table_aggregator.py] a表 'a采集点表_1_扬州' 行数: 86597
2025-09-03 15:48:42,675 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_1_扬州' 行数: 8171
2025-09-03 15:48:42,677 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:42,679 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:42,680 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:42,768 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('扬州基地', '一厂（晶运园区）-F3电池车间'), ('扬州基地', '一厂（晶运园区）-F2电池车间'), ('扬州基地', '一厂（晶运园区）-动力站F3'), ('扬州基地', '二厂（晶山园区）-晶山组件（M3）'), ('扬州基地', '一厂（晶运园区）-动力站-配电室')]
2025-09-03 15:48:43,018 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:43,018 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:43,035 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:43,602 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_1_扬州
2025-09-03 15:48:43,602 - INFO - [2_table_aggregator.py] 原始表c的行数: 11363
2025-09-03 15:48:43,602 - INFO - [2_table_aggregator.py] 汇总表的行数: 11363
2025-09-03 15:48:43,602 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-03 15:48:43,602 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-03 15:48:43,602 - INFO - [2_table_aggregator.py] 行 1: ('LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '耗电', '7', '电池车间LPCVD自动化312#电能', '电池车间LPCVD自动化312', 'YZ-002-DC-58-206-0037#AE0005-FV', '85262', 'LPCVD自动化312（JAYZ2438173）', '90002', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-58-206-0037', '通过', '反馈值', '能耗类', '正向有功电度', 'LPCVD自动化', 'LPCVD自动化', '1', 'LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000250', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', 'LPCVD')
2025-09-03 15:48:43,602 - INFO - [2_table_aggregator.py] 行 2: ('硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '耗电', '7', '电池车间硼扩自动化317#电能', '电池车间硼扩自动化317', 'YZ-002-DC-43-156-0039#AE0005-FV', '85636', '硼扩自动化317（JAYZ23C7297）', '89886', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-43-156-0039', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩自动化', '硼扩自动化', '1', '硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000134', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', '硼扩')
2025-09-03 15:48:43,602 - INFO - [2_table_aggregator.py] 行 3: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-03 15:48:43,602 - INFO - [2_table_aggregator.py] 行 4: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-03 15:48:43,602 - INFO - [2_table_aggregator.py] 行 5: ('背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '运行状态', None, '电池车间背膜主机307#炉管5#设备运行状态', '电池车间背膜主机307', 'YZ-002-DC-53-175-0040#SN0005-RS', '90931', '背膜主机307（JAYZ2417811）', '90116', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-53-175-0040', '通过', '运行状态', '信号类', '状态信号', '背膜主机', '背膜主机', '1', '背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000358', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '背膜')
2025-09-03 15:48:43,607 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:43,610 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_2_东台
2025-09-03 15:48:43,619 - INFO - [2_table_aggregator.py] 表 1_汇总表_2_东台 创建成功
2025-09-03 15:48:43,619 - INFO - [2_table_aggregator.py] 正在为基地 东台 执行数据聚合...
2025-09-03 15:48:43,622 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:43,624 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_2_东台' 行数: 5767
2025-09-03 15:48:43,648 - INFO - [2_table_aggregator.py] a表 'a采集点表_2_东台' 行数: 77532
2025-09-03 15:48:43,656 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_2_东台' 行数: 5131
2025-09-03 15:48:43,657 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:43,658 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:43,658 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:43,694 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('东台基地', '一厂-电池车间1'), ('东台基地', '一厂-组件车间1'), ('东台基地', '一厂动力站'), ('东台基地', '一厂办公区'), ('东台基地', '其他区域')]
2025-09-03 15:48:43,709 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:43,710 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:43,734 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:44,299 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_2_东台
2025-09-03 15:48:44,300 - INFO - [2_table_aggregator.py] 原始表c的行数: 5767
2025-09-03 15:48:44,300 - INFO - [2_table_aggregator.py] 汇总表的行数: 5767
2025-09-03 15:48:44,300 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-03 15:48:44,300 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-03 15:48:44,300 - INFO - [2_table_aggregator.py] 行 1: ('BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '产量', None, 'BSG上料2号机#产量下料', 'BSG上料2号机', 'DT-001-DC-45-160-0002#YE0004-FV', '384554', 'BSG下料-BSGX1002', '512016', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0002', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-03 15:48:44,300 - INFO - [2_table_aggregator.py] 行 2: ('BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '产量', None, 'BSG上料4号机#产量下料', 'BSG上料4号机', 'DT-001-DC-45-160-0003#YE0004-FV', '384544', 'BSG下料-BSGX1004', '512018', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0003', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-03 15:48:44,300 - INFO - [2_table_aggregator.py] 行 3: ('BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '产量', None, 'BSG上料6号机#产量下料', 'BSG上料6号机', 'DT-001-DC-45-160-0004#YE0004-FV', '384586', 'BSG下料-BSGX1006', '512019', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0004', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-03 15:48:44,300 - INFO - [2_table_aggregator.py] 行 4: ('BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '产量', None, 'BSG上料8号机#产量下料', 'BSG上料8号机', 'DT-001-DC-45-160-0006#YE0004-FV', '384562', 'BSG下料-BSGX1008', '512022', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0006', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-03 15:48:44,300 - INFO - [2_table_aggregator.py] 行 5: ('BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '产量', None, 'BSG上料12号机#产量下料', 'BSG上料12号机', 'DT-001-DC-45-160-0008#YE0004-FV', '384488', 'BSG下料-BSGX1012', '512025', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0008', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-03 15:48:44,300 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:44,309 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_3_合肥
2025-09-03 15:48:44,372 - INFO - [2_table_aggregator.py] 表 1_汇总表_3_合肥 创建成功
2025-09-03 15:48:44,372 - INFO - [2_table_aggregator.py] 正在为基地 合肥 执行数据聚合...
2025-09-03 15:48:44,375 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:44,376 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_3_合肥' 行数: 2417
2025-09-03 15:48:44,397 - INFO - [2_table_aggregator.py] a表 'a采集点表_3_合肥' 行数: 41670
2025-09-03 15:48:44,400 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_3_合肥' 行数: 1890
2025-09-03 15:48:44,401 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:44,401 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:44,402 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:44,410 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('合肥基地', '二厂（二部）-六车间（201#智慧工厂）'), ('合肥基地', '一厂（一部）-二车间（116#创新工厂）'), ('合肥基地', '207动力站'), ('合肥基地', '207动力站-配电室'), ('合肥基地', '一厂（一部）-四车间（110#领跑工厂）-配电室')]
2025-09-03 15:48:44,417 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:44,417 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:44,429 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:44,600 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_3_合肥
2025-09-03 15:48:44,601 - INFO - [2_table_aggregator.py] 原始表c的行数: 2417
2025-09-03 15:48:44,601 - INFO - [2_table_aggregator.py] 汇总表的行数: 2417
2025-09-03 15:48:44,601 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-03 15:48:44,601 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-03 15:48:44,601 - INFO - [2_table_aggregator.py] 行 1: ('二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '耗电', '7', '智慧工厂一-6BL15002-总有功电度', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#AE0003-FV', '10', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000048', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-03 15:48:44,601 - INFO - [2_table_aggregator.py] 行 2: ('二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '产量', None, '智慧工厂一-6BL15002-产量', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#YE0005-FV', '12', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '统计类', '产量', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000049', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-03 15:48:44,601 - INFO - [2_table_aggregator.py] 行 3: ('二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '运行状态', None, '智慧工厂一-6BL15002运行状态', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#SN0002-RS', '9', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'HF-EMC-RS-E-NS-NS-000000049', '设备管控', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-03 15:48:44,601 - INFO - [2_table_aggregator.py] 行 4: ('二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '耗电', '7', '智慧工厂一-6CQ13002-总有功电度', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#AE0001-FV', '759', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000078', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-03 15:48:44,601 - INFO - [2_table_aggregator.py] 行 5: ('二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '产量', None, '智慧工厂一-6CQ13002-产量', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#YE0002-FV', '760', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '统计类', '产量', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000079', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-03 15:48:44,604 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:44,609 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_4_鄂尔多斯
2025-09-03 15:48:44,618 - INFO - [2_table_aggregator.py] 表 1_汇总表_4_鄂尔多斯 创建成功
2025-09-03 15:48:44,619 - INFO - [2_table_aggregator.py] 正在为基地 鄂尔多斯 执行数据聚合...
2025-09-03 15:48:44,620 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:44,622 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_4_鄂尔多斯' 行数: 484
2025-09-03 15:48:44,639 - INFO - [2_table_aggregator.py] a表 'a采集点表_4_鄂尔多斯' 行数: 14404
2025-09-03 15:48:44,641 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_4_鄂尔多斯' 行数: 310
2025-09-03 15:48:44,642 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:44,643 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:44,643 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:44,655 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('鄂尔多斯', '二厂（B区）-B4-5GW组件车间2'), ('', '二厂（B区）-B4-5GW组件车间2')]
2025-09-03 15:48:44,659 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:44,659 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:44,671 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:44,730 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_4_鄂尔多斯
2025-09-03 15:48:44,730 - INFO - [2_table_aggregator.py] 原始表c的行数: 484
2025-09-03 15:48:44,730 - INFO - [2_table_aggregator.py] 汇总表的行数: 484
2025-09-03 15:48:44,730 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-03 15:48:44,730 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-03 15:48:44,730 - INFO - [2_table_aggregator.py] 行 1: ('2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '运行状态', None, '2#串焊机01状态', '2#串焊机01', 'EE-019-ZJ-61-224-0002#SN0003-RS', '1143', '2#串焊机01（JAEEDS2020087）', '162', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0002', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000004', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-03 15:48:44,730 - INFO - [2_table_aggregator.py] 行 2: ('2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '运行状态', None, '2#串焊机02状态', '2#串焊机02', 'EE-019-ZJ-61-224-0001#SN0005-RS', '1132', '2#串焊机02（JAEEDS2020088）', '160', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0001', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-03 15:48:44,730 - INFO - [2_table_aggregator.py] 行 3: ('2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '运行状态', None, '2#串焊机03状态', '2#串焊机03', 'EE-019-ZJ-61-224-0004#SN0004-RS', '1161', '2#串焊机03（JAEEDS2020089）', '167', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0004', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000006', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-03 15:48:44,730 - INFO - [2_table_aggregator.py] 行 4: ('2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '运行状态', None, '2#串焊机04状态', '2#串焊机04', 'EE-019-ZJ-61-224-0003#SN0001-RS', '1149', '2#串焊机04（JAEEDS2020090）', '164', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0003', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-03 15:48:44,730 - INFO - [2_table_aggregator.py] 行 5: ('1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '产量', None, '1#二道胶膜裁切机产量', '1#二道胶膜裁切机02', 'EE-019-ZJ-61-228-0001#YE0001-FV', '1115', '1#二道胶膜裁切机02（JAEEDS2020026）', '155', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-228-0001', '通过', '反馈值', '统计类', '产量', '裁切机', '裁切机', '1', '1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'EE-EMS-YE-E-NS-NS-000000016', '能源管理', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-03 15:48:44,731 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:44,739 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_5_曲靖
2025-09-03 15:48:44,748 - INFO - [2_table_aggregator.py] 表 1_汇总表_5_曲靖 创建成功
2025-09-03 15:48:44,748 - INFO - [2_table_aggregator.py] 正在为基地 曲靖 执行数据聚合...
2025-09-03 15:48:44,749 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:44,754 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_5_曲靖' 行数: 14880
2025-09-03 15:48:44,775 - INFO - [2_table_aggregator.py] a表 'a采集点表_5_曲靖' 行数: 82370
2025-09-03 15:48:44,784 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_5_曲靖' 行数: 8315
2025-09-03 15:48:44,785 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:44,785 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:44,786 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:44,800 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('曲靖基地', '三厂（三期）-电池一期车间（101）'), ('曲靖基地', '二厂（二期）-201拉晶车间'), ('曲靖基地', '二厂（二期）-201加工车间'), ('曲靖基地', '三厂（三期）-组件一期车间（104）'), ('曲靖基地', '二厂（二期）-202拉晶车间')]
2025-09-03 15:48:44,811 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:44,811 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:44,827 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:45,448 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_5_曲靖
2025-09-03 15:48:45,448 - INFO - [2_table_aggregator.py] 原始表c的行数: 14880
2025-09-03 15:48:45,448 - INFO - [2_table_aggregator.py] 汇总表的行数: 14887
2025-09-03 15:48:45,448 - INFO - [2_table_aggregator.py] 警告: 行数不一致! 可能丢失了 -7 行数据
2025-09-03 15:48:45,448 - INFO - [2_table_aggregator.py] 建议检查连接条件和数据完整性
2025-09-03 15:48:45,448 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-03 15:48:45,448 - INFO - [2_table_aggregator.py] 行 1: ('西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '运行状态', None, '西区POLY尾气处理B19#运行状态', '西区POLY尾气处理B19', 'QJ-028-DC-56-199-0039#SN0001-RS', '1070', '西区POLY尾气处理B19（QJJAKJ12021493）', '145', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0039', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-03 15:48:45,448 - INFO - [2_table_aggregator.py] 行 2: ('西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '运行状态', None, '西区ALD尾气处理B01#运行状态', '西区ALD尾气处理B01', 'QJ-028-DC-56-199-0044#SN0001-RS', '1110', '西区ALD尾气处理B01（QJJAKJ12021632）', '151', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0044', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-03 15:48:45,448 - INFO - [2_table_aggregator.py] 行 3: ('西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '运行状态', None, '西区ALD尾气处理B02#运行状态', '西区ALD尾气处理B02', 'QJ-028-DC-56-199-0045#SN0001-RS', '1118', '西区ALD尾气处理B02（QJJAKJ12021633）', '152', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0045', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-03 15:48:45,448 - INFO - [2_table_aggregator.py] 行 4: ('西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '运行状态', None, '西区ALD尾气处理B03#运行状态', '西区ALD尾气处理B03', 'QJ-028-DC-56-199-0046#SN0001-RS', '1126', '西区ALD尾气处理B03（QJJAKJ120216334）', '153', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0046', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-03 15:48:45,453 - INFO - [2_table_aggregator.py] 行 5: ('西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '运行状态', None, '西区ALD尾气处理B04#运行状态', '西区ALD尾气处理B04', 'QJ-028-DC-56-199-0001#SN0001-RS', '8', '西区ALD尾气处理B04（QJJAKJ120216335）', '5', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0001', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000009', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-03 15:48:45,453 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:45,455 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_6_奉贤
2025-09-03 15:48:45,465 - INFO - [2_table_aggregator.py] 表 1_汇总表_6_奉贤 创建成功
2025-09-03 15:48:45,465 - INFO - [2_table_aggregator.py] 正在为基地 奉贤 执行数据聚合...
2025-09-03 15:48:45,468 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:45,470 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_6_奉贤' 行数: 648
2025-09-03 15:48:45,478 - INFO - [2_table_aggregator.py] a表 'a采集点表_6_奉贤' 行数: 6134
2025-09-03 15:48:45,480 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_6_奉贤' 行数: 513
2025-09-03 15:48:45,481 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:45,482 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:45,482 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:45,484 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('奉贤基地', '一厂-B2组件车间（北区）'), ('奉贤基地', '一厂-B1储能车间'), ('奉贤基地', '厂外-C2接线盒车间'), ('奉贤基地', 'E2动力站'), ('奉贤基地', '35KV变电站')]
2025-09-03 15:48:45,489 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:45,489 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:45,500 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:45,550 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_6_奉贤
2025-09-03 15:48:45,550 - INFO - [2_table_aggregator.py] 原始表c的行数: 648
2025-09-03 15:48:45,550 - INFO - [2_table_aggregator.py] 汇总表的行数: 648
2025-09-03 15:48:45,550 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-03 15:48:45,550 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-03 15:48:45,550 - INFO - [2_table_aggregator.py] 行 1: ('自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '运行状态', None, '装工装_201_PLC#运行状态', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#SN0001-RS', '162', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '通过', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-03 15:48:45,550 - INFO - [2_table_aggregator.py] 行 2: ('自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '耗电', '7', '装工装_201_PLC#总有功电度', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#AE0004-FV', '165', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-03 15:48:45,550 - INFO - [2_table_aggregator.py] 行 3: ('在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '运行状态', None, '裁切机_501_PLC#运行状态', '裁切机_501_PLC', 'FX-002-ZJ-61-228-0001#SN0001-RS', '153', '在线裁切机一道-FX02CQ0501', '29', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-61-228-0001', '通过', '运行状态', '信号类', '状态信号', '一道EVA裁切机', '一道EVA裁切机', '1', '在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000079', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '焊接')
2025-09-03 15:48:45,550 - INFO - [2_table_aggregator.py] 行 4: ('自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '运行状态', None, '装工装_301_PLC#运行状态', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#SN0001-RS', '166', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000112', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-03 15:48:45,550 - INFO - [2_table_aggregator.py] 行 5: ('自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '耗电', '7', '装工装_301_PLC#总有功电度', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#AE0004-FV', '169', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000040', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-03 15:48:45,554 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:45,557 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_7_包头
2025-09-03 15:48:45,564 - INFO - [2_table_aggregator.py] 表 1_汇总表_7_包头 创建成功
2025-09-03 15:48:45,564 - INFO - [2_table_aggregator.py] 正在为基地 包头 执行数据聚合...
2025-09-03 15:48:45,564 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:45,568 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_7_包头' 行数: 10009
2025-09-03 15:48:45,588 - INFO - [2_table_aggregator.py] a表 'a采集点表_7_包头' 行数: 59305
2025-09-03 15:48:45,596 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_7_包头' 行数: 4806
2025-09-03 15:48:45,597 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:45,598 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:45,598 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:45,608 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('包头基地', '二厂-拉晶车间'), ('包头基地', '三厂-拉晶车间'), ('包头基地', '二厂-加工车间'), ('包头基地', '三厂-切片车间-配电室'), ('包头基地', '三厂-动力站-配电室')]
2025-09-03 15:48:45,617 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:45,617 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:45,633 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:46,020 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_7_包头
2025-09-03 15:48:46,020 - INFO - [2_table_aggregator.py] 原始表c的行数: 10009
2025-09-03 15:48:46,020 - INFO - [2_table_aggregator.py] 汇总表的行数: 10009
2025-09-03 15:48:46,020 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-03 15:48:46,020 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-03 15:48:46,020 - INFO - [2_table_aggregator.py] 行 1: ('二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-03 15:48:46,020 - INFO - [2_table_aggregator.py] 行 2: ('二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '产量', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-03 15:48:46,020 - INFO - [2_table_aggregator.py] 行 3: ('二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '耗电', '7', '单晶炉#电能', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#AE0003-FV', '9643', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '反馈值', '能耗类', '正向有功电度', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'BT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-03 15:48:46,020 - INFO - [2_table_aggregator.py] 行 4: ('二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '单晶炉_阳光1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-03 15:48:46,020 - INFO - [2_table_aggregator.py] 行 5: ('二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '产量', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '单晶炉_阳光1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-03 15:48:46,022 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:46,039 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_8_义乌
2025-09-03 15:48:46,048 - INFO - [2_table_aggregator.py] 表 1_汇总表_8_义乌 创建成功
2025-09-03 15:48:46,048 - INFO - [2_table_aggregator.py] 正在为基地 义乌 执行数据聚合...
2025-09-03 15:48:46,049 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:46,051 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_8_义乌' 行数: 1467
2025-09-03 15:48:46,061 - INFO - [2_table_aggregator.py] a表 'a采集点表_8_义乌' 行数: 9645
2025-09-03 15:48:46,064 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_8_义乌' 行数: 1363
2025-09-03 15:48:46,065 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:46,065 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:46,066 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:46,073 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('义乌基地', '一厂-组件车间一'), ('义乌基地', '仓库'), ('义乌基地', '动力站-配电室'), ('义乌基地', '一厂-电池车间一'), ('义乌基地', '二厂-电池车间二')]
2025-09-03 15:48:46,080 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:46,080 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:46,091 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:46,165 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_8_义乌
2025-09-03 15:48:46,166 - INFO - [2_table_aggregator.py] 原始表c的行数: 1467
2025-09-03 15:48:46,166 - INFO - [2_table_aggregator.py] 汇总表的行数: 1467
2025-09-03 15:48:46,166 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-03 15:48:46,166 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-03 15:48:46,166 - INFO - [2_table_aggregator.py] 行 1: ('1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '运行状态', None, '1上玻璃102-设备状态', 'KEP-HC', 'YW-003-ZJ-61-256-0010#SN0001-RS', '1', '1上玻璃102', '1', '一厂-组件车间一', '003', 'YW-003-ZJ-61-256-0010', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-03 15:48:46,166 - INFO - [2_table_aggregator.py] 行 2: ('1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '运行状态', None, '1汇流条竖起机141-设备状态', 'KEP-HC', 'YW-003-ZJ-60-211-0002#SN0001-RS', '100', '1汇流条竖起机141', '23', '一厂-组件车间一', '003', 'YW-003-ZJ-60-211-0002', '通过', '运行状态', '信号类', '状态信号', '自动捋引线', '自动捋引线', '1', '1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '装框')
2025-09-03 15:48:46,166 - INFO - [2_table_aggregator.py] 行 3: ('1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '运行状态', None, '1层压机101-02-设备状态', 'KEP-HC', 'YW-003-ZJ-62-230-0021#SN0003-RS', '1001', '1层压机101-02', '158', '一厂-组件车间一', '003', 'YW-003-ZJ-62-230-0021', '通过', '运行状态', '信号类', '状态信号', '层压机', '层压机', '1', '1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '层压')
2025-09-03 15:48:46,166 - INFO - [2_table_aggregator.py] 行 4: ('1排版机092-产量', '0#10_003_22#160#Sum', '产量', None, '1排版机092-设备当班产能', 'KEP-HC', 'YW-003-ZJ-61-227-0015#YE0001-FV', '1004', '1排版机092', '160', '一厂-组件车间一', '003', 'YW-003-ZJ-61-227-0015', '通过', '反馈值', '统计类', '产量', '排版机', '排版机', '1', '1排版机092-产量', '0#10_003_22#160#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'YW-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-03 15:48:46,166 - INFO - [2_table_aggregator.py] 行 5: ('1分档机111-耗电', '7#10_003_22#156#Sum', '耗电', '7', '1分档机111-电量', 'KEP-HC', 'YW-003-ZJ-64-239-0004#AE0005-FV', '1005', '1分档机111', '156', '一厂-组件车间一', '003', 'YW-003-ZJ-64-239-0004', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '1分档机111-耗电', '7#10_003_22#156#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YW-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '包装')
2025-09-03 15:48:46,168 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:46,171 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_9_邢台
2025-09-03 15:48:46,180 - INFO - [2_table_aggregator.py] 表 1_汇总表_9_邢台 创建成功
2025-09-03 15:48:46,180 - INFO - [2_table_aggregator.py] 正在为基地 邢台 执行数据聚合...
2025-09-03 15:48:46,181 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:46,183 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_9_邢台' 行数: 943
2025-09-03 15:48:46,303 - INFO - [2_table_aggregator.py] a表 'a采集点表_9_邢台' 行数: 8174
2025-09-03 15:48:46,305 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_9_邢台' 行数: 488
2025-09-03 15:48:46,306 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:46,307 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:46,307 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:46,316 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('邢台基地', '三厂（三园区）-组件三车间'), ('邢台基地', '二厂（二园区）-组件一车间')]
2025-09-03 15:48:46,321 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:46,321 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:46,335 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:46,393 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_9_邢台
2025-09-03 15:48:46,393 - INFO - [2_table_aggregator.py] 原始表c的行数: 943
2025-09-03 15:48:46,393 - INFO - [2_table_aggregator.py] 汇总表的行数: 943
2025-09-03 15:48:46,394 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-03 15:48:46,394 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-03 15:48:46,394 - INFO - [2_table_aggregator.py] 行 1: ('分档机1FD501-耗电', '7#2_004_22#249#Sum', '耗电', '7', '分档机1FD501#设备当前电能表示数', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#AE0002-FV', '801', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '分档机1FD501-耗电', '7#2_004_22#249#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'XT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '邢台基地', '组件工段', '包装')
2025-09-03 15:48:46,394 - INFO - [2_table_aggregator.py] 行 2: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', None, '分档机1FD501#设备白班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0004-FV', '805', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-03 15:48:46,394 - INFO - [2_table_aggregator.py] 行 3: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', None, '分档机1FD501#设备夜班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0005-FV', '807', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-03 15:48:46,394 - INFO - [2_table_aggregator.py] 行 4: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', None, '裁切机1EC106#设备白班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0002-FV', '249', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-03 15:48:46,394 - INFO - [2_table_aggregator.py] 行 5: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', None, '裁切机1EC106#设备夜班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0003-FV', '250', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-03 15:48:46,394 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:46,401 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_10_宁晋
2025-09-03 15:48:46,411 - INFO - [2_table_aggregator.py] 表 1_汇总表_10_宁晋 创建成功
2025-09-03 15:48:46,411 - INFO - [2_table_aggregator.py] 正在为基地 宁晋 执行数据聚合...
2025-09-03 15:48:46,413 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:46,416 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_10_宁晋' 行数: 1921
2025-09-03 15:48:46,436 - INFO - [2_table_aggregator.py] a表 'a采集点表_10_宁晋' 行数: 25728
2025-09-03 15:48:46,440 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_10_宁晋' 行数: 1223
2025-09-03 15:48:46,441 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:46,442 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:46,443 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:46,461 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('宁晋基地', '宁晋东城-电池车间'), ('宁晋基地', '宁晋东城-电池车间-配电室'), ('宁晋基地', '动力车间'), ('', '宁晋东城-电池车间')]
2025-09-03 15:48:46,464 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:46,464 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:46,480 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:46,605 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_10_宁晋
2025-09-03 15:48:46,605 - INFO - [2_table_aggregator.py] 原始表c的行数: 1921
2025-09-03 15:48:46,605 - INFO - [2_table_aggregator.py] 汇总表的行数: 1921
2025-09-03 15:48:46,605 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-03 15:48:46,605 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-03 15:48:46,605 - INFO - [2_table_aggregator.py] 行 1: ('硼扩工艺机401-耗电', '7#7_001_21#1#Sum', '耗电', '7', '宁晋电池-硼扩工艺机401-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-43-155-0001#AE0008-FV', '8', '硼扩工艺机401', '1', '宁晋东城-电池车间', '001', 'NJ-001-DC-43-155-0001', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩主机', '硼扩主机', '1', '硼扩工艺机401-耗电', '7#7_001_21#1#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '硼扩')
2025-09-03 15:48:46,605 - INFO - [2_table_aggregator.py] 行 2: ('硼扩工艺机410-耗电', '7#7_001_21#10#Sum', '耗电', '7', '宁晋电池-硼扩工艺机410-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-43-155-0010#AE0008-FV', '80', '硼扩工艺机410', '10', '宁晋东城-电池车间', '001', 'NJ-001-DC-43-155-0010', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩主机', '硼扩主机', '1', '硼扩工艺机410-耗电', '7#7_001_21#10#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '硼扩')
2025-09-03 15:48:46,605 - INFO - [2_table_aggregator.py] 行 3: ('背膜工艺机413-耗电', '7#7_001_21#100#Sum', '耗电', '7', '宁晋电池-背膜工艺机413-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0013#AE0008-FV', '800', '背膜工艺机413', '100', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0013', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机413-耗电', '7#7_001_21#100#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-03 15:48:46,605 - INFO - [2_table_aggregator.py] 行 4: ('背膜工艺机414-耗电', '7#7_001_21#101#Sum', '耗电', '7', '宁晋电池-背膜工艺机414-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0014#AE0008-FV', '808', '背膜工艺机414', '101', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0014', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机414-耗电', '7#7_001_21#101#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-03 15:48:46,606 - INFO - [2_table_aggregator.py] 行 5: ('背膜工艺机415-耗电', '7#7_001_21#102#Sum', '耗电', '7', '宁晋电池-背膜工艺机415-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0015#AE0008-FV', '816', '背膜工艺机415', '102', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0015', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机415-耗电', '7#7_001_21#102#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-03 15:48:46,609 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:46,613 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_11_石家庄
2025-09-03 15:48:46,622 - INFO - [2_table_aggregator.py] 表 1_汇总表_11_石家庄 创建成功
2025-09-03 15:48:46,622 - INFO - [2_table_aggregator.py] 正在为基地 石家庄 执行数据聚合...
2025-09-03 15:48:46,623 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:46,624 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_11_石家庄' 行数: 9846
2025-09-03 15:48:46,640 - INFO - [2_table_aggregator.py] a表 'a采集点表_11_石家庄' 行数: 82294
2025-09-03 15:48:46,641 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_11_石家庄' 行数: 3694
2025-09-03 15:48:46,642 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:46,643 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:46,643 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:46,695 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('石家庄基地', '一厂-动力站'), ('石家庄基地', '一厂-电池一期-配电室'), ('石家庄基地', '一厂-切片一期-配电室'), ('石家庄基地', '一厂-电池一期'), ('石家庄基地', '一厂-切片一期')]
2025-09-03 15:48:46,860 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:46,860 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:46,879 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:47,358 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_11_石家庄
2025-09-03 15:48:47,358 - INFO - [2_table_aggregator.py] 原始表c的行数: 9846
2025-09-03 15:48:47,358 - INFO - [2_table_aggregator.py] 汇总表的行数: 9846
2025-09-03 15:48:47,358 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-03 15:48:47,358 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-03 15:48:47,358 - INFO - [2_table_aggregator.py] 行 1: ('重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '耗电', '7', '78AH07#仪表正向有功总', '动力配电室仪表2.4.6.8', 'SJ-003-ZZ-01-JQ-0207#AE0001-FV', '447079', '78AH07', '519381', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0207', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000480', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-03 15:48:47,358 - INFO - [2_table_aggregator.py] 行 2: ('重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '耗电', '7', '71AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0102#AE0001-FV', '446711', '71AH07', '519013', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0102', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000182', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-03 15:48:47,358 - INFO - [2_table_aggregator.py] 行 3: ('重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '耗电', '7', '75AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0138#AE0001-FV', '446807', '75AH07', '519109', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0138', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000236', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-03 15:48:47,358 - INFO - [2_table_aggregator.py] 行 4: ('重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '耗电', '7', '77AH08#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0155#AE0001-FV', '446871', '77AH08', '519173', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0155', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000483', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-03 15:48:47,358 - INFO - [2_table_aggregator.py] 行 5: ('重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '耗电', '7', '71AH06#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0099#AE0001-FV', '446703', '71AH06', '519005', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0099', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000479', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-03 15:48:47,359 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:47,366 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_12_巴彦淖尔
2025-09-03 15:48:47,375 - INFO - [2_table_aggregator.py] 表 1_汇总表_12_巴彦淖尔 创建成功
2025-09-03 15:48:47,375 - INFO - [2_table_aggregator.py] 正在为基地 巴彦淖尔 执行数据聚合...
2025-09-03 15:48:47,376 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-03 15:48:47,376 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_12_巴彦淖尔' 行数: 0
2025-09-03 15:48:47,379 - INFO - [2_table_aggregator.py] a表 'a采集点表_12_巴彦淖尔' 行数: 2119
2025-09-03 15:48:47,379 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_12_巴彦淖尔' 行数: 0
2025-09-03 15:48:47,380 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-03 15:48:47,381 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-03 15:48:47,381 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-03 15:48:47,383 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('巴彦淖尔', '一厂（一期）-5GW组件车间')]
2025-09-03 15:48:47,385 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-03 15:48:47,385 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-03 15:48:47,397 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-03 15:48:47,399 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_12_巴彦淖尔
2025-09-03 15:48:47,399 - INFO - [2_table_aggregator.py] 原始表c的行数: 0
2025-09-03 15:48:47,399 - INFO - [2_table_aggregator.py] 汇总表的行数: 0
2025-09-03 15:48:47,399 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-03 15:48:47,399 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-03 15:48:47,399 - INFO - [2_table_aggregator.py] 所有基地数据聚合完成!
2025-09-03 15:48:47,400 - INFO - [2_table_aggregator.py] 数据库连接已关闭
2025-09-03 15:48:47,458 - INFO - 脚本 2_table_aggregator.py 成功完成 (返回码: 0)
2025-09-03 15:48:47,459 - INFO - 脚本 2_table_aggregator.py 执行完成，继续下一个
2025-09-03 15:48:47,459 - INFO - 正在运行脚本: 3_merge_tables.py
2025-09-03 15:48:47,459 - INFO - 开始运行脚本: D:\JA\database\3_merge_tables.py
2025-09-03 15:48:47,459 - INFO - 工作目录: D:\JA\database
2025-09-03 15:48:48,693 - INFO - [3_merge_tables.py] 开始处理 12 个基地...
2025-09-03 15:48:48,748 - INFO - [3_merge_tables.py] 正在处理: 扬州基地...正在处理: 东台基地...
2025-09-03 15:48:48,748 - INFO - [3_merge_tables.py] 正在处理: 合肥基地...
2025-09-03 15:48:48,749 - INFO - [3_merge_tables.py] 正在处理: 鄂尔多斯基地...
2025-09-03 15:48:48,757 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_1_扬州
2025-09-03 15:48:48,758 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_2_东台
2025-09-03 15:48:48,758 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_3_合肥
2025-09-03 15:48:48,767 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_2_东台
2025-09-03 15:48:48,768 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_3_合肥
2025-09-03 15:48:48,771 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_1_扬州
2025-09-03 15:48:48,777 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-03 15:48:48,785 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-03 15:48:49,058 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-03 15:48:49,253 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:48:49,254 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:48:49,267 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\04鄂尔多斯基地\2_采集点+设备合并表_4_鄂尔多斯_20250903154848.xlsx
2025-09-03 15:48:49,630 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_3_合肥
2025-09-03 15:48:49,987 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_1_扬州
2025-09-03 15:48:50,065 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_2_东台
2025-09-03 15:48:53,149 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_4_鄂尔多斯_20250903154848.xlsx
2025-09-03 15:48:53,149 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:48:54,171 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:48:54,172 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:48:54,198 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\03合肥基地\2_采集点+设备合并表_3_合肥_20250903154848.xlsx
2025-09-03 15:49:04,538 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:49:04,539 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:49:04,576 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\02东台基地\2_采集点+设备合并表_2_东台_20250903154848.xlsx
2025-09-03 15:49:14,777 - INFO - [3_merge_tables.py] 正在处理: 曲靖基地...
2025-09-03 15:49:14,839 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_5_曲靖
2025-09-03 15:49:14,848 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_5_曲靖
2025-09-03 15:49:15,637 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_5_曲靖
2025-09-03 15:49:18,276 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:49:18,278 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:49:18,318 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\01扬州基地\2_采集点+设备合并表_1_扬州_20250903154848.xlsx
2025-09-03 15:49:32,569 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_3_合肥_20250903154848.xlsx
2025-09-03 15:49:32,570 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:49:41,942 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:49:41,943 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:49:41,990 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\05曲靖基地\2_采集点+设备合并表_5_曲靖_20250903154848.xlsx
2025-09-03 15:49:58,654 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_2_东台_20250903154848.xlsx
2025-09-03 15:49:58,654 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:49:59,172 - INFO - [3_merge_tables.py] 正在处理: 奉贤基地...
2025-09-03 15:49:59,242 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_6_奉贤
2025-09-03 15:49:59,314 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_6_奉贤
2025-09-03 15:49:59,440 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_6_奉贤
2025-09-03 15:50:02,208 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:50:02,208 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:50:02,228 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\06奉贤基地\2_采集点+设备合并表_6_奉贤_20250903154848.xlsx
2025-09-03 15:50:08,687 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_6_奉贤_20250903154848.xlsx
2025-09-03 15:50:08,687 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:50:17,861 - INFO - [3_merge_tables.py] 正在处理: 包头基地...
2025-09-03 15:50:17,924 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_7_包头
2025-09-03 15:50:17,933 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_7_包头
2025-09-03 15:50:18,629 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_7_包头
2025-09-03 15:50:22,336 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_1_扬州_20250903154848.xlsx
2025-09-03 15:50:22,338 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:50:37,623 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_5_曲靖_20250903154848.xlsx
2025-09-03 15:50:37,623 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:50:49,374 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:50:49,374 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:50:49,418 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\07包头基地\2_采集点+设备合并表_7_包头_20250903154848.xlsx
2025-09-03 15:51:19,863 - INFO - [3_merge_tables.py] 正在处理: 义乌基地...
2025-09-03 15:51:19,893 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_8_义乌
2025-09-03 15:51:19,903 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_8_义乌
2025-09-03 15:51:20,038 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_8_义乌
2025-09-03 15:51:20,198 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:51:20,198 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:51:20,202 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\08义乌基地\2_采集点+设备合并表_8_义乌_20250903154848.xlsx
2025-09-03 15:51:21,226 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_7_包头_20250903154848.xlsx
2025-09-03 15:51:21,226 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:51:26,379 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_8_义乌_20250903154848.xlsx
2025-09-03 15:51:26,380 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:51:39,313 - INFO - [3_merge_tables.py] 正在处理: 邢台基地...
2025-09-03 15:51:39,386 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_9_邢台
2025-09-03 15:51:39,396 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_9_邢台
2025-09-03 15:51:39,513 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_9_邢台
2025-09-03 15:51:42,107 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:51:42,109 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:51:42,112 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\09邢台基地\2_采集点+设备合并表_9_邢台_20250903154848.xlsx
2025-09-03 15:51:43,430 - INFO - [3_merge_tables.py] 正在处理: 宁晋基地...
2025-09-03 15:51:43,436 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_10_宁晋
2025-09-03 15:51:43,499 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_10_宁晋正在处理: 石家庄基地...
2025-09-03 15:51:43,504 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_11_石家庄
2025-09-03 15:51:43,511 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_11_石家庄
2025-09-03 15:51:43,544 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_9_邢台_20250903154848.xlsx
2025-09-03 15:51:43,544 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:51:43,965 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_10_宁晋
2025-09-03 15:51:44,490 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_11_石家庄
2025-09-03 15:51:46,066 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:51:46,067 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:51:46,079 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\10宁晋基地\2_采集点+设备合并表_10_宁晋_20250903154848.xlsx
2025-09-03 15:51:47,933 - INFO - [3_merge_tables.py] 正在处理: 巴彦淖尔基地...
2025-09-03 15:51:47,977 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-03 15:51:47,991 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-03 15:51:48,060 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-03 15:51:48,661 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:51:48,662 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:51:48,669 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\12巴彦淖尔基地\2_采集点+设备合并表_12_巴彦淖尔_20250903154848.xlsx
2025-09-03 15:51:50,188 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_12_巴彦淖尔_20250903154848.xlsx
2025-09-03 15:51:50,189 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:51:51,438 - INFO - [3_merge_tables.py] 重命名列
2025-09-03 15:51:51,438 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-03 15:51:51,478 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\11石家庄基地\2_采集点+设备合并表_11_石家庄_20250903154848.xlsx
2025-09-03 15:52:08,140 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_10_宁晋_20250903154848.xlsx
2025-09-03 15:52:08,140 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:52:17,642 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_11_石家庄_20250903154848.xlsx
2025-09-03 15:52:17,643 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-03 15:52:45,715 - INFO - [3_merge_tables.py] 所有基地处理完成! 总耗时: 237.02秒
2025-09-03 15:52:45,715 - INFO - [3_merge_tables.py] 开始合并所有基地文件...
2025-09-03 15:52:45,717 - INFO - [3_merge_tables.py] 正在合并: 扬州基地...
2025-09-03 15:53:04,455 - INFO - [3_merge_tables.py] 正在合并: 东台基地...
2025-09-03 15:53:20,439 - INFO - [3_merge_tables.py] 正在合并: 合肥基地...
2025-09-03 15:53:27,826 - INFO - [3_merge_tables.py] 正在合并: 鄂尔多斯基地...
2025-09-03 15:53:31,126 - INFO - [3_merge_tables.py] 正在合并: 曲靖基地...
2025-09-03 15:53:46,861 - INFO - [3_merge_tables.py] 正在合并: 奉贤基地...
2025-09-03 15:53:48,031 - INFO - [3_merge_tables.py] 正在合并: 包头基地...
2025-09-03 15:54:00,394 - INFO - [3_merge_tables.py] 正在合并: 义乌基地...
2025-09-03 15:54:03,284 - INFO - [3_merge_tables.py] 正在合并: 邢台基地...
2025-09-03 15:54:05,340 - INFO - [3_merge_tables.py] 正在合并: 宁晋基地...
2025-09-03 15:54:09,677 - INFO - [3_merge_tables.py] 正在合并: 石家庄基地...
2025-09-03 15:54:26,229 - INFO - [3_merge_tables.py] 正在合并: 巴彦淖尔基地...
2025-09-03 15:56:52,077 - INFO - [3_merge_tables.py] 合并完成! 耗时: 246.36秒
2025-09-03 15:56:52,077 - INFO - [3_merge_tables.py] 正在应用基本格式...
2025-09-03 16:01:19,270 - INFO - [3_merge_tables.py] 合并文件已生成: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】采集点+设备_20250903154848.xlsx
2025-09-03 16:01:19,270 - INFO - [3_merge_tables.py] 程序已正常退出
2025-09-03 16:01:39,956 - INFO - 脚本 3_merge_tables.py 成功完成 (返回码: 0)
2025-09-03 16:01:39,957 - INFO - 脚本 3_merge_tables.py 执行完成，继续下一个
2025-09-03 16:01:39,957 - INFO - 正在运行脚本: 4_merge_calc_tables.py
2025-09-03 16:01:39,957 - INFO - 开始运行脚本: D:\JA\database\4_merge_calc_tables.py
2025-09-03 16:01:39,957 - INFO - 工作目录: D:\JA\database
2025-09-03 16:01:41,332 - INFO - [4_merge_calc_tables.py] 开始导出数据...
2025-09-03 16:01:41,332 - INFO - [4_merge_calc_tables.py] 输出目录: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点
2025-09-03 16:01:43,540 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_1_扬州 已导出到Sheet: 扬州
2025-09-03 16:01:44,504 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_2_东台 已导出到Sheet: 东台
2025-09-03 16:01:44,802 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_3_合肥 已导出到Sheet: 合肥
2025-09-03 16:01:44,864 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_4_鄂尔多斯 已导出到Sheet: 鄂尔多斯
2025-09-03 16:01:47,378 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_5_曲靖 已导出到Sheet: 曲靖
2025-09-03 16:01:47,457 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_6_奉贤 已导出到Sheet: 奉贤
2025-09-03 16:01:48,970 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_7_包头 已导出到Sheet: 包头
2025-09-03 16:01:49,163 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_8_义乌 已导出到Sheet: 义乌
2025-09-03 16:01:49,288 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_9_邢台 已导出到Sheet: 邢台
2025-09-03 16:01:49,548 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_10_宁晋 已导出到Sheet: 宁晋
2025-09-03 16:01:51,300 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_11_石家庄 已导出到Sheet: 石家庄
2025-09-03 16:01:51,310 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_12_巴彦淖尔 已导出到Sheet: 巴彦淖尔
2025-09-03 16:02:01,396 - INFO - [4_merge_calc_tables.py] 汇总Sheet已创建
2025-09-03 16:02:32,075 - INFO - [4_merge_calc_tables.py] 文件已保存为: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250903160141.xlsx
2025-09-03 16:02:32,111 - INFO - [4_merge_calc_tables.py] 文件验证成功: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250903160141.xlsx
2025-09-03 16:02:32,112 - INFO - [4_merge_calc_tables.py] 文件大小: 24618.07 KB
2025-09-03 16:02:32,112 - INFO - [4_merge_calc_tables.py] 导出完成，耗时: 50.78 秒
2025-09-03 16:02:32,112 - INFO - [4_merge_calc_tables.py] === 导出摘要 ===
2025-09-03 16:02:32,112 - INFO - [4_merge_calc_tables.py] 输出文件: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250903160141.xlsx
2025-09-03 16:02:32,112 - INFO - [4_merge_calc_tables.py] 包含工作表: 汇总 + 12个基地表
2025-09-03 16:02:34,075 - INFO - 脚本 4_merge_calc_tables.py 成功完成 (返回码: 0)
2025-09-03 16:02:34,076 - INFO - 脚本 4_merge_calc_tables.py 执行完成，继续下一个
2025-09-03 16:02:34,076 - INFO - 结束执行时间: 2025-09-03 16:02:34
2025-09-03 16:02:34,076 - INFO - ==================================================
2025-09-05 09:46:55,474 - INFO - ==================================================
2025-09-05 09:46:55,475 - INFO - 开始执行流水线 - 2025-09-05 09:46:55
2025-09-05 09:46:55,475 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-09-05 09:46:55,475 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-09-05 09:46:55,671 - INFO - pymysql版本: 1.4.6
2025-09-05 09:46:55,671 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-09-05 09:46:55,671 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-09-05 09:46:55,671 - INFO - 工作目录: D:\JA\database
2025-09-05 09:46:56,170 - INFO - [1_copy_to_local.py] 开始数据库同步任务: 2025-09-05 09:46:56
2025-09-05 09:46:56,170 - INFO - [1_copy_to_local.py] 开始同步基地: 扬州
2025-09-05 09:46:56,780 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_1_扬州
2025-09-05 09:47:08,877 - INFO - [1_copy_to_local.py] |- 同步完成: 86597 条数据
2025-09-05 09:47:08,878 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_1_扬州
2025-09-05 09:47:09,664 - INFO - [1_copy_to_local.py] |- 同步完成: 8171 条数据
2025-09-05 09:47:09,664 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_1_扬州
2025-09-05 09:47:09,917 - INFO - [1_copy_to_local.py] |- 同步完成: 11363 条数据
2025-09-05 09:47:09,918 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_1_扬州
2025-09-05 09:47:09,999 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-05 09:47:09,999 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_1_扬州
2025-09-05 09:47:10,452 - INFO - [1_copy_to_local.py] |- 同步完成: 8147 条数据
2025-09-05 09:47:10,452 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_1_扬州
2025-09-05 09:47:10,945 - INFO - [1_copy_to_local.py] |- 同步完成: 6076 条数据
2025-09-05 09:47:10,945 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_1_扬州
2025-09-05 09:47:11,328 - INFO - [1_copy_to_local.py] |- 同步完成: 3411 条数据
2025-09-05 09:47:11,338 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 15.17秒
2025-09-05 09:47:11,339 - INFO - [1_copy_to_local.py] 开始同步基地: 东台
2025-09-05 09:47:11,487 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_2_东台
2025-09-05 09:47:18,231 - INFO - [1_copy_to_local.py] |- 同步完成: 77532 条数据
2025-09-05 09:47:18,231 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_2_东台
2025-09-05 09:47:18,908 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-05 09:47:18,908 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_2_东台
2025-09-05 09:47:19,070 - INFO - [1_copy_to_local.py] |- 同步完成: 5767 条数据
2025-09-05 09:47:19,070 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_2_东台
2025-09-05 09:47:19,147 - INFO - [1_copy_to_local.py] |- 同步完成: 12 条数据
2025-09-05 09:47:19,147 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_2_东台
2025-09-05 09:47:19,511 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-05 09:47:19,511 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_2_东台
2025-09-05 09:47:19,893 - INFO - [1_copy_to_local.py] |- 同步完成: 4618 条数据
2025-09-05 09:47:19,893 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_2_东台
2025-09-05 09:47:20,109 - INFO - [1_copy_to_local.py] |- 同步完成: 1921 条数据
2025-09-05 09:47:20,112 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 8.77秒
2025-09-05 09:47:20,113 - INFO - [1_copy_to_local.py] 开始同步基地: 合肥
2025-09-05 09:47:28,280 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_3_合肥
2025-09-05 09:47:30,127 - INFO - [1_copy_to_local.py] |- 同步完成: 41670 条数据
2025-09-05 09:47:30,127 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_3_合肥
2025-09-05 09:47:30,389 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-05 09:47:30,389 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_3_合肥
2025-09-05 09:47:30,493 - INFO - [1_copy_to_local.py] |- 同步完成: 2417 条数据
2025-09-05 09:47:30,493 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_3_合肥
2025-09-05 09:47:30,560 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-05 09:47:30,560 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_3_合肥
2025-09-05 09:47:30,696 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-05 09:47:30,696 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_3_合肥
2025-09-05 09:47:30,837 - INFO - [1_copy_to_local.py] |- 同步完成: 2023 条数据
2025-09-05 09:47:30,837 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_3_合肥
2025-09-05 09:47:30,945 - INFO - [1_copy_to_local.py] |- 同步完成: 855 条数据
2025-09-05 09:47:30,952 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 10.84秒
2025-09-05 09:47:30,953 - INFO - [1_copy_to_local.py] 开始同步基地: 鄂尔多斯
2025-09-05 09:47:39,102 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_4_鄂尔多斯
2025-09-05 09:47:41,511 - INFO - [1_copy_to_local.py] |- 同步完成: 14404 条数据
2025-09-05 09:47:41,511 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_4_鄂尔多斯
2025-09-05 09:47:41,775 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-05 09:47:41,775 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_4_鄂尔多斯
2025-09-05 09:47:41,917 - INFO - [1_copy_to_local.py] |- 同步完成: 484 条数据
2025-09-05 09:47:41,917 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_4_鄂尔多斯
2025-09-05 09:47:41,983 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-05 09:47:41,983 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_4_鄂尔多斯
2025-09-05 09:47:42,074 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-05 09:47:42,076 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_4_鄂尔多斯
2025-09-05 09:47:42,238 - INFO - [1_copy_to_local.py] |- 同步完成: 794 条数据
2025-09-05 09:47:42,238 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_4_鄂尔多斯
2025-09-05 09:47:42,322 - INFO - [1_copy_to_local.py] |- 同步完成: 152 条数据
2025-09-05 09:47:42,324 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 11.37秒
2025-09-05 09:47:42,324 - INFO - [1_copy_to_local.py] 开始同步基地: 曲靖
2025-09-05 09:47:42,587 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_5_曲靖
2025-09-05 09:47:46,845 - INFO - [1_copy_to_local.py] |- 同步完成: 82370 条数据
2025-09-05 09:47:46,845 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_5_曲靖
2025-09-05 09:47:47,674 - INFO - [1_copy_to_local.py] |- 同步完成: 8315 条数据
2025-09-05 09:47:47,674 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_5_曲靖
2025-09-05 09:47:48,014 - INFO - [1_copy_to_local.py] |- 同步完成: 14880 条数据
2025-09-05 09:47:48,015 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_5_曲靖
2025-09-05 09:47:48,145 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-05 09:47:48,145 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_5_曲靖
2025-09-05 09:47:48,571 - INFO - [1_copy_to_local.py] |- 同步完成: 8316 条数据
2025-09-05 09:47:48,571 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_5_曲靖
2025-09-05 09:47:49,168 - INFO - [1_copy_to_local.py] |- 同步完成: 13973 条数据
2025-09-05 09:47:49,168 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_5_曲靖
2025-09-05 09:47:49,431 - INFO - [1_copy_to_local.py] |- 同步完成: 2491 条数据
2025-09-05 09:47:49,435 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 7.11秒
2025-09-05 09:47:49,436 - INFO - [1_copy_to_local.py] 开始同步基地: 奉贤
2025-09-05 09:47:49,600 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_6_奉贤
2025-09-05 09:47:50,122 - INFO - [1_copy_to_local.py] |- 同步完成: 6140 条数据
2025-09-05 09:47:50,122 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_6_奉贤
2025-09-05 09:47:50,249 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-09-05 09:47:50,249 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_6_奉贤
2025-09-05 09:47:50,350 - INFO - [1_copy_to_local.py] |- 同步完成: 648 条数据
2025-09-05 09:47:50,350 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_6_奉贤
2025-09-05 09:47:50,434 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-05 09:47:50,434 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_6_奉贤
2025-09-05 09:47:50,536 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-09-05 09:47:50,537 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_6_奉贤
2025-09-05 09:47:50,647 - INFO - [1_copy_to_local.py] |- 同步完成: 667 条数据
2025-09-05 09:47:50,647 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_6_奉贤
2025-09-05 09:47:50,761 - INFO - [1_copy_to_local.py] |- 同步完成: 280 条数据
2025-09-05 09:47:50,762 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.33秒
2025-09-05 09:47:50,762 - INFO - [1_copy_to_local.py] 开始同步基地: 包头
2025-09-05 09:47:50,889 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_7_包头
2025-09-05 09:47:53,419 - INFO - [1_copy_to_local.py] |- 同步完成: 59304 条数据
2025-09-05 09:47:53,419 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_7_包头
2025-09-05 09:47:53,789 - INFO - [1_copy_to_local.py] |- 同步完成: 4806 条数据
2025-09-05 09:47:53,789 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_7_包头
2025-09-05 09:47:54,031 - INFO - [1_copy_to_local.py] |- 同步完成: 10009 条数据
2025-09-05 09:47:54,032 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_7_包头
2025-09-05 09:47:54,096 - INFO - [1_copy_to_local.py] |- 同步完成: 10 条数据
2025-09-05 09:47:54,096 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_7_包头
2025-09-05 09:47:54,332 - INFO - [1_copy_to_local.py] |- 同步完成: 4805 条数据
2025-09-05 09:47:54,332 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_7_包头
2025-09-05 09:47:54,741 - INFO - [1_copy_to_local.py] |- 同步完成: 5574 条数据
2025-09-05 09:47:54,741 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_7_包头
2025-09-05 09:47:54,919 - INFO - [1_copy_to_local.py] |- 同步完成: 2019 条数据
2025-09-05 09:47:54,928 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 4.17秒
2025-09-05 09:47:54,929 - INFO - [1_copy_to_local.py] 开始同步基地: 义乌
2025-09-05 09:47:55,136 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_8_义乌
2025-09-05 09:47:55,903 - INFO - [1_copy_to_local.py] |- 同步完成: 9645 条数据
2025-09-05 09:47:55,903 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_8_义乌
2025-09-05 09:47:56,166 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-05 09:47:56,166 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_8_义乌
2025-09-05 09:47:56,278 - INFO - [1_copy_to_local.py] |- 同步完成: 1467 条数据
2025-09-05 09:47:56,280 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_8_义乌
2025-09-05 09:47:56,373 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-05 09:47:56,373 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_8_义乌
2025-09-05 09:47:56,514 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-05 09:47:56,514 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_8_义乌
2025-09-05 09:47:56,699 - INFO - [1_copy_to_local.py] |- 同步完成: 2776 条数据
2025-09-05 09:47:56,699 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_8_义乌
2025-09-05 09:47:56,845 - INFO - [1_copy_to_local.py] |- 同步完成: 4 条数据
2025-09-05 09:47:56,846 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.92秒
2025-09-05 09:47:56,847 - INFO - [1_copy_to_local.py] 开始同步基地: 邢台
2025-09-05 09:47:56,982 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_9_邢台
2025-09-05 09:47:57,558 - INFO - [1_copy_to_local.py] |- 同步完成: 8176 条数据
2025-09-05 09:47:57,558 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_9_邢台
2025-09-05 09:47:57,698 - INFO - [1_copy_to_local.py] |- 同步完成: 488 条数据
2025-09-05 09:47:57,698 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_9_邢台
2025-09-05 09:47:57,774 - INFO - [1_copy_to_local.py] |- 同步完成: 943 条数据
2025-09-05 09:47:57,774 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_9_邢台
2025-09-05 09:47:57,838 - INFO - [1_copy_to_local.py] |- 同步完成: 5 条数据
2025-09-05 09:47:57,838 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_9_邢台
2025-09-05 09:47:57,930 - INFO - [1_copy_to_local.py] |- 同步完成: 488 条数据
2025-09-05 09:47:57,930 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_9_邢台
2025-09-05 09:47:58,127 - INFO - [1_copy_to_local.py] |- 同步完成: 814 条数据
2025-09-05 09:47:58,127 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_9_邢台
2025-09-05 09:47:58,208 - INFO - [1_copy_to_local.py] |- 同步完成: 300 条数据
2025-09-05 09:47:58,209 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.36秒
2025-09-05 09:47:58,209 - INFO - [1_copy_to_local.py] 开始同步基地: 宁晋
2025-09-05 09:47:58,296 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_10_宁晋
2025-09-05 09:48:00,018 - INFO - [1_copy_to_local.py] |- 同步完成: 25728 条数据
2025-09-05 09:48:00,018 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_10_宁晋
2025-09-05 09:48:00,189 - INFO - [1_copy_to_local.py] |- 同步完成: 1223 条数据
2025-09-05 09:48:00,189 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_10_宁晋
2025-09-05 09:48:00,284 - INFO - [1_copy_to_local.py] |- 同步完成: 1921 条数据
2025-09-05 09:48:00,284 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_10_宁晋
2025-09-05 09:48:00,345 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-05 09:48:00,345 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_10_宁晋
2025-09-05 09:48:00,446 - INFO - [1_copy_to_local.py] |- 同步完成: 1223 条数据
2025-09-05 09:48:00,446 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_10_宁晋
2025-09-05 09:48:00,532 - INFO - [1_copy_to_local.py] |- 同步完成: 850 条数据
2025-09-05 09:48:00,532 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_10_宁晋
2025-09-05 09:48:00,612 - INFO - [1_copy_to_local.py] |- 同步完成: 377 条数据
2025-09-05 09:48:00,614 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 2.40秒
2025-09-05 09:48:00,614 - INFO - [1_copy_to_local.py] 开始同步基地: 石家庄
2025-09-05 09:48:00,690 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_11_石家庄
2025-09-05 09:48:05,315 - INFO - [1_copy_to_local.py] |- 同步完成: 82456 条数据
2025-09-05 09:48:05,315 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_11_石家庄
2025-09-05 09:48:05,665 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-09-05 09:48:05,665 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_11_石家庄
2025-09-05 09:48:05,844 - INFO - [1_copy_to_local.py] |- 同步完成: 9846 条数据
2025-09-05 09:48:05,845 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_11_石家庄
2025-09-05 09:48:05,895 - INFO - [1_copy_to_local.py] |- 同步完成: 16 条数据
2025-09-05 09:48:05,895 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_11_石家庄
2025-09-05 09:48:06,087 - INFO - [1_copy_to_local.py] |- 同步完成: 3694 条数据
2025-09-05 09:48:06,087 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_11_石家庄
2025-09-05 09:48:06,401 - INFO - [1_copy_to_local.py] |- 同步完成: 6433 条数据
2025-09-05 09:48:06,401 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_11_石家庄
2025-09-05 09:48:06,563 - INFO - [1_copy_to_local.py] |- 同步完成: 1208 条数据
2025-09-05 09:48:06,564 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 5.95秒
2025-09-05 09:48:06,565 - INFO - [1_copy_to_local.py] 开始同步基地: 巴彦淖尔
2025-09-05 09:48:06,701 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_12_巴彦淖尔
2025-09-05 09:48:07,021 - INFO - [1_copy_to_local.py] |- 同步完成: 2119 条数据
2025-09-05 09:48:07,021 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_12_巴彦淖尔
2025-09-05 09:48:07,109 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-05 09:48:07,109 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_12_巴彦淖尔
2025-09-05 09:48:07,172 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-05 09:48:07,172 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_12_巴彦淖尔
2025-09-05 09:48:07,237 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-05 09:48:07,237 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_12_巴彦淖尔
2025-09-05 09:48:07,301 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-05 09:48:07,301 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_12_巴彦淖尔
2025-09-05 09:48:07,394 - INFO - [1_copy_to_local.py] |- 同步完成: 158 条数据
2025-09-05 09:48:07,394 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_12_巴彦淖尔
2025-09-05 09:48:07,485 - INFO - [1_copy_to_local.py] |- 同步完成: 157 条数据
2025-09-05 09:48:07,486 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 0.92秒
2025-09-05 09:48:07,487 - INFO - [1_copy_to_local.py] 所有同步任务完成: 2025-09-05 09:48:07
2025-09-05 09:48:07,541 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-09-05 09:48:07,542 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-09-05 09:48:07,542 - INFO - 正在运行脚本: 1_copy_ems_to_local.py
2025-09-05 09:48:07,542 - INFO - 开始运行脚本: D:\JA\database\1_copy_ems_to_local.py
2025-09-05 09:48:07,542 - INFO - 工作目录: D:\JA\database
2025-09-05 09:48:08,059 - INFO - [1_copy_ems_to_local.py] 连接源数据库: 172.25.4.87:5432/ems_test
2025-09-05 09:48:08,360 - INFO - [1_copy_ems_to_local.py] 连接目标数据库: localhost:3306/mzr_db
2025-09-05 09:48:08,368 - INFO - [1_copy_ems_to_local.py] 开始迁移表: from_demo.dim_base -> x【字典】基地编码
2025-09-05 09:48:08,528 - INFO - [1_copy_ems_to_local.py] 表 x【字典】基地编码 创建成功
2025-09-05 09:48:08,584 - INFO - [1_copy_ems_to_local.py] 插入 12 行到 x【字典】基地编码
2025-09-05 09:48:08,585 - INFO - [1_copy_ems_to_local.py] 共插入 12 行到 x【字典】基地编码
2025-09-05 09:48:08,585 - INFO - [1_copy_ems_to_local.py] 表 from_demo.dim_base -> x【字典】基地编码 迁移完成
2025-09-05 09:48:08,585 - INFO - [1_copy_ems_to_local.py] 开始迁移表: from_demo.dim_system_type -> w【字典】系统编码
2025-09-05 09:48:08,655 - INFO - [1_copy_ems_to_local.py] 表 w【字典】系统编码 创建成功
2025-09-05 09:48:08,712 - INFO - [1_copy_ems_to_local.py] 插入 26 行到 w【字典】系统编码
2025-09-05 09:48:08,713 - INFO - [1_copy_ems_to_local.py] 共插入 26 行到 w【字典】系统编码
2025-09-05 09:48:08,714 - INFO - [1_copy_ems_to_local.py] 表 from_demo.dim_system_type -> w【字典】系统编码 迁移完成
2025-09-05 09:48:08,714 - INFO - [1_copy_ems_to_local.py] PostgreSQL连接已关闭
2025-09-05 09:48:08,714 - INFO - [1_copy_ems_to_local.py] MySQL连接已关闭
2025-09-05 09:48:08,714 - INFO - [1_copy_ems_to_local.py] 数据库连接已关闭
2025-09-05 09:48:08,760 - INFO - 脚本 1_copy_ems_to_local.py 成功完成 (返回码: 0)
2025-09-05 09:48:08,760 - INFO - 脚本 1_copy_ems_to_local.py 执行完成，继续下一个
2025-09-05 09:48:08,760 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-09-05 09:48:08,760 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-09-05 09:48:08,760 - INFO - 工作目录: D:\JA\database
2025-09-05 09:48:09,331 - INFO - [2_table_aggregator.py] 开始数据聚合流程...
2025-09-05 09:48:09,331 - INFO - [2_table_aggregator.py] 加载配置文件: 2_table_aggregator_config.json
2025-09-05 09:48:09,411 - INFO - [2_table_aggregator.py] 数据库连接成功
2025-09-05 09:48:09,418 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_1_扬州
2025-09-05 09:48:09,426 - INFO - [2_table_aggregator.py] 表 1_汇总表_1_扬州 创建成功
2025-09-05 09:48:09,426 - INFO - [2_table_aggregator.py] 正在为基地 扬州 执行数据聚合...
2025-09-05 09:48:09,429 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:09,434 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_1_扬州' 行数: 11363
2025-09-05 09:48:09,456 - INFO - [2_table_aggregator.py] a表 'a采集点表_1_扬州' 行数: 86597
2025-09-05 09:48:09,465 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_1_扬州' 行数: 8171
2025-09-05 09:48:09,467 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:09,471 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:09,471 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:09,550 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('扬州基地', '一厂（晶运园区）-F3电池车间'), ('扬州基地', '一厂（晶运园区）-F2电池车间'), ('扬州基地', '一厂（晶运园区）-动力站F3'), ('扬州基地', '二厂（晶山园区）-晶山组件（M3）'), ('扬州基地', '一厂（晶运园区）-动力站-配电室')]
2025-09-05 09:48:09,794 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:09,794 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:09,808 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:10,392 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_1_扬州
2025-09-05 09:48:10,393 - INFO - [2_table_aggregator.py] 原始表c的行数: 11363
2025-09-05 09:48:10,393 - INFO - [2_table_aggregator.py] 汇总表的行数: 11363
2025-09-05 09:48:10,393 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-05 09:48:10,393 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-05 09:48:10,393 - INFO - [2_table_aggregator.py] 行 1: ('LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '耗电', '7', '电池车间LPCVD自动化312#电能', '电池车间LPCVD自动化312', 'YZ-002-DC-58-206-0037#AE0005-FV', '85262', 'LPCVD自动化312（JAYZ2438173）', '90002', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-58-206-0037', '通过', '反馈值', '能耗类', '正向有功电度', 'LPCVD自动化', 'LPCVD自动化', '1', 'LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000250', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', 'LPCVD')
2025-09-05 09:48:10,393 - INFO - [2_table_aggregator.py] 行 2: ('硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '耗电', '7', '电池车间硼扩自动化317#电能', '电池车间硼扩自动化317', 'YZ-002-DC-43-156-0039#AE0005-FV', '85636', '硼扩自动化317（JAYZ23C7297）', '89886', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-43-156-0039', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩自动化', '硼扩自动化', '1', '硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000134', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', '硼扩')
2025-09-05 09:48:10,393 - INFO - [2_table_aggregator.py] 行 3: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-05 09:48:10,393 - INFO - [2_table_aggregator.py] 行 4: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-05 09:48:10,393 - INFO - [2_table_aggregator.py] 行 5: ('背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '运行状态', None, '电池车间背膜主机307#炉管5#设备运行状态', '电池车间背膜主机307', 'YZ-002-DC-53-175-0040#SN0005-RS', '90931', '背膜主机307（JAYZ2417811）', '90116', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-53-175-0040', '通过', '运行状态', '信号类', '状态信号', '背膜主机', '背膜主机', '1', '背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000358', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '背膜')
2025-09-05 09:48:10,398 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:10,404 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_2_东台
2025-09-05 09:48:10,412 - INFO - [2_table_aggregator.py] 表 1_汇总表_2_东台 创建成功
2025-09-05 09:48:10,412 - INFO - [2_table_aggregator.py] 正在为基地 东台 执行数据聚合...
2025-09-05 09:48:10,414 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:10,417 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_2_东台' 行数: 5767
2025-09-05 09:48:10,437 - INFO - [2_table_aggregator.py] a表 'a采集点表_2_东台' 行数: 77532
2025-09-05 09:48:10,444 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_2_东台' 行数: 5131
2025-09-05 09:48:10,446 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:10,447 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:10,447 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:10,484 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('东台基地', '一厂-电池车间1'), ('东台基地', '一厂-组件车间1'), ('东台基地', '一厂动力站'), ('东台基地', '一厂办公区'), ('东台基地', '其他区域')]
2025-09-05 09:48:10,493 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:10,493 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:10,506 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:10,913 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_2_东台
2025-09-05 09:48:10,914 - INFO - [2_table_aggregator.py] 原始表c的行数: 5767
2025-09-05 09:48:10,914 - INFO - [2_table_aggregator.py] 汇总表的行数: 5767
2025-09-05 09:48:10,914 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-05 09:48:10,914 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-05 09:48:10,914 - INFO - [2_table_aggregator.py] 行 1: ('BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '产量', None, 'BSG上料2号机#产量下料', 'BSG上料2号机', 'DT-001-DC-45-160-0002#YE0004-FV', '384554', 'BSG下料-BSGX1002', '512016', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0002', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-05 09:48:10,914 - INFO - [2_table_aggregator.py] 行 2: ('BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '产量', None, 'BSG上料4号机#产量下料', 'BSG上料4号机', 'DT-001-DC-45-160-0003#YE0004-FV', '384544', 'BSG下料-BSGX1004', '512018', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0003', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-05 09:48:10,914 - INFO - [2_table_aggregator.py] 行 3: ('BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '产量', None, 'BSG上料6号机#产量下料', 'BSG上料6号机', 'DT-001-DC-45-160-0004#YE0004-FV', '384586', 'BSG下料-BSGX1006', '512019', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0004', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-05 09:48:10,914 - INFO - [2_table_aggregator.py] 行 4: ('BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '产量', None, 'BSG上料8号机#产量下料', 'BSG上料8号机', 'DT-001-DC-45-160-0006#YE0004-FV', '384562', 'BSG下料-BSGX1008', '512022', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0006', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-05 09:48:10,914 - INFO - [2_table_aggregator.py] 行 5: ('BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '产量', None, 'BSG上料12号机#产量下料', 'BSG上料12号机', 'DT-001-DC-45-160-0008#YE0004-FV', '384488', 'BSG下料-BSGX1012', '512025', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0008', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-05 09:48:10,914 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:10,920 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_3_合肥
2025-09-05 09:48:10,930 - INFO - [2_table_aggregator.py] 表 1_汇总表_3_合肥 创建成功
2025-09-05 09:48:10,930 - INFO - [2_table_aggregator.py] 正在为基地 合肥 执行数据聚合...
2025-09-05 09:48:10,931 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:10,933 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_3_合肥' 行数: 2417
2025-09-05 09:48:10,956 - INFO - [2_table_aggregator.py] a表 'a采集点表_3_合肥' 行数: 41670
2025-09-05 09:48:10,962 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_3_合肥' 行数: 1890
2025-09-05 09:48:10,962 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:10,963 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:10,964 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:10,975 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('合肥基地', '二厂（二部）-六车间（201#智慧工厂）'), ('合肥基地', '一厂（一部）-二车间（116#创新工厂）'), ('合肥基地', '207动力站'), ('合肥基地', '207动力站-配电室'), ('合肥基地', '一厂（一部）-四车间（110#领跑工厂）-配电室')]
2025-09-05 09:48:10,984 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:10,984 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:10,997 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:11,252 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_3_合肥
2025-09-05 09:48:11,253 - INFO - [2_table_aggregator.py] 原始表c的行数: 2417
2025-09-05 09:48:11,253 - INFO - [2_table_aggregator.py] 汇总表的行数: 2417
2025-09-05 09:48:11,253 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-05 09:48:11,253 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-05 09:48:11,253 - INFO - [2_table_aggregator.py] 行 1: ('二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '耗电', '7', '智慧工厂一-6BL15002-总有功电度', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#AE0003-FV', '10', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000048', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-05 09:48:11,253 - INFO - [2_table_aggregator.py] 行 2: ('二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '产量', None, '智慧工厂一-6BL15002-产量', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#YE0005-FV', '12', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '统计类', '产量', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000049', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-05 09:48:11,253 - INFO - [2_table_aggregator.py] 行 3: ('二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '运行状态', None, '智慧工厂一-6BL15002运行状态', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#SN0002-RS', '9', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'HF-EMC-RS-E-NS-NS-000000049', '设备管控', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-05 09:48:11,253 - INFO - [2_table_aggregator.py] 行 4: ('二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '耗电', '7', '智慧工厂一-6CQ13002-总有功电度', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#AE0001-FV', '759', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000078', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-05 09:48:11,253 - INFO - [2_table_aggregator.py] 行 5: ('二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '产量', None, '智慧工厂一-6CQ13002-产量', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#YE0002-FV', '760', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '统计类', '产量', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000079', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-05 09:48:11,256 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:11,260 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_4_鄂尔多斯
2025-09-05 09:48:11,270 - INFO - [2_table_aggregator.py] 表 1_汇总表_4_鄂尔多斯 创建成功
2025-09-05 09:48:11,271 - INFO - [2_table_aggregator.py] 正在为基地 鄂尔多斯 执行数据聚合...
2025-09-05 09:48:11,273 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:11,275 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_4_鄂尔多斯' 行数: 484
2025-09-05 09:48:11,288 - INFO - [2_table_aggregator.py] a表 'a采集点表_4_鄂尔多斯' 行数: 14404
2025-09-05 09:48:11,290 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_4_鄂尔多斯' 行数: 310
2025-09-05 09:48:11,291 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:11,291 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:11,293 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:11,304 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('鄂尔多斯', '二厂（B区）-B4-5GW组件车间2'), ('', '二厂（B区）-B4-5GW组件车间2')]
2025-09-05 09:48:11,310 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:11,310 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:11,325 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:11,445 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_4_鄂尔多斯
2025-09-05 09:48:11,445 - INFO - [2_table_aggregator.py] 原始表c的行数: 484
2025-09-05 09:48:11,445 - INFO - [2_table_aggregator.py] 汇总表的行数: 484
2025-09-05 09:48:11,445 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-05 09:48:11,445 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-05 09:48:11,446 - INFO - [2_table_aggregator.py] 行 1: ('2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '运行状态', None, '2#串焊机01状态', '2#串焊机01', 'EE-019-ZJ-61-224-0002#SN0003-RS', '1143', '2#串焊机01（JAEEDS2020087）', '162', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0002', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000004', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-05 09:48:11,446 - INFO - [2_table_aggregator.py] 行 2: ('2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '运行状态', None, '2#串焊机02状态', '2#串焊机02', 'EE-019-ZJ-61-224-0001#SN0005-RS', '1132', '2#串焊机02（JAEEDS2020088）', '160', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0001', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-05 09:48:11,446 - INFO - [2_table_aggregator.py] 行 3: ('2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '运行状态', None, '2#串焊机03状态', '2#串焊机03', 'EE-019-ZJ-61-224-0004#SN0004-RS', '1161', '2#串焊机03（JAEEDS2020089）', '167', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0004', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000006', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-05 09:48:11,446 - INFO - [2_table_aggregator.py] 行 4: ('2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '运行状态', None, '2#串焊机04状态', '2#串焊机04', 'EE-019-ZJ-61-224-0003#SN0001-RS', '1149', '2#串焊机04（JAEEDS2020090）', '164', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-224-0003', '通过', '运行状态', '信号类', '状态信号', '焊接机', '焊接机', '1', '2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-05 09:48:11,446 - INFO - [2_table_aggregator.py] 行 5: ('1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '产量', None, '1#二道胶膜裁切机产量', '1#二道胶膜裁切机02', 'EE-019-ZJ-61-228-0001#YE0001-FV', '1115', '1#二道胶膜裁切机02（JAEEDS2020026）', '155', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-228-0001', '通过', '反馈值', '统计类', '产量', '裁切机', '裁切机', '1', '1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'EE-EMS-YE-E-NS-NS-000000016', '能源管理', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-05 09:48:11,446 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:11,487 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_5_曲靖
2025-09-05 09:48:11,529 - INFO - [2_table_aggregator.py] 表 1_汇总表_5_曲靖 创建成功
2025-09-05 09:48:11,530 - INFO - [2_table_aggregator.py] 正在为基地 曲靖 执行数据聚合...
2025-09-05 09:48:11,531 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:11,540 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_5_曲靖' 行数: 14880
2025-09-05 09:48:11,560 - INFO - [2_table_aggregator.py] a表 'a采集点表_5_曲靖' 行数: 82370
2025-09-05 09:48:11,570 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_5_曲靖' 行数: 8315
2025-09-05 09:48:11,571 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:11,571 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:11,571 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:11,585 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('曲靖基地', '三厂（三期）-电池一期车间（101）'), ('曲靖基地', '二厂（二期）-201拉晶车间'), ('曲靖基地', '二厂（二期）-201加工车间'), ('曲靖基地', '三厂（三期）-组件一期车间（104）'), ('曲靖基地', '二厂（二期）-202拉晶车间')]
2025-09-05 09:48:11,596 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:11,597 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:11,608 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:12,329 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_5_曲靖
2025-09-05 09:48:12,329 - INFO - [2_table_aggregator.py] 原始表c的行数: 14880
2025-09-05 09:48:12,330 - INFO - [2_table_aggregator.py] 汇总表的行数: 14887
2025-09-05 09:48:12,330 - INFO - [2_table_aggregator.py] 警告: 行数不一致! 可能丢失了 -7 行数据
2025-09-05 09:48:12,330 - INFO - [2_table_aggregator.py] 建议检查连接条件和数据完整性
2025-09-05 09:48:12,330 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-05 09:48:12,330 - INFO - [2_table_aggregator.py] 行 1: ('西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '运行状态', None, '西区POLY尾气处理B19#运行状态', '西区POLY尾气处理B19', 'QJ-028-DC-56-199-0039#SN0001-RS', '1070', '西区POLY尾气处理B19（QJJAKJ12021493）', '145', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0039', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-05 09:48:12,330 - INFO - [2_table_aggregator.py] 行 2: ('西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '运行状态', None, '西区ALD尾气处理B01#运行状态', '西区ALD尾气处理B01', 'QJ-028-DC-56-199-0044#SN0001-RS', '1110', '西区ALD尾气处理B01（QJJAKJ12021632）', '151', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0044', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-05 09:48:12,330 - INFO - [2_table_aggregator.py] 行 3: ('西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '运行状态', None, '西区ALD尾气处理B02#运行状态', '西区ALD尾气处理B02', 'QJ-028-DC-56-199-0045#SN0001-RS', '1118', '西区ALD尾气处理B02（QJJAKJ12021633）', '152', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0045', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-05 09:48:12,330 - INFO - [2_table_aggregator.py] 行 4: ('西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '运行状态', None, '西区ALD尾气处理B03#运行状态', '西区ALD尾气处理B03', 'QJ-028-DC-56-199-0046#SN0001-RS', '1126', '西区ALD尾气处理B03（QJJAKJ120216334）', '153', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0046', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-05 09:48:12,335 - INFO - [2_table_aggregator.py] 行 5: ('西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '运行状态', None, '西区ALD尾气处理B04#运行状态', '西区ALD尾气处理B04', 'QJ-028-DC-56-199-0001#SN0001-RS', '8', '西区ALD尾气处理B04（QJJAKJ120216335）', '5', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0001', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000009', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-05 09:48:12,335 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:12,337 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_6_奉贤
2025-09-05 09:48:12,348 - INFO - [2_table_aggregator.py] 表 1_汇总表_6_奉贤 创建成功
2025-09-05 09:48:12,350 - INFO - [2_table_aggregator.py] 正在为基地 奉贤 执行数据聚合...
2025-09-05 09:48:12,351 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:12,353 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_6_奉贤' 行数: 648
2025-09-05 09:48:12,366 - INFO - [2_table_aggregator.py] a表 'a采集点表_6_奉贤' 行数: 6140
2025-09-05 09:48:12,368 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_6_奉贤' 行数: 513
2025-09-05 09:48:12,369 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:12,370 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:12,370 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:12,373 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('奉贤基地', '一厂-B2组件车间（北区）'), ('奉贤基地', '一厂-B1储能车间'), ('奉贤基地', '厂外-C2接线盒车间'), ('奉贤基地', 'E2动力站'), ('奉贤基地', '35KV变电站')]
2025-09-05 09:48:12,378 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:12,378 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:12,390 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:12,435 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_6_奉贤
2025-09-05 09:48:12,435 - INFO - [2_table_aggregator.py] 原始表c的行数: 648
2025-09-05 09:48:12,435 - INFO - [2_table_aggregator.py] 汇总表的行数: 648
2025-09-05 09:48:12,435 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-05 09:48:12,435 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-05 09:48:12,435 - INFO - [2_table_aggregator.py] 行 1: ('自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '运行状态', None, '装工装_201_PLC#运行状态', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#SN0001-RS', '162', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '通过', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-05 09:48:12,435 - INFO - [2_table_aggregator.py] 行 2: ('自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '耗电', '7', '装工装_201_PLC#总有功电度', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#AE0004-FV', '165', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-05 09:48:12,435 - INFO - [2_table_aggregator.py] 行 3: ('在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '运行状态', None, '裁切机_501_PLC#运行状态', '裁切机_501_PLC', 'FX-002-ZJ-61-228-0001#SN0001-RS', '153', '在线裁切机一道-FX02CQ0501', '29', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-61-228-0001', '通过', '运行状态', '信号类', '状态信号', '一道EVA裁切机', '一道EVA裁切机', '1', '在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000079', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '焊接')
2025-09-05 09:48:12,435 - INFO - [2_table_aggregator.py] 行 4: ('自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '运行状态', None, '装工装_301_PLC#运行状态', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#SN0001-RS', '166', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000112', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-05 09:48:12,435 - INFO - [2_table_aggregator.py] 行 5: ('自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '耗电', '7', '装工装_301_PLC#总有功电度', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#AE0004-FV', '169', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000040', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-05 09:48:12,440 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:12,441 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_7_包头
2025-09-05 09:48:12,449 - INFO - [2_table_aggregator.py] 表 1_汇总表_7_包头 创建成功
2025-09-05 09:48:12,449 - INFO - [2_table_aggregator.py] 正在为基地 包头 执行数据聚合...
2025-09-05 09:48:12,450 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:12,453 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_7_包头' 行数: 10009
2025-09-05 09:48:12,471 - INFO - [2_table_aggregator.py] a表 'a采集点表_7_包头' 行数: 59304
2025-09-05 09:48:12,479 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_7_包头' 行数: 4806
2025-09-05 09:48:12,479 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:12,480 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:12,480 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:12,489 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('包头基地', '二厂-拉晶车间'), ('包头基地', '三厂-拉晶车间'), ('包头基地', '二厂-加工车间'), ('包头基地', '三厂-切片车间-配电室'), ('包头基地', '三厂-动力站-配电室')]
2025-09-05 09:48:12,498 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:12,498 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:12,514 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:12,932 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_7_包头
2025-09-05 09:48:12,932 - INFO - [2_table_aggregator.py] 原始表c的行数: 10009
2025-09-05 09:48:12,932 - INFO - [2_table_aggregator.py] 汇总表的行数: 10009
2025-09-05 09:48:12,932 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-05 09:48:12,932 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-05 09:48:12,932 - INFO - [2_table_aggregator.py] 行 1: ('二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-05 09:48:12,932 - INFO - [2_table_aggregator.py] 行 2: ('二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '产量', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-05 09:48:12,932 - INFO - [2_table_aggregator.py] 行 3: ('二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '耗电', '7', '单晶炉#电能', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#AE0003-FV', '9643', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '反馈值', '能耗类', '正向有功电度', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'BT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-05 09:48:12,932 - INFO - [2_table_aggregator.py] 行 4: ('二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '单晶炉_阳光1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-05 09:48:12,932 - INFO - [2_table_aggregator.py] 行 5: ('二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '产量', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '单晶炉_阳光1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-05 09:48:12,936 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:12,940 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_8_义乌
2025-09-05 09:48:12,947 - INFO - [2_table_aggregator.py] 表 1_汇总表_8_义乌 创建成功
2025-09-05 09:48:12,947 - INFO - [2_table_aggregator.py] 正在为基地 义乌 执行数据聚合...
2025-09-05 09:48:12,948 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:12,949 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_8_义乌' 行数: 1467
2025-09-05 09:48:12,959 - INFO - [2_table_aggregator.py] a表 'a采集点表_8_义乌' 行数: 9645
2025-09-05 09:48:12,962 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_8_义乌' 行数: 1363
2025-09-05 09:48:12,962 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:12,963 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:12,964 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:12,973 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('义乌基地', '一厂-组件车间一'), ('义乌基地', '仓库'), ('义乌基地', '动力站-配电室'), ('义乌基地', '一厂-电池车间一'), ('义乌基地', '二厂-电池车间二')]
2025-09-05 09:48:12,978 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:12,978 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:12,994 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:13,281 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_8_义乌
2025-09-05 09:48:13,281 - INFO - [2_table_aggregator.py] 原始表c的行数: 1467
2025-09-05 09:48:13,281 - INFO - [2_table_aggregator.py] 汇总表的行数: 1467
2025-09-05 09:48:13,281 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-05 09:48:13,281 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-05 09:48:13,281 - INFO - [2_table_aggregator.py] 行 1: ('1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '运行状态', None, '1上玻璃102-设备状态', 'KEP-HC', 'YW-003-ZJ-61-256-0010#SN0001-RS', '1', '1上玻璃102', '1', '一厂-组件车间一', '003', 'YW-003-ZJ-61-256-0010', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-05 09:48:13,281 - INFO - [2_table_aggregator.py] 行 2: ('1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '运行状态', None, '1汇流条竖起机141-设备状态', 'KEP-HC', 'YW-003-ZJ-60-211-0002#SN0001-RS', '100', '1汇流条竖起机141', '23', '一厂-组件车间一', '003', 'YW-003-ZJ-60-211-0002', '通过', '运行状态', '信号类', '状态信号', '自动捋引线', '自动捋引线', '1', '1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '装框')
2025-09-05 09:48:13,281 - INFO - [2_table_aggregator.py] 行 3: ('1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '运行状态', None, '1层压机101-02-设备状态', 'KEP-HC', 'YW-003-ZJ-62-230-0021#SN0003-RS', '1001', '1层压机101-02', '158', '一厂-组件车间一', '003', 'YW-003-ZJ-62-230-0021', '通过', '运行状态', '信号类', '状态信号', '层压机', '层压机', '1', '1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '层压')
2025-09-05 09:48:13,281 - INFO - [2_table_aggregator.py] 行 4: ('1排版机092-产量', '0#10_003_22#160#Sum', '产量', None, '1排版机092-设备当班产能', 'KEP-HC', 'YW-003-ZJ-61-227-0015#YE0001-FV', '1004', '1排版机092', '160', '一厂-组件车间一', '003', 'YW-003-ZJ-61-227-0015', '通过', '反馈值', '统计类', '产量', '排版机', '排版机', '1', '1排版机092-产量', '0#10_003_22#160#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'YW-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-05 09:48:13,281 - INFO - [2_table_aggregator.py] 行 5: ('1分档机111-耗电', '7#10_003_22#156#Sum', '耗电', '7', '1分档机111-电量', 'KEP-HC', 'YW-003-ZJ-64-239-0004#AE0005-FV', '1005', '1分档机111', '156', '一厂-组件车间一', '003', 'YW-003-ZJ-64-239-0004', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '1分档机111-耗电', '7#10_003_22#156#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YW-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '包装')
2025-09-05 09:48:13,287 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:13,287 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_9_邢台
2025-09-05 09:48:13,295 - INFO - [2_table_aggregator.py] 表 1_汇总表_9_邢台 创建成功
2025-09-05 09:48:13,295 - INFO - [2_table_aggregator.py] 正在为基地 邢台 执行数据聚合...
2025-09-05 09:48:13,297 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:13,298 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_9_邢台' 行数: 943
2025-09-05 09:48:13,307 - INFO - [2_table_aggregator.py] a表 'a采集点表_9_邢台' 行数: 8176
2025-09-05 09:48:13,309 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_9_邢台' 行数: 488
2025-09-05 09:48:13,309 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:13,310 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:13,310 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:13,319 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('邢台基地', '三厂（三园区）-组件三车间'), ('邢台基地', '二厂（二园区）-组件一车间')]
2025-09-05 09:48:13,322 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:13,322 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:13,334 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:13,396 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_9_邢台
2025-09-05 09:48:13,396 - INFO - [2_table_aggregator.py] 原始表c的行数: 943
2025-09-05 09:48:13,396 - INFO - [2_table_aggregator.py] 汇总表的行数: 943
2025-09-05 09:48:13,396 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-05 09:48:13,396 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-05 09:48:13,396 - INFO - [2_table_aggregator.py] 行 1: ('分档机1FD501-耗电', '7#2_004_22#249#Sum', '耗电', '7', '分档机1FD501#设备当前电能表示数', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#AE0002-FV', '801', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '分档机1FD501-耗电', '7#2_004_22#249#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'XT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '邢台基地', '组件工段', '包装')
2025-09-05 09:48:13,396 - INFO - [2_table_aggregator.py] 行 2: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', None, '分档机1FD501#设备白班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0004-FV', '805', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-05 09:48:13,396 - INFO - [2_table_aggregator.py] 行 3: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', None, '分档机1FD501#设备夜班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0005-FV', '807', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-05 09:48:13,396 - INFO - [2_table_aggregator.py] 行 4: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', None, '裁切机1EC106#设备白班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0002-FV', '249', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-05 09:48:13,396 - INFO - [2_table_aggregator.py] 行 5: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', None, '裁切机1EC106#设备夜班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0003-FV', '250', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-05 09:48:13,396 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:13,403 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_10_宁晋
2025-09-05 09:48:13,410 - INFO - [2_table_aggregator.py] 表 1_汇总表_10_宁晋 创建成功
2025-09-05 09:48:13,411 - INFO - [2_table_aggregator.py] 正在为基地 宁晋 执行数据聚合...
2025-09-05 09:48:13,411 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:13,414 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_10_宁晋' 行数: 1921
2025-09-05 09:48:13,432 - INFO - [2_table_aggregator.py] a表 'a采集点表_10_宁晋' 行数: 25728
2025-09-05 09:48:13,434 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_10_宁晋' 行数: 1223
2025-09-05 09:48:13,434 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:13,435 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:13,435 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:13,453 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('宁晋基地', '宁晋东城-电池车间'), ('宁晋基地', '宁晋东城-电池车间-配电室'), ('宁晋基地', '动力车间'), ('', '宁晋东城-电池车间')]
2025-09-05 09:48:13,458 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:13,459 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:13,471 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:13,603 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_10_宁晋
2025-09-05 09:48:13,603 - INFO - [2_table_aggregator.py] 原始表c的行数: 1921
2025-09-05 09:48:13,603 - INFO - [2_table_aggregator.py] 汇总表的行数: 1921
2025-09-05 09:48:13,603 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-05 09:48:13,604 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-05 09:48:13,604 - INFO - [2_table_aggregator.py] 行 1: ('硼扩工艺机401-耗电', '7#7_001_21#1#Sum', '耗电', '7', '宁晋电池-硼扩工艺机401-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-43-155-0001#AE0008-FV', '8', '硼扩工艺机401', '1', '宁晋东城-电池车间', '001', 'NJ-001-DC-43-155-0001', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩主机', '硼扩主机', '1', '硼扩工艺机401-耗电', '7#7_001_21#1#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '硼扩')
2025-09-05 09:48:13,604 - INFO - [2_table_aggregator.py] 行 2: ('硼扩工艺机410-耗电', '7#7_001_21#10#Sum', '耗电', '7', '宁晋电池-硼扩工艺机410-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-43-155-0010#AE0008-FV', '80', '硼扩工艺机410', '10', '宁晋东城-电池车间', '001', 'NJ-001-DC-43-155-0010', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩主机', '硼扩主机', '1', '硼扩工艺机410-耗电', '7#7_001_21#10#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '硼扩')
2025-09-05 09:48:13,604 - INFO - [2_table_aggregator.py] 行 3: ('背膜工艺机413-耗电', '7#7_001_21#100#Sum', '耗电', '7', '宁晋电池-背膜工艺机413-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0013#AE0008-FV', '800', '背膜工艺机413', '100', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0013', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机413-耗电', '7#7_001_21#100#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-05 09:48:13,604 - INFO - [2_table_aggregator.py] 行 4: ('背膜工艺机414-耗电', '7#7_001_21#101#Sum', '耗电', '7', '宁晋电池-背膜工艺机414-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0014#AE0008-FV', '808', '背膜工艺机414', '101', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0014', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机414-耗电', '7#7_001_21#101#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-05 09:48:13,604 - INFO - [2_table_aggregator.py] 行 5: ('背膜工艺机415-耗电', '7#7_001_21#102#Sum', '耗电', '7', '宁晋电池-背膜工艺机415-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0015#AE0008-FV', '816', '背膜工艺机415', '102', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0015', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机415-耗电', '7#7_001_21#102#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-05 09:48:13,606 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:13,612 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_11_石家庄
2025-09-05 09:48:13,623 - INFO - [2_table_aggregator.py] 表 1_汇总表_11_石家庄 创建成功
2025-09-05 09:48:13,623 - INFO - [2_table_aggregator.py] 正在为基地 石家庄 执行数据聚合...
2025-09-05 09:48:13,624 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:13,626 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_11_石家庄' 行数: 9846
2025-09-05 09:48:13,650 - INFO - [2_table_aggregator.py] a表 'a采集点表_11_石家庄' 行数: 82456
2025-09-05 09:48:13,651 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_11_石家庄' 行数: 3694
2025-09-05 09:48:13,652 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:13,654 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:13,654 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:13,706 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('石家庄基地', '一厂-动力站'), ('石家庄基地', '一厂-电池一期-配电室'), ('石家庄基地', '一厂-切片一期-配电室'), ('石家庄基地', '一厂-电池一期'), ('石家庄基地', '一厂-切片一期')]
2025-09-05 09:48:13,872 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:13,872 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:13,895 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:14,463 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_11_石家庄
2025-09-05 09:48:14,463 - INFO - [2_table_aggregator.py] 原始表c的行数: 9846
2025-09-05 09:48:14,463 - INFO - [2_table_aggregator.py] 汇总表的行数: 9846
2025-09-05 09:48:14,463 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-05 09:48:14,464 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-05 09:48:14,464 - INFO - [2_table_aggregator.py] 行 1: ('重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '耗电', '7', '78AH07#仪表正向有功总', '动力配电室仪表2.4.6.8', 'SJ-003-ZZ-01-JQ-0207#AE0001-FV', '447079', '78AH07', '519381', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0207', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000480', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-05 09:48:14,464 - INFO - [2_table_aggregator.py] 行 2: ('重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '耗电', '7', '71AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0102#AE0001-FV', '446711', '71AH07', '519013', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0102', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000182', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-05 09:48:14,464 - INFO - [2_table_aggregator.py] 行 3: ('重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '耗电', '7', '75AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0138#AE0001-FV', '446807', '75AH07', '519109', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0138', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000236', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-05 09:48:14,464 - INFO - [2_table_aggregator.py] 行 4: ('重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '耗电', '7', '77AH08#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0155#AE0001-FV', '446871', '77AH08', '519173', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0155', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000483', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-05 09:48:14,464 - INFO - [2_table_aggregator.py] 行 5: ('重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '耗电', '7', '71AH06#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0099#AE0001-FV', '446703', '71AH06', '519005', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0099', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000479', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-05 09:48:14,466 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:14,472 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_12_巴彦淖尔
2025-09-05 09:48:14,480 - INFO - [2_table_aggregator.py] 表 1_汇总表_12_巴彦淖尔 创建成功
2025-09-05 09:48:14,481 - INFO - [2_table_aggregator.py] 正在为基地 巴彦淖尔 执行数据聚合...
2025-09-05 09:48:14,483 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-05 09:48:14,484 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_12_巴彦淖尔' 行数: 0
2025-09-05 09:48:14,485 - INFO - [2_table_aggregator.py] a表 'a采集点表_12_巴彦淖尔' 行数: 2119
2025-09-05 09:48:14,486 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_12_巴彦淖尔' 行数: 0
2025-09-05 09:48:14,486 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-05 09:48:14,487 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-05 09:48:14,487 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-05 09:48:14,489 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('巴彦淖尔', '一厂（一期）-5GW组件车间')]
2025-09-05 09:48:14,490 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-05 09:48:14,490 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-05 09:48:14,502 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-05 09:48:14,504 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_12_巴彦淖尔
2025-09-05 09:48:14,504 - INFO - [2_table_aggregator.py] 原始表c的行数: 0
2025-09-05 09:48:14,504 - INFO - [2_table_aggregator.py] 汇总表的行数: 0
2025-09-05 09:48:14,504 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-05 09:48:14,504 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-05 09:48:14,504 - INFO - [2_table_aggregator.py] 所有基地数据聚合完成!
2025-09-05 09:48:14,504 - INFO - [2_table_aggregator.py] 数据库连接已关闭
2025-09-05 09:48:14,552 - INFO - 脚本 2_table_aggregator.py 成功完成 (返回码: 0)
2025-09-05 09:48:14,552 - INFO - 脚本 2_table_aggregator.py 执行完成，继续下一个
2025-09-05 09:48:14,552 - INFO - 正在运行脚本: 3_merge_tables.py
2025-09-05 09:48:14,552 - INFO - 开始运行脚本: D:\JA\database\3_merge_tables.py
2025-09-05 09:48:14,552 - INFO - 工作目录: D:\JA\database
2025-09-05 09:48:15,567 - INFO - [3_merge_tables.py] 开始处理 12 个基地...
2025-09-05 09:48:15,595 - INFO - [3_merge_tables.py] 正在处理: 扬州基地...正在处理: 东台基地...
2025-09-05 09:48:15,595 - INFO - [3_merge_tables.py] 正在处理: 合肥基地...
2025-09-05 09:48:15,596 - INFO - [3_merge_tables.py] 正在处理: 鄂尔多斯基地...
2025-09-05 09:48:15,606 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_3_合肥
2025-09-05 09:48:15,607 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_1_扬州
2025-09-05 09:48:15,607 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_2_东台
2025-09-05 09:48:15,608 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-05 09:48:15,616 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_2_东台
2025-09-05 09:48:15,617 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_3_合肥
2025-09-05 09:48:15,619 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-05 09:48:15,620 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_1_扬州
2025-09-05 09:48:15,833 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-05 09:48:16,034 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:48:16,034 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:48:16,042 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\04鄂尔多斯基地\2_采集点+设备合并表_4_鄂尔多斯_20250905094815.xlsx
2025-09-05 09:48:16,287 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_3_合肥
2025-09-05 09:48:16,961 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_2_东台
2025-09-05 09:48:17,072 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_1_扬州
2025-09-05 09:48:20,376 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:48:20,377 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:48:20,396 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\03合肥基地\2_采集点+设备合并表_3_合肥_20250905094815.xlsx
2025-09-05 09:48:25,474 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_4_鄂尔多斯_20250905094815.xlsx
2025-09-05 09:48:25,474 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:48:31,568 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:48:31,568 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:48:31,604 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\02东台基地\2_采集点+设备合并表_2_东台_20250905094815.xlsx
2025-09-05 09:48:43,801 - INFO - [3_merge_tables.py] 正在处理: 曲靖基地...
2025-09-05 09:48:43,858 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_5_曲靖
2025-09-05 09:48:43,883 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_5_曲靖
2025-09-05 09:48:44,599 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:48:44,599 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:48:44,635 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\01扬州基地\2_采集点+设备合并表_1_扬州_20250905094815.xlsx
2025-09-05 09:48:44,823 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_5_曲靖
2025-09-05 09:48:58,951 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_3_合肥_20250905094815.xlsx
2025-09-05 09:48:58,951 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:49:10,583 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:49:10,583 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:49:10,616 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\05曲靖基地\2_采集点+设备合并表_5_曲靖_20250905094815.xlsx
2025-09-05 09:49:24,571 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_2_东台_20250905094815.xlsx
2025-09-05 09:49:24,571 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:49:25,364 - INFO - [3_merge_tables.py] 正在处理: 奉贤基地...
2025-09-05 09:49:25,439 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_6_奉贤
2025-09-05 09:49:25,449 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_6_奉贤
2025-09-05 09:49:25,563 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_6_奉贤
2025-09-05 09:49:27,892 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:49:27,896 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:49:27,905 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\06奉贤基地\2_采集点+设备合并表_6_奉贤_20250905094815.xlsx
2025-09-05 09:49:34,661 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_6_奉贤_20250905094815.xlsx
2025-09-05 09:49:34,662 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:49:44,095 - INFO - [3_merge_tables.py] 正在处理: 包头基地...
2025-09-05 09:49:44,169 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_7_包头
2025-09-05 09:49:44,180 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_7_包头
2025-09-05 09:49:44,897 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_7_包头
2025-09-05 09:49:48,811 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_1_扬州_20250905094815.xlsx
2025-09-05 09:49:48,811 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:50:08,446 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:50:08,446 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:50:08,489 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\07包头基地\2_采集点+设备合并表_7_包头_20250905094815.xlsx
2025-09-05 09:50:17,757 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_5_曲靖_20250905094815.xlsx
2025-09-05 09:50:17,757 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:50:51,436 - INFO - [3_merge_tables.py] 正在处理: 义乌基地...
2025-09-05 09:50:51,442 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_8_义乌
2025-09-05 09:50:51,449 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_8_义乌
2025-09-05 09:50:51,634 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_8_义乌
2025-09-05 09:50:51,842 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:50:51,842 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:50:51,847 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\08义乌基地\2_采集点+设备合并表_8_义乌_20250905094815.xlsx
2025-09-05 09:50:53,467 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_7_包头_20250905094815.xlsx
2025-09-05 09:50:53,468 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:50:58,020 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_8_义乌_20250905094815.xlsx
2025-09-05 09:50:58,020 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:51:10,561 - INFO - [3_merge_tables.py] 正在处理: 邢台基地...
2025-09-05 09:51:10,644 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_9_邢台
2025-09-05 09:51:10,653 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_9_邢台
2025-09-05 09:51:10,772 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_9_邢台
2025-09-05 09:51:13,521 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:51:13,521 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:51:13,533 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\09邢台基地\2_采集点+设备合并表_9_邢台_20250905094815.xlsx
2025-09-05 09:51:17,048 - INFO - [3_merge_tables.py] 正在处理: 宁晋基地...
2025-09-05 09:51:17,066 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_10_宁晋
2025-09-05 09:51:17,075 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_10_宁晋
2025-09-05 09:51:17,080 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_9_邢台_20250905094815.xlsx
2025-09-05 09:51:17,081 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:51:17,494 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_10_宁晋
2025-09-05 09:51:19,219 - INFO - [3_merge_tables.py] 正在处理: 石家庄基地...
2025-09-05 09:51:19,227 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_11_石家庄
2025-09-05 09:51:19,234 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_11_石家庄
2025-09-05 09:51:19,310 - INFO - [3_merge_tables.py] 正在处理: 巴彦淖尔基地...
2025-09-05 09:51:19,321 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-05 09:51:19,346 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-05 09:51:19,413 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:51:19,413 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:51:19,424 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\10宁晋基地\2_采集点+设备合并表_10_宁晋_20250905094815.xlsx
2025-09-05 09:51:19,544 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-05 09:51:20,374 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_11_石家庄
2025-09-05 09:51:21,592 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:51:21,593 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:51:21,596 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\12巴彦淖尔基地\2_采集点+设备合并表_12_巴彦淖尔_20250905094815.xlsx
2025-09-05 09:51:23,118 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_12_巴彦淖尔_20250905094815.xlsx
2025-09-05 09:51:23,118 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:51:26,476 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_10_宁晋_20250905094815.xlsx
2025-09-05 09:51:26,476 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:51:33,865 - INFO - [3_merge_tables.py] 重命名列
2025-09-05 09:51:33,872 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-05 09:51:33,928 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\11石家庄基地\2_采集点+设备合并表_11_石家庄_20250905094815.xlsx
2025-09-05 09:51:52,888 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_11_石家庄_20250905094815.xlsx
2025-09-05 09:51:52,889 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-05 09:52:17,144 - INFO - [3_merge_tables.py] 所有基地处理完成! 总耗时: 241.58秒
2025-09-05 09:52:17,145 - INFO - [3_merge_tables.py] 开始合并所有基地文件...
2025-09-05 09:52:17,145 - INFO - [3_merge_tables.py] 正在合并: 扬州基地...
2025-09-05 09:52:33,193 - INFO - [3_merge_tables.py] 正在合并: 东台基地...
2025-09-05 09:52:48,253 - INFO - [3_merge_tables.py] 正在合并: 合肥基地...
2025-09-05 09:52:54,446 - INFO - [3_merge_tables.py] 正在合并: 鄂尔多斯基地...
2025-09-05 09:52:56,995 - INFO - [3_merge_tables.py] 正在合并: 曲靖基地...
2025-09-05 09:53:09,262 - INFO - [3_merge_tables.py] 正在合并: 奉贤基地...
2025-09-05 09:53:10,114 - INFO - [3_merge_tables.py] 正在合并: 包头基地...
2025-09-05 09:53:20,080 - INFO - [3_merge_tables.py] 正在合并: 义乌基地...
2025-09-05 09:53:21,372 - INFO - [3_merge_tables.py] 正在合并: 邢台基地...
2025-09-05 09:53:22,474 - INFO - [3_merge_tables.py] 正在合并: 宁晋基地...
2025-09-05 09:53:25,937 - INFO - [3_merge_tables.py] 正在合并: 石家庄基地...
2025-09-05 09:53:39,246 - INFO - [3_merge_tables.py] 正在合并: 巴彦淖尔基地...
2025-09-05 09:55:43,328 - INFO - [3_merge_tables.py] 合并完成! 耗时: 206.18秒
2025-09-05 09:55:43,328 - INFO - [3_merge_tables.py] 正在应用基本格式...
2025-09-05 10:00:10,124 - INFO - [3_merge_tables.py] 合并文件已生成: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】采集点+设备_20250905094815.xlsx
2025-09-05 10:00:10,124 - INFO - [3_merge_tables.py] 程序已正常退出
2025-09-05 10:00:30,619 - INFO - 脚本 3_merge_tables.py 成功完成 (返回码: 0)
2025-09-05 10:00:30,619 - INFO - 脚本 3_merge_tables.py 执行完成，继续下一个
2025-09-05 10:00:30,619 - INFO - 正在运行脚本: 4_merge_calc_tables.py
2025-09-05 10:00:30,619 - INFO - 开始运行脚本: D:\JA\database\4_merge_calc_tables.py
2025-09-05 10:00:30,620 - INFO - 工作目录: D:\JA\database
2025-09-05 10:00:31,447 - INFO - [4_merge_calc_tables.py] 开始导出数据...
2025-09-05 10:00:31,447 - INFO - [4_merge_calc_tables.py] 输出目录: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点
2025-09-05 10:00:33,563 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_1_扬州 已导出到Sheet: 扬州
2025-09-05 10:00:34,519 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_2_东台 已导出到Sheet: 东台
2025-09-05 10:00:34,819 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_3_合肥 已导出到Sheet: 合肥
2025-09-05 10:00:34,885 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_4_鄂尔多斯 已导出到Sheet: 鄂尔多斯
2025-09-05 10:00:37,365 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_5_曲靖 已导出到Sheet: 曲靖
2025-09-05 10:00:37,455 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_6_奉贤 已导出到Sheet: 奉贤
2025-09-05 10:00:39,038 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_7_包头 已导出到Sheet: 包头
2025-09-05 10:00:39,216 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_8_义乌 已导出到Sheet: 义乌
2025-09-05 10:00:39,338 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_9_邢台 已导出到Sheet: 邢台
2025-09-05 10:00:39,584 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_10_宁晋 已导出到Sheet: 宁晋
2025-09-05 10:00:41,247 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_11_石家庄 已导出到Sheet: 石家庄
2025-09-05 10:00:41,259 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_12_巴彦淖尔 已导出到Sheet: 巴彦淖尔
2025-09-05 10:00:49,983 - INFO - [4_merge_calc_tables.py] 汇总Sheet已创建
2025-09-05 10:01:15,956 - INFO - [4_merge_calc_tables.py] 文件已保存为: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250905100031.xlsx
2025-09-05 10:01:15,989 - INFO - [4_merge_calc_tables.py] 文件验证成功: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250905100031.xlsx
2025-09-05 10:01:15,989 - INFO - [4_merge_calc_tables.py] 文件大小: 24644.50 KB
2025-09-05 10:01:15,989 - INFO - [4_merge_calc_tables.py] 导出完成，耗时: 44.54 秒
2025-09-05 10:01:15,989 - INFO - [4_merge_calc_tables.py] === 导出摘要 ===
2025-09-05 10:01:15,989 - INFO - [4_merge_calc_tables.py] 输出文件: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250905100031.xlsx
2025-09-05 10:01:15,990 - INFO - [4_merge_calc_tables.py] 包含工作表: 汇总 + 12个基地表
2025-09-05 10:01:17,721 - INFO - 脚本 4_merge_calc_tables.py 成功完成 (返回码: 0)
2025-09-05 10:01:17,721 - INFO - 脚本 4_merge_calc_tables.py 执行完成，继续下一个
2025-09-05 10:01:17,721 - INFO - 结束执行时间: 2025-09-05 10:01:17
2025-09-05 10:01:17,721 - INFO - ==================================================
2025-09-08 09:07:49,455 - INFO - ==================================================
2025-09-08 09:07:49,456 - INFO - 开始执行流水线 - 2025-09-08 09:07:49
2025-09-08 09:07:49,456 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-09-08 09:07:49,456 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-09-08 09:07:49,718 - INFO - pymysql版本: 1.4.6
2025-09-08 09:07:49,718 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-09-08 09:07:49,718 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-09-08 09:07:49,718 - INFO - 工作目录: D:\JA\database
2025-09-08 09:07:49,869 - INFO - [1_copy_to_local.py] 开始数据库同步任务: 2025-09-08 09:07:49
2025-09-08 09:07:49,869 - INFO - [1_copy_to_local.py] 开始同步基地: 扬州
2025-09-08 09:07:50,111 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_1_扬州
2025-09-08 09:08:01,610 - INFO - [1_copy_to_local.py] |- 同步完成: 86544 条数据
2025-09-08 09:08:01,610 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_1_扬州
2025-09-08 09:08:02,723 - INFO - [1_copy_to_local.py] |- 同步完成: 8775 条数据
2025-09-08 09:08:02,723 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_1_扬州
2025-09-08 09:08:03,051 - INFO - [1_copy_to_local.py] |- 同步完成: 11933 条数据
2025-09-08 09:08:03,051 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_1_扬州
2025-09-08 09:08:03,141 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-08 09:08:03,142 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_1_扬州
2025-09-08 09:08:03,834 - INFO - [1_copy_to_local.py] |- 同步完成: 8672 条数据
2025-09-08 09:08:03,834 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_1_扬州
2025-09-08 09:08:04,615 - INFO - [1_copy_to_local.py] |- 同步完成: 6076 条数据
2025-09-08 09:08:04,615 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_1_扬州
2025-09-08 09:08:05,141 - INFO - [1_copy_to_local.py] |- 同步完成: 3411 条数据
2025-09-08 09:08:05,152 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 15.28秒
2025-09-08 09:08:05,154 - INFO - [1_copy_to_local.py] 开始同步基地: 东台
2025-09-08 09:08:05,294 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_2_东台
2025-09-08 09:08:15,512 - INFO - [1_copy_to_local.py] |- 同步完成: 77532 条数据
2025-09-08 09:08:15,512 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_2_东台
2025-09-08 09:08:16,204 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-08 09:08:16,205 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_2_东台
2025-09-08 09:08:16,389 - INFO - [1_copy_to_local.py] |- 同步完成: 5767 条数据
2025-09-08 09:08:16,389 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_2_东台
2025-09-08 09:08:16,488 - INFO - [1_copy_to_local.py] |- 同步完成: 12 条数据
2025-09-08 09:08:16,488 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_2_东台
2025-09-08 09:08:17,002 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-08 09:08:17,002 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_2_东台
2025-09-08 09:08:17,504 - INFO - [1_copy_to_local.py] |- 同步完成: 4618 条数据
2025-09-08 09:08:17,504 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_2_东台
2025-09-08 09:08:17,723 - INFO - [1_copy_to_local.py] |- 同步完成: 1921 条数据
2025-09-08 09:08:17,726 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 12.57秒
2025-09-08 09:08:17,727 - INFO - [1_copy_to_local.py] 开始同步基地: 合肥
2025-09-08 09:08:25,912 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_3_合肥
2025-09-08 09:08:28,201 - INFO - [1_copy_to_local.py] |- 同步完成: 41670 条数据
2025-09-08 09:08:28,201 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_3_合肥
2025-09-08 09:08:28,569 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-08 09:08:28,569 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_3_合肥
2025-09-08 09:08:28,683 - INFO - [1_copy_to_local.py] |- 同步完成: 2417 条数据
2025-09-08 09:08:28,684 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_3_合肥
2025-09-08 09:08:28,759 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-08 09:08:28,759 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_3_合肥
2025-09-08 09:08:28,902 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-08 09:08:28,902 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_3_合肥
2025-09-08 09:08:29,062 - INFO - [1_copy_to_local.py] |- 同步完成: 2023 条数据
2025-09-08 09:08:29,062 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_3_合肥
2025-09-08 09:08:29,182 - INFO - [1_copy_to_local.py] |- 同步完成: 855 条数据
2025-09-08 09:08:29,183 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 11.46秒
2025-09-08 09:08:29,184 - INFO - [1_copy_to_local.py] 开始同步基地: 鄂尔多斯
2025-09-08 09:08:37,332 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_4_鄂尔多斯
2025-09-08 09:08:38,752 - INFO - [1_copy_to_local.py] |- 同步完成: 14404 条数据
2025-09-08 09:08:38,752 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_4_鄂尔多斯
2025-09-08 09:08:38,894 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-08 09:08:38,894 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_4_鄂尔多斯
2025-09-08 09:08:38,977 - INFO - [1_copy_to_local.py] |- 同步完成: 484 条数据
2025-09-08 09:08:38,977 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_4_鄂尔多斯
2025-09-08 09:08:39,060 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-08 09:08:39,060 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_4_鄂尔多斯
2025-09-08 09:08:39,167 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-08 09:08:39,167 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_4_鄂尔多斯
2025-09-08 09:08:39,334 - INFO - [1_copy_to_local.py] |- 同步完成: 794 条数据
2025-09-08 09:08:39,334 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_4_鄂尔多斯
2025-09-08 09:08:39,427 - INFO - [1_copy_to_local.py] |- 同步完成: 152 条数据
2025-09-08 09:08:39,428 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 10.24秒
2025-09-08 09:08:39,428 - INFO - [1_copy_to_local.py] 开始同步基地: 曲靖
2025-09-08 09:08:39,699 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_5_曲靖
2025-09-08 09:08:43,635 - INFO - [1_copy_to_local.py] |- 同步完成: 71297 条数据
2025-09-08 09:08:43,635 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_5_曲靖
2025-09-08 09:08:46,090 - INFO - [1_copy_to_local.py] |- 同步完成: 8527 条数据
2025-09-08 09:08:46,090 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_5_曲靖
2025-09-08 09:08:46,727 - INFO - [1_copy_to_local.py] |- 同步完成: 15092 条数据
2025-09-08 09:08:46,727 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_5_曲靖
2025-09-08 09:08:46,864 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-08 09:08:46,864 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_5_曲靖
2025-09-08 09:08:47,316 - INFO - [1_copy_to_local.py] |- 同步完成: 8528 条数据
2025-09-08 09:08:47,316 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_5_曲靖
2025-09-08 09:08:48,181 - INFO - [1_copy_to_local.py] |- 同步完成: 13973 条数据
2025-09-08 09:08:48,182 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_5_曲靖
2025-09-08 09:08:48,503 - INFO - [1_copy_to_local.py] |- 同步完成: 2491 条数据
2025-09-08 09:08:48,513 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 9.09秒
2025-09-08 09:08:48,514 - INFO - [1_copy_to_local.py] 开始同步基地: 奉贤
2025-09-08 09:08:48,705 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_6_奉贤
2025-09-08 09:08:49,323 - INFO - [1_copy_to_local.py] |- 同步完成: 6140 条数据
2025-09-08 09:08:49,324 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_6_奉贤
2025-09-08 09:08:49,467 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-09-08 09:08:49,468 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_6_奉贤
2025-09-08 09:08:49,605 - INFO - [1_copy_to_local.py] |- 同步完成: 648 条数据
2025-09-08 09:08:49,605 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_6_奉贤
2025-09-08 09:08:49,699 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-08 09:08:49,699 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_6_奉贤
2025-09-08 09:08:49,825 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-09-08 09:08:49,825 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_6_奉贤
2025-09-08 09:08:49,937 - INFO - [1_copy_to_local.py] |- 同步完成: 667 条数据
2025-09-08 09:08:49,937 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_6_奉贤
2025-09-08 09:08:50,050 - INFO - [1_copy_to_local.py] |- 同步完成: 280 条数据
2025-09-08 09:08:50,051 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.54秒
2025-09-08 09:08:50,053 - INFO - [1_copy_to_local.py] 开始同步基地: 包头
2025-09-08 09:08:50,174 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_7_包头
2025-09-08 09:08:52,867 - INFO - [1_copy_to_local.py] |- 同步完成: 59305 条数据
2025-09-08 09:08:52,867 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_7_包头
2025-09-08 09:08:53,320 - INFO - [1_copy_to_local.py] |- 同步完成: 4806 条数据
2025-09-08 09:08:53,320 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_7_包头
2025-09-08 09:08:53,531 - INFO - [1_copy_to_local.py] |- 同步完成: 10009 条数据
2025-09-08 09:08:53,531 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_7_包头
2025-09-08 09:08:53,596 - INFO - [1_copy_to_local.py] |- 同步完成: 10 条数据
2025-09-08 09:08:53,596 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_7_包头
2025-09-08 09:08:53,819 - INFO - [1_copy_to_local.py] |- 同步完成: 4805 条数据
2025-09-08 09:08:53,819 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_7_包头
2025-09-08 09:08:54,076 - INFO - [1_copy_to_local.py] |- 同步完成: 5574 条数据
2025-09-08 09:08:54,076 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_7_包头
2025-09-08 09:08:54,248 - INFO - [1_copy_to_local.py] |- 同步完成: 2019 条数据
2025-09-08 09:08:54,253 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 4.20秒
2025-09-08 09:08:54,254 - INFO - [1_copy_to_local.py] 开始同步基地: 义乌
2025-09-08 09:08:54,465 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_8_义乌
2025-09-08 09:08:55,345 - INFO - [1_copy_to_local.py] |- 同步完成: 9645 条数据
2025-09-08 09:08:55,345 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_8_义乌
2025-09-08 09:08:55,592 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-08 09:08:55,592 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_8_义乌
2025-09-08 09:08:55,706 - INFO - [1_copy_to_local.py] |- 同步完成: 1467 条数据
2025-09-08 09:08:55,706 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_8_义乌
2025-09-08 09:08:55,806 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-08 09:08:55,807 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_8_义乌
2025-09-08 09:08:55,953 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-08 09:08:55,953 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_8_义乌
2025-09-08 09:08:56,192 - INFO - [1_copy_to_local.py] |- 同步完成: 2776 条数据
2025-09-08 09:08:56,192 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_8_义乌
2025-09-08 09:08:56,294 - INFO - [1_copy_to_local.py] |- 同步完成: 4 条数据
2025-09-08 09:08:56,295 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 2.04秒
2025-09-08 09:08:56,295 - INFO - [1_copy_to_local.py] 开始同步基地: 邢台
2025-09-08 09:08:56,446 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_9_邢台
2025-09-08 09:08:57,117 - INFO - [1_copy_to_local.py] |- 同步完成: 8176 条数据
2025-09-08 09:08:57,117 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_9_邢台
2025-09-08 09:08:57,297 - INFO - [1_copy_to_local.py] |- 同步完成: 488 条数据
2025-09-08 09:08:57,297 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_9_邢台
2025-09-08 09:08:57,378 - INFO - [1_copy_to_local.py] |- 同步完成: 943 条数据
2025-09-08 09:08:57,379 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_9_邢台
2025-09-08 09:08:57,450 - INFO - [1_copy_to_local.py] |- 同步完成: 5 条数据
2025-09-08 09:08:57,450 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_9_邢台
2025-09-08 09:08:57,535 - INFO - [1_copy_to_local.py] |- 同步完成: 488 条数据
2025-09-08 09:08:57,535 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_9_邢台
2025-09-08 09:08:57,639 - INFO - [1_copy_to_local.py] |- 同步完成: 814 条数据
2025-09-08 09:08:57,639 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_9_邢台
2025-09-08 09:08:57,734 - INFO - [1_copy_to_local.py] |- 同步完成: 300 条数据
2025-09-08 09:08:57,734 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.44秒
2025-09-08 09:08:57,734 - INFO - [1_copy_to_local.py] 开始同步基地: 宁晋
2025-09-08 09:08:57,836 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_10_宁晋
2025-09-08 09:08:59,483 - INFO - [1_copy_to_local.py] |- 同步完成: 25728 条数据
2025-09-08 09:08:59,483 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_10_宁晋
2025-09-08 09:08:59,698 - INFO - [1_copy_to_local.py] |- 同步完成: 1385 条数据
2025-09-08 09:08:59,698 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_10_宁晋
2025-09-08 09:08:59,795 - INFO - [1_copy_to_local.py] |- 同步完成: 2083 条数据
2025-09-08 09:08:59,796 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_10_宁晋
2025-09-08 09:08:59,942 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-08 09:08:59,942 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_10_宁晋
2025-09-08 09:09:00,054 - INFO - [1_copy_to_local.py] |- 同步完成: 1385 条数据
2025-09-08 09:09:00,054 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_10_宁晋
2025-09-08 09:09:00,149 - INFO - [1_copy_to_local.py] |- 同步完成: 850 条数据
2025-09-08 09:09:00,149 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_10_宁晋
2025-09-08 09:09:00,276 - INFO - [1_copy_to_local.py] |- 同步完成: 377 条数据
2025-09-08 09:09:00,278 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 2.54秒
2025-09-08 09:09:00,278 - INFO - [1_copy_to_local.py] 开始同步基地: 石家庄
2025-09-08 09:09:00,391 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_11_石家庄
2025-09-08 09:09:07,827 - INFO - [1_copy_to_local.py] |- 同步完成: 82456 条数据
2025-09-08 09:09:07,827 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_11_石家庄
2025-09-08 09:09:08,406 - INFO - [1_copy_to_local.py] |- 同步完成: 3714 条数据
2025-09-08 09:09:08,406 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_11_石家庄
2025-09-08 09:09:08,598 - INFO - [1_copy_to_local.py] |- 同步完成: 9978 条数据
2025-09-08 09:09:08,598 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_11_石家庄
2025-09-08 09:09:08,655 - INFO - [1_copy_to_local.py] |- 同步完成: 16 条数据
2025-09-08 09:09:08,655 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_11_石家庄
2025-09-08 09:09:08,946 - INFO - [1_copy_to_local.py] |- 同步完成: 3714 条数据
2025-09-08 09:09:08,946 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_11_石家庄
2025-09-08 09:09:09,370 - INFO - [1_copy_to_local.py] |- 同步完成: 6433 条数据
2025-09-08 09:09:09,370 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_11_石家庄
2025-09-08 09:09:09,526 - INFO - [1_copy_to_local.py] |- 同步完成: 1208 条数据
2025-09-08 09:09:09,528 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 9.25秒
2025-09-08 09:09:09,529 - INFO - [1_copy_to_local.py] 开始同步基地: 巴彦淖尔
2025-09-08 09:09:09,689 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_12_巴彦淖尔
2025-09-08 09:09:10,093 - INFO - [1_copy_to_local.py] |- 同步完成: 2119 条数据
2025-09-08 09:09:10,093 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_12_巴彦淖尔
2025-09-08 09:09:10,264 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-08 09:09:10,265 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_12_巴彦淖尔
2025-09-08 09:09:10,331 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-08 09:09:10,331 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_12_巴彦淖尔
2025-09-08 09:09:10,399 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-08 09:09:10,399 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_12_巴彦淖尔
2025-09-08 09:09:10,471 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-08 09:09:10,471 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_12_巴彦淖尔
2025-09-08 09:09:10,561 - INFO - [1_copy_to_local.py] |- 同步完成: 158 条数据
2025-09-08 09:09:10,561 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_12_巴彦淖尔
2025-09-08 09:09:10,655 - INFO - [1_copy_to_local.py] |- 同步完成: 157 条数据
2025-09-08 09:09:10,656 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.13秒
2025-09-08 09:09:10,657 - INFO - [1_copy_to_local.py] 所有同步任务完成: 2025-09-08 09:09:10
2025-09-08 09:09:10,674 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-09-08 09:09:10,674 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-09-08 09:09:10,674 - INFO - 正在运行脚本: 1_copy_ems_to_local.py
2025-09-08 09:09:10,674 - INFO - 开始运行脚本: D:\JA\database\1_copy_ems_to_local.py
2025-09-08 09:09:10,674 - INFO - 工作目录: D:\JA\database
2025-09-08 09:09:10,854 - INFO - [1_copy_ems_to_local.py] 连接源数据库: 172.25.4.87:5432/ems_test
2025-09-08 09:09:11,143 - INFO - [1_copy_ems_to_local.py] 连接目标数据库: localhost:3306/mzr_db
2025-09-08 09:09:11,151 - INFO - [1_copy_ems_to_local.py] 开始迁移表: from_demo.dim_base -> x【字典】基地编码
2025-09-08 09:09:11,442 - INFO - [1_copy_ems_to_local.py] 表 x【字典】基地编码 创建成功
2025-09-08 09:09:11,498 - INFO - [1_copy_ems_to_local.py] 插入 12 行到 x【字典】基地编码
2025-09-08 09:09:11,500 - INFO - [1_copy_ems_to_local.py] 共插入 12 行到 x【字典】基地编码
2025-09-08 09:09:11,500 - INFO - [1_copy_ems_to_local.py] 表 from_demo.dim_base -> x【字典】基地编码 迁移完成
2025-09-08 09:09:11,500 - INFO - [1_copy_ems_to_local.py] 开始迁移表: from_demo.dim_system_type -> w【字典】系统编码
2025-09-08 09:09:11,576 - INFO - [1_copy_ems_to_local.py] 表 w【字典】系统编码 创建成功
2025-09-08 09:09:11,636 - INFO - [1_copy_ems_to_local.py] 插入 26 行到 w【字典】系统编码
2025-09-08 09:09:11,638 - INFO - [1_copy_ems_to_local.py] 共插入 26 行到 w【字典】系统编码
2025-09-08 09:09:11,638 - INFO - [1_copy_ems_to_local.py] 表 from_demo.dim_system_type -> w【字典】系统编码 迁移完成
2025-09-08 09:09:11,639 - INFO - [1_copy_ems_to_local.py] PostgreSQL连接已关闭
2025-09-08 09:09:11,639 - INFO - [1_copy_ems_to_local.py] MySQL连接已关闭
2025-09-08 09:09:11,639 - INFO - [1_copy_ems_to_local.py] 数据库连接已关闭
2025-09-08 09:09:11,656 - INFO - 脚本 1_copy_ems_to_local.py 成功完成 (返回码: 0)
2025-09-08 09:09:11,656 - INFO - 脚本 1_copy_ems_to_local.py 执行完成，继续下一个
2025-09-08 09:09:11,656 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-09-08 09:09:11,656 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-09-08 09:09:11,656 - INFO - 工作目录: D:\JA\database
2025-09-08 09:09:11,904 - INFO - [2_table_aggregator.py] 开始数据聚合流程...
2025-09-08 09:09:11,904 - INFO - [2_table_aggregator.py] 加载配置文件: 2_table_aggregator_config.json
2025-09-08 09:09:12,082 - INFO - [2_table_aggregator.py] 数据库连接成功
2025-09-08 09:09:12,095 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_1_扬州
2025-09-08 09:09:12,103 - INFO - [2_table_aggregator.py] 表 1_汇总表_1_扬州 创建成功
2025-09-08 09:09:12,104 - INFO - [2_table_aggregator.py] 正在为基地 扬州 执行数据聚合...
2025-09-08 09:09:12,120 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:12,131 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_1_扬州' 行数: 11933
2025-09-08 09:09:12,155 - INFO - [2_table_aggregator.py] a表 'a采集点表_1_扬州' 行数: 86544
2025-09-08 09:09:12,165 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_1_扬州' 行数: 8775
2025-09-08 09:09:12,167 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:12,169 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:12,170 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:12,252 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('扬州基地', '一厂（晶运园区）-F3电池车间'), ('扬州基地', '一厂（晶运园区）-F2电池车间'), ('扬州基地', '一厂（晶运园区）-动力站F3'), ('扬州基地', '二厂（晶山园区）-晶山组件（M3）'), ('扬州基地', '一厂（晶运园区）-动力站-配电室')]
2025-09-08 09:09:12,508 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:12,508 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:12,522 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:13,225 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_1_扬州
2025-09-08 09:09:13,225 - INFO - [2_table_aggregator.py] 原始表c的行数: 11933
2025-09-08 09:09:13,225 - INFO - [2_table_aggregator.py] 汇总表的行数: 11933
2025-09-08 09:09:13,225 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 09:09:13,225 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 09:09:13,225 - INFO - [2_table_aggregator.py] 行 1: ('LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '耗电', '7', '电池车间LPCVD自动化312#电能', '电池车间LPCVD自动化312', 'YZ-002-DC-58-206-0037#AE0005-FV', '85262', 'LPCVD自动化312（JAYZ2438173）', '90002', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-58-206-0037', '通过', '反馈值', '能耗类', '正向有功电度', 'LPCVD自动化', 'LPCVD自动化', '1', 'LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000250', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', 'LPCVD')
2025-09-08 09:09:13,225 - INFO - [2_table_aggregator.py] 行 2: ('硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '耗电', '7', '电池车间硼扩自动化317#电能', '电池车间硼扩自动化317', 'YZ-002-DC-43-156-0039#AE0005-FV', '85636', '硼扩自动化317（JAYZ23C7297）', '89886', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-43-156-0039', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩自动化', '硼扩自动化', '1', '硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000134', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', '硼扩')
2025-09-08 09:09:13,225 - INFO - [2_table_aggregator.py] 行 3: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-08 09:09:13,225 - INFO - [2_table_aggregator.py] 行 4: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-08 09:09:13,225 - INFO - [2_table_aggregator.py] 行 5: ('背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '运行状态', None, '电池车间背膜主机307#炉管5#设备运行状态', '电池车间背膜主机307', 'YZ-002-DC-53-175-0040#SN0005-RS', '90931', '背膜主机307（JAYZ2417811）', '90116', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-53-175-0040', '通过', '运行状态', '信号类', '状态信号', '背膜主机', '背膜主机', '1', '背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000358', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '背膜')
2025-09-08 09:09:13,232 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:13,233 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_2_东台
2025-09-08 09:09:13,240 - INFO - [2_table_aggregator.py] 表 1_汇总表_2_东台 创建成功
2025-09-08 09:09:13,240 - INFO - [2_table_aggregator.py] 正在为基地 东台 执行数据聚合...
2025-09-08 09:09:13,242 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:13,245 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_2_东台' 行数: 5767
2025-09-08 09:09:13,266 - INFO - [2_table_aggregator.py] a表 'a采集点表_2_东台' 行数: 77532
2025-09-08 09:09:13,273 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_2_东台' 行数: 5131
2025-09-08 09:09:13,274 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:13,275 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:13,275 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:13,310 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('东台基地', '一厂-电池车间1'), ('东台基地', '一厂-组件车间1'), ('东台基地', '一厂动力站'), ('东台基地', '一厂办公区'), ('东台基地', '其他区域')]
2025-09-08 09:09:13,324 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:13,324 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:13,336 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:13,736 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_2_东台
2025-09-08 09:09:13,736 - INFO - [2_table_aggregator.py] 原始表c的行数: 5767
2025-09-08 09:09:13,736 - INFO - [2_table_aggregator.py] 汇总表的行数: 5767
2025-09-08 09:09:13,736 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 09:09:13,737 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 09:09:13,737 - INFO - [2_table_aggregator.py] 行 1: ('BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '产量', None, 'BSG上料2号机#产量下料', 'BSG上料2号机', 'DT-001-DC-45-160-0002#YE0004-FV', '384554', 'BSG下料-BSGX1002', '512016', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0002', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-08 09:09:13,737 - INFO - [2_table_aggregator.py] 行 2: ('BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '产量', None, 'BSG上料4号机#产量下料', 'BSG上料4号机', 'DT-001-DC-45-160-0003#YE0004-FV', '384544', 'BSG下料-BSGX1004', '512018', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0003', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-08 09:09:13,737 - INFO - [2_table_aggregator.py] 行 3: ('BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '产量', None, 'BSG上料6号机#产量下料', 'BSG上料6号机', 'DT-001-DC-45-160-0004#YE0004-FV', '384586', 'BSG下料-BSGX1006', '512019', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0004', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-08 09:09:13,737 - INFO - [2_table_aggregator.py] 行 4: ('BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '产量', None, 'BSG上料8号机#产量下料', 'BSG上料8号机', 'DT-001-DC-45-160-0006#YE0004-FV', '384562', 'BSG下料-BSGX1008', '512022', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0006', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-08 09:09:13,737 - INFO - [2_table_aggregator.py] 行 5: ('BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '产量', None, 'BSG上料12号机#产量下料', 'BSG上料12号机', 'DT-001-DC-45-160-0008#YE0004-FV', '384488', 'BSG下料-BSGX1012', '512025', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0008', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-08 09:09:13,737 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:13,748 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_3_合肥
2025-09-08 09:09:13,760 - INFO - [2_table_aggregator.py] 表 1_汇总表_3_合肥 创建成功
2025-09-08 09:09:13,761 - INFO - [2_table_aggregator.py] 正在为基地 合肥 执行数据聚合...
2025-09-08 09:09:13,762 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:13,768 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_3_合肥' 行数: 2417
2025-09-08 09:09:13,792 - INFO - [2_table_aggregator.py] a表 'a采集点表_3_合肥' 行数: 41670
2025-09-08 09:09:13,797 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_3_合肥' 行数: 1890
2025-09-08 09:09:13,798 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:13,799 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:13,799 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:13,809 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('合肥基地', '二厂（二部）-六车间（201#智慧工厂）'), ('合肥基地', '一厂（一部）-二车间（116#创新工厂）'), ('合肥基地', '207动力站'), ('合肥基地', '207动力站-配电室'), ('合肥基地', '一厂（一部）-四车间（110#领跑工厂）-配电室')]
2025-09-08 09:09:13,819 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:13,820 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:13,837 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:14,066 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_3_合肥
2025-09-08 09:09:14,066 - INFO - [2_table_aggregator.py] 原始表c的行数: 2417
2025-09-08 09:09:14,066 - INFO - [2_table_aggregator.py] 汇总表的行数: 2417
2025-09-08 09:09:14,066 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 09:09:14,066 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 09:09:14,066 - INFO - [2_table_aggregator.py] 行 1: ('二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '耗电', '7', '智慧工厂一-6BL15002-总有功电度', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#AE0003-FV', '10', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000048', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-08 09:09:14,066 - INFO - [2_table_aggregator.py] 行 2: ('二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '产量', None, '智慧工厂一-6BL15002-产量', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#YE0005-FV', '12', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '统计类', '产量', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000049', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-08 09:09:14,067 - INFO - [2_table_aggregator.py] 行 3: ('二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '运行状态', None, '智慧工厂一-6BL15002运行状态', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#SN0002-RS', '9', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'HF-EMC-RS-E-NS-NS-000000049', '设备管控', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-08 09:09:14,067 - INFO - [2_table_aggregator.py] 行 4: ('二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '耗电', '7', '智慧工厂一-6CQ13002-总有功电度', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#AE0001-FV', '759', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000078', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-08 09:09:14,067 - INFO - [2_table_aggregator.py] 行 5: ('二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '产量', None, '智慧工厂一-6CQ13002-产量', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#YE0002-FV', '760', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '统计类', '产量', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000079', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-08 09:09:14,073 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:14,074 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_4_鄂尔多斯
2025-09-08 09:09:14,085 - INFO - [2_table_aggregator.py] 表 1_汇总表_4_鄂尔多斯 创建成功
2025-09-08 09:09:14,085 - INFO - [2_table_aggregator.py] 正在为基地 鄂尔多斯 执行数据聚合...
2025-09-08 09:09:14,088 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:14,089 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_4_鄂尔多斯' 行数: 484
2025-09-08 09:09:14,102 - INFO - [2_table_aggregator.py] a表 'a采集点表_4_鄂尔多斯' 行数: 14404
2025-09-08 09:09:14,104 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_4_鄂尔多斯' 行数: 310
2025-09-08 09:09:14,104 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:14,105 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:14,105 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:14,117 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('鄂尔多斯', '二厂（B区）-B4-5GW组件车间2'), ('', '二厂（B区）-B4-5GW组件车间2')]
2025-09-08 09:09:14,121 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:14,121 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:14,137 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:14,191 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_4_鄂尔多斯
2025-09-08 09:09:14,191 - INFO - [2_table_aggregator.py] 原始表c的行数: 484
2025-09-08 09:09:14,191 - INFO - [2_table_aggregator.py] 汇总表的行数: 484
2025-09-08 09:09:14,191 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 09:09:14,192 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 09:09:14,192 - INFO - [2_table_aggregator.py] 行 1: ('2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '运行状态', None, '2#串焊机01状态', '2#串焊机01', 'null-019-ZJ-61-224-0002#SN0003-RS', '1143', '2#串焊机01（JAEEDS2020087）', '162', '二厂（B区）-B4-5GW组件车间2', None, 'null-019-ZJ-61-224-0002', '通过', '运行状态', '信号类', '状态信号', '串焊机', '串焊机', '1', '2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000004', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-08 09:09:14,192 - INFO - [2_table_aggregator.py] 行 2: ('2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '运行状态', None, '2#串焊机02状态', '2#串焊机02', 'null-019-ZJ-61-224-0001#SN0005-RS', '1132', '2#串焊机02（JAEEDS2020088）', '160', '二厂（B区）-B4-5GW组件车间2', None, 'null-019-ZJ-61-224-0001', '通过', '运行状态', '信号类', '状态信号', '串焊机', '串焊机', '1', '2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-08 09:09:14,192 - INFO - [2_table_aggregator.py] 行 3: ('2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '运行状态', None, '2#串焊机03状态', '2#串焊机03', 'null-019-ZJ-61-224-0004#SN0004-RS', '1161', '2#串焊机03（JAEEDS2020089）', '167', '二厂（B区）-B4-5GW组件车间2', None, 'null-019-ZJ-61-224-0004', '通过', '运行状态', '信号类', '状态信号', '串焊机', '串焊机', '1', '2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000006', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-08 09:09:14,192 - INFO - [2_table_aggregator.py] 行 4: ('2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '运行状态', None, '2#串焊机04状态', '2#串焊机04', 'null-019-ZJ-61-224-0003#SN0001-RS', '1149', '2#串焊机04（JAEEDS2020090）', '164', '二厂（B区）-B4-5GW组件车间2', None, 'null-019-ZJ-61-224-0003', '通过', '运行状态', '信号类', '状态信号', '串焊机', '串焊机', '1', '2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-08 09:09:14,192 - INFO - [2_table_aggregator.py] 行 5: ('1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '产量', None, '1#二道胶膜裁切机产量', '1#二道胶膜裁切机02', 'EE-019-ZJ-61-228-0001#YE0001-FV', '1115', '1#二道胶膜裁切机02（JAEEDS2020026）', '155', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-228-0001', '通过', '反馈值', '统计类', '产量', '裁切机', '裁切机', '1', '1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'EE-EMS-YE-E-NS-NS-000000016', '能源管理', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-08 09:09:14,198 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:14,198 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_5_曲靖
2025-09-08 09:09:14,206 - INFO - [2_table_aggregator.py] 表 1_汇总表_5_曲靖 创建成功
2025-09-08 09:09:14,206 - INFO - [2_table_aggregator.py] 正在为基地 曲靖 执行数据聚合...
2025-09-08 09:09:14,208 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:14,216 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_5_曲靖' 行数: 15092
2025-09-08 09:09:14,237 - INFO - [2_table_aggregator.py] a表 'a采集点表_5_曲靖' 行数: 71297
2025-09-08 09:09:14,249 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_5_曲靖' 行数: 8527
2025-09-08 09:09:14,250 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:14,251 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:14,251 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:14,268 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('曲靖基地', '三厂（三期）-电池一期车间（101）'), ('曲靖基地', '二厂（二期）-201拉晶车间'), ('曲靖基地', '二厂（二期）-201加工车间'), ('曲靖基地', '三厂（三期）-组件一期车间（104）'), ('曲靖基地', '二厂（二期）-202拉晶车间')]
2025-09-08 09:09:14,282 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:14,282 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:14,295 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:14,939 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_5_曲靖
2025-09-08 09:09:14,940 - INFO - [2_table_aggregator.py] 原始表c的行数: 15092
2025-09-08 09:09:14,940 - INFO - [2_table_aggregator.py] 汇总表的行数: 15099
2025-09-08 09:09:14,940 - INFO - [2_table_aggregator.py] 警告: 行数不一致! 可能丢失了 -7 行数据
2025-09-08 09:09:14,940 - INFO - [2_table_aggregator.py] 建议检查连接条件和数据完整性
2025-09-08 09:09:14,940 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 09:09:14,940 - INFO - [2_table_aggregator.py] 行 1: ('西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '运行状态', None, '西区POLY尾气处理B19#运行状态', '西区POLY尾气处理B19', 'QJ-028-DC-56-199-0039#SN0001-RS', '1070', '西区POLY尾气处理B19（QJJAKJ12021493）', '145', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0039', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-08 09:09:14,940 - INFO - [2_table_aggregator.py] 行 2: ('西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '运行状态', None, '西区ALD尾气处理B01#运行状态', '西区ALD尾气处理B01', 'QJ-028-DC-56-199-0044#SN0001-RS', '1110', '西区ALD尾气处理B01（QJJAKJ12021632）', '151', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0044', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-08 09:09:14,940 - INFO - [2_table_aggregator.py] 行 3: ('西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '运行状态', None, '西区ALD尾气处理B02#运行状态', '西区ALD尾气处理B02', 'QJ-028-DC-56-199-0045#SN0001-RS', '1118', '西区ALD尾气处理B02（QJJAKJ12021633）', '152', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0045', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-08 09:09:14,940 - INFO - [2_table_aggregator.py] 行 4: ('西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '运行状态', None, '西区ALD尾气处理B03#运行状态', '西区ALD尾气处理B03', 'QJ-028-DC-56-199-0046#SN0001-RS', '1126', '西区ALD尾气处理B03（QJJAKJ120216334）', '153', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0046', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-08 09:09:14,948 - INFO - [2_table_aggregator.py] 行 5: ('西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '运行状态', None, '西区ALD尾气处理B04#运行状态', '西区ALD尾气处理B04', 'QJ-028-DC-56-199-0001#SN0001-RS', '8', '西区ALD尾气处理B04（QJJAKJ120216335）', '5', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0001', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000009', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-08 09:09:14,948 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:15,001 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_6_奉贤
2025-09-08 09:09:15,014 - INFO - [2_table_aggregator.py] 表 1_汇总表_6_奉贤 创建成功
2025-09-08 09:09:15,014 - INFO - [2_table_aggregator.py] 正在为基地 奉贤 执行数据聚合...
2025-09-08 09:09:15,017 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:15,018 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_6_奉贤' 行数: 648
2025-09-08 09:09:15,028 - INFO - [2_table_aggregator.py] a表 'a采集点表_6_奉贤' 行数: 6140
2025-09-08 09:09:15,030 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_6_奉贤' 行数: 513
2025-09-08 09:09:15,030 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:15,031 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:15,031 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:15,034 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('奉贤基地', '一厂-B2组件车间（北区）'), ('奉贤基地', '一厂-B1储能车间'), ('奉贤基地', '厂外-C2接线盒车间'), ('奉贤基地', 'E2动力站'), ('奉贤基地', '35KV变电站')]
2025-09-08 09:09:15,037 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:15,037 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:15,049 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:15,096 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_6_奉贤
2025-09-08 09:09:15,097 - INFO - [2_table_aggregator.py] 原始表c的行数: 648
2025-09-08 09:09:15,097 - INFO - [2_table_aggregator.py] 汇总表的行数: 648
2025-09-08 09:09:15,097 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 09:09:15,097 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 09:09:15,097 - INFO - [2_table_aggregator.py] 行 1: ('自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '运行状态', None, '装工装_201_PLC#运行状态', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#SN0001-RS', '162', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '通过', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-08 09:09:15,097 - INFO - [2_table_aggregator.py] 行 2: ('自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '耗电', '7', '装工装_201_PLC#总有功电度', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#AE0004-FV', '165', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-08 09:09:15,097 - INFO - [2_table_aggregator.py] 行 3: ('在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '运行状态', None, '裁切机_501_PLC#运行状态', '裁切机_501_PLC', 'FX-002-ZJ-61-228-0001#SN0001-RS', '153', '在线裁切机一道-FX02CQ0501', '29', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-61-228-0001', '通过', '运行状态', '信号类', '状态信号', '一道EVA裁切机', '一道EVA裁切机', '1', '在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000079', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '焊接')
2025-09-08 09:09:15,097 - INFO - [2_table_aggregator.py] 行 4: ('自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '运行状态', None, '装工装_301_PLC#运行状态', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#SN0001-RS', '166', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000112', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-08 09:09:15,097 - INFO - [2_table_aggregator.py] 行 5: ('自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '耗电', '7', '装工装_301_PLC#总有功电度', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#AE0004-FV', '169', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000040', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-08 09:09:15,104 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:15,105 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_7_包头
2025-09-08 09:09:15,114 - INFO - [2_table_aggregator.py] 表 1_汇总表_7_包头 创建成功
2025-09-08 09:09:15,114 - INFO - [2_table_aggregator.py] 正在为基地 包头 执行数据聚合...
2025-09-08 09:09:15,115 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:15,123 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_7_包头' 行数: 10009
2025-09-08 09:09:15,143 - INFO - [2_table_aggregator.py] a表 'a采集点表_7_包头' 行数: 59305
2025-09-08 09:09:15,150 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_7_包头' 行数: 4806
2025-09-08 09:09:15,152 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:15,153 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:15,153 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:15,163 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('包头基地', '二厂-拉晶车间'), ('包头基地', '三厂-拉晶车间'), ('包头基地', '二厂-加工车间'), ('包头基地', '三厂-切片车间-配电室'), ('包头基地', '三厂-动力站-配电室')]
2025-09-08 09:09:15,175 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:15,176 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:15,195 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:15,597 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_7_包头
2025-09-08 09:09:15,597 - INFO - [2_table_aggregator.py] 原始表c的行数: 10009
2025-09-08 09:09:15,597 - INFO - [2_table_aggregator.py] 汇总表的行数: 10009
2025-09-08 09:09:15,597 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 09:09:15,597 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 09:09:15,597 - INFO - [2_table_aggregator.py] 行 1: ('二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-08 09:09:15,597 - INFO - [2_table_aggregator.py] 行 2: ('二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '产量', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-08 09:09:15,597 - INFO - [2_table_aggregator.py] 行 3: ('二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '耗电', '7', '单晶炉#电能', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#AE0003-FV', '9643', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '反馈值', '能耗类', '正向有功电度', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'BT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-08 09:09:15,597 - INFO - [2_table_aggregator.py] 行 4: ('二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '单晶炉_阳光1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-08 09:09:15,597 - INFO - [2_table_aggregator.py] 行 5: ('二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '产量', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '单晶炉_阳光1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-08 09:09:15,601 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:15,605 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_8_义乌
2025-09-08 09:09:15,613 - INFO - [2_table_aggregator.py] 表 1_汇总表_8_义乌 创建成功
2025-09-08 09:09:15,613 - INFO - [2_table_aggregator.py] 正在为基地 义乌 执行数据聚合...
2025-09-08 09:09:15,614 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:15,616 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_8_义乌' 行数: 1467
2025-09-08 09:09:15,625 - INFO - [2_table_aggregator.py] a表 'a采集点表_8_义乌' 行数: 9645
2025-09-08 09:09:15,628 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_8_义乌' 行数: 1363
2025-09-08 09:09:15,629 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:15,629 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:15,630 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:15,638 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('义乌基地', '一厂-组件车间一'), ('义乌基地', '仓库'), ('义乌基地', '动力站-配电室'), ('义乌基地', '一厂-电池车间一'), ('义乌基地', '二厂-电池车间二')]
2025-09-08 09:09:15,643 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:15,643 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:15,655 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:15,725 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_8_义乌
2025-09-08 09:09:15,725 - INFO - [2_table_aggregator.py] 原始表c的行数: 1467
2025-09-08 09:09:15,725 - INFO - [2_table_aggregator.py] 汇总表的行数: 1467
2025-09-08 09:09:15,725 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 09:09:15,725 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 09:09:15,725 - INFO - [2_table_aggregator.py] 行 1: ('1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '运行状态', None, '1上玻璃102-设备状态', 'KEP-HC', 'YW-003-ZJ-61-256-0010#SN0001-RS', '1', '1上玻璃102', '1', '一厂-组件车间一', '003', 'YW-003-ZJ-61-256-0010', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-08 09:09:15,725 - INFO - [2_table_aggregator.py] 行 2: ('1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '运行状态', None, '1汇流条竖起机141-设备状态', 'KEP-HC', 'YW-003-ZJ-60-211-0002#SN0001-RS', '100', '1汇流条竖起机141', '23', '一厂-组件车间一', '003', 'YW-003-ZJ-60-211-0002', '通过', '运行状态', '信号类', '状态信号', '自动捋引线', '自动捋引线', '1', '1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '装框')
2025-09-08 09:09:15,725 - INFO - [2_table_aggregator.py] 行 3: ('1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '运行状态', None, '1层压机101-02-设备状态', 'KEP-HC', 'YW-003-ZJ-62-230-0021#SN0003-RS', '1001', '1层压机101-02', '158', '一厂-组件车间一', '003', 'YW-003-ZJ-62-230-0021', '通过', '运行状态', '信号类', '状态信号', '层压机', '层压机', '1', '1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '层压')
2025-09-08 09:09:15,725 - INFO - [2_table_aggregator.py] 行 4: ('1排版机092-产量', '0#10_003_22#160#Sum', '产量', None, '1排版机092-设备当班产能', 'KEP-HC', 'YW-003-ZJ-61-227-0015#YE0001-FV', '1004', '1排版机092', '160', '一厂-组件车间一', '003', 'YW-003-ZJ-61-227-0015', '通过', '反馈值', '统计类', '产量', '排版机', '排版机', '1', '1排版机092-产量', '0#10_003_22#160#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'YW-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-08 09:09:15,725 - INFO - [2_table_aggregator.py] 行 5: ('1分档机111-耗电', '7#10_003_22#156#Sum', '耗电', '7', '1分档机111-电量', 'KEP-HC', 'YW-003-ZJ-64-239-0004#AE0005-FV', '1005', '1分档机111', '156', '一厂-组件车间一', '003', 'YW-003-ZJ-64-239-0004', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '1分档机111-耗电', '7#10_003_22#156#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YW-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '包装')
2025-09-08 09:09:15,727 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:15,733 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_9_邢台
2025-09-08 09:09:15,741 - INFO - [2_table_aggregator.py] 表 1_汇总表_9_邢台 创建成功
2025-09-08 09:09:15,741 - INFO - [2_table_aggregator.py] 正在为基地 邢台 执行数据聚合...
2025-09-08 09:09:15,742 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:15,743 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_9_邢台' 行数: 943
2025-09-08 09:09:15,754 - INFO - [2_table_aggregator.py] a表 'a采集点表_9_邢台' 行数: 8176
2025-09-08 09:09:15,756 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_9_邢台' 行数: 488
2025-09-08 09:09:15,758 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:15,759 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:15,759 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:15,768 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('邢台基地', '三厂（三园区）-组件三车间'), ('邢台基地', '二厂（二园区）-组件一车间')]
2025-09-08 09:09:15,774 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:15,774 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:15,786 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:15,852 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_9_邢台
2025-09-08 09:09:15,852 - INFO - [2_table_aggregator.py] 原始表c的行数: 943
2025-09-08 09:09:15,852 - INFO - [2_table_aggregator.py] 汇总表的行数: 943
2025-09-08 09:09:15,852 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 09:09:15,852 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 09:09:15,853 - INFO - [2_table_aggregator.py] 行 1: ('分档机1FD501-耗电', '7#2_004_22#249#Sum', '耗电', '7', '分档机1FD501#设备当前电能表示数', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#AE0002-FV', '801', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '分档机1FD501-耗电', '7#2_004_22#249#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'XT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '邢台基地', '组件工段', '包装')
2025-09-08 09:09:15,853 - INFO - [2_table_aggregator.py] 行 2: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', None, '分档机1FD501#设备白班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0004-FV', '805', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-08 09:09:15,853 - INFO - [2_table_aggregator.py] 行 3: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', None, '分档机1FD501#设备夜班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0005-FV', '807', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-08 09:09:15,853 - INFO - [2_table_aggregator.py] 行 4: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', None, '裁切机1EC106#设备白班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0002-FV', '249', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-08 09:09:15,853 - INFO - [2_table_aggregator.py] 行 5: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', None, '裁切机1EC106#设备夜班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0003-FV', '250', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-08 09:09:15,853 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:15,866 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_10_宁晋
2025-09-08 09:09:15,869 - INFO - [2_table_aggregator.py] 表 1_汇总表_10_宁晋 创建成功
2025-09-08 09:09:15,869 - INFO - [2_table_aggregator.py] 正在为基地 宁晋 执行数据聚合...
2025-09-08 09:09:15,870 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:15,873 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_10_宁晋' 行数: 2083
2025-09-08 09:09:15,898 - INFO - [2_table_aggregator.py] a表 'a采集点表_10_宁晋' 行数: 25728
2025-09-08 09:09:15,902 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_10_宁晋' 行数: 1385
2025-09-08 09:09:15,903 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:15,903 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:15,904 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:15,923 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('宁晋基地', '宁晋东城-电池车间'), ('宁晋基地', '宁晋东城-电池车间-配电室'), ('宁晋基地', '动力车间'), ('', '宁晋东城-电池车间')]
2025-09-08 09:09:15,926 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:15,926 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:15,940 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:16,197 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_10_宁晋
2025-09-08 09:09:16,197 - INFO - [2_table_aggregator.py] 原始表c的行数: 2083
2025-09-08 09:09:16,197 - INFO - [2_table_aggregator.py] 汇总表的行数: 2083
2025-09-08 09:09:16,197 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 09:09:16,197 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 09:09:16,197 - INFO - [2_table_aggregator.py] 行 1: ('硼扩工艺机401-耗电', '7#7_001_21#1#Sum', '耗电', '7', '宁晋电池-硼扩工艺机401-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-43-155-0001#AE0008-FV', '8', '硼扩工艺机401', '1', '宁晋东城-电池车间', '001', 'NJ-001-DC-43-155-0001', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩主机', '硼扩主机', '1', '硼扩工艺机401-耗电', '7#7_001_21#1#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '硼扩')
2025-09-08 09:09:16,197 - INFO - [2_table_aggregator.py] 行 2: ('硼扩工艺机410-耗电', '7#7_001_21#10#Sum', '耗电', '7', '宁晋电池-硼扩工艺机410-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-43-155-0010#AE0008-FV', '80', '硼扩工艺机410', '10', '宁晋东城-电池车间', '001', 'NJ-001-DC-43-155-0010', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩主机', '硼扩主机', '1', '硼扩工艺机410-耗电', '7#7_001_21#10#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '硼扩')
2025-09-08 09:09:16,197 - INFO - [2_table_aggregator.py] 行 3: ('背膜工艺机413-耗电', '7#7_001_21#100#Sum', '耗电', '7', '宁晋电池-背膜工艺机413-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0013#AE0008-FV', '800', '背膜工艺机413', '100', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0013', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机413-耗电', '7#7_001_21#100#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-08 09:09:16,197 - INFO - [2_table_aggregator.py] 行 4: ('背膜工艺机414-耗电', '7#7_001_21#101#Sum', '耗电', '7', '宁晋电池-背膜工艺机414-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0014#AE0008-FV', '808', '背膜工艺机414', '101', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0014', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机414-耗电', '7#7_001_21#101#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-08 09:09:16,197 - INFO - [2_table_aggregator.py] 行 5: ('背膜工艺机415-耗电', '7#7_001_21#102#Sum', '耗电', '7', '宁晋电池-背膜工艺机415-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0015#AE0008-FV', '816', '背膜工艺机415', '102', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0015', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机415-耗电', '7#7_001_21#102#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-08 09:09:16,209 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:16,209 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_11_石家庄
2025-09-08 09:09:16,216 - INFO - [2_table_aggregator.py] 表 1_汇总表_11_石家庄 创建成功
2025-09-08 09:09:16,216 - INFO - [2_table_aggregator.py] 正在为基地 石家庄 执行数据聚合...
2025-09-08 09:09:16,219 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:16,220 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_11_石家庄' 行数: 9978
2025-09-08 09:09:16,241 - INFO - [2_table_aggregator.py] a表 'a采集点表_11_石家庄' 行数: 82456
2025-09-08 09:09:16,248 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_11_石家庄' 行数: 3714
2025-09-08 09:09:16,250 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:16,251 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:16,251 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:16,311 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('石家庄基地', '一厂-动力站'), ('石家庄基地', '一厂-电池一期-配电室'), ('石家庄基地', '一厂-切片一期-配电室'), ('石家庄基地', '一厂-电池一期'), ('石家庄基地', '一厂-切片一期')]
2025-09-08 09:09:16,478 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:16,479 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:16,493 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:17,020 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_11_石家庄
2025-09-08 09:09:17,020 - INFO - [2_table_aggregator.py] 原始表c的行数: 9978
2025-09-08 09:09:17,020 - INFO - [2_table_aggregator.py] 汇总表的行数: 9978
2025-09-08 09:09:17,020 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 09:09:17,021 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 09:09:17,021 - INFO - [2_table_aggregator.py] 行 1: ('重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '耗电', '7', '78AH07#仪表正向有功总', '动力配电室仪表2.4.6.8', 'SJ-003-ZZ-01-JQ-0207#AE0001-FV', '447079', '78AH07', '519381', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0207', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000480', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-08 09:09:17,021 - INFO - [2_table_aggregator.py] 行 2: ('重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '耗电', '7', '71AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0102#AE0001-FV', '446711', '71AH07', '519013', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0102', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000182', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-08 09:09:17,021 - INFO - [2_table_aggregator.py] 行 3: ('重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '耗电', '7', '75AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0138#AE0001-FV', '446807', '75AH07', '519109', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0138', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000236', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-08 09:09:17,021 - INFO - [2_table_aggregator.py] 行 4: ('重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '耗电', '7', '77AH08#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0155#AE0001-FV', '446871', '77AH08', '519173', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0155', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000483', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-08 09:09:17,021 - INFO - [2_table_aggregator.py] 行 5: ('重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '耗电', '7', '71AH06#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0099#AE0001-FV', '446703', '71AH06', '519005', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0099', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000479', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-08 09:09:17,029 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:17,029 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_12_巴彦淖尔
2025-09-08 09:09:17,036 - INFO - [2_table_aggregator.py] 表 1_汇总表_12_巴彦淖尔 创建成功
2025-09-08 09:09:17,036 - INFO - [2_table_aggregator.py] 正在为基地 巴彦淖尔 执行数据聚合...
2025-09-08 09:09:17,038 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 09:09:17,039 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_12_巴彦淖尔' 行数: 0
2025-09-08 09:09:17,044 - INFO - [2_table_aggregator.py] a表 'a采集点表_12_巴彦淖尔' 行数: 2119
2025-09-08 09:09:17,046 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_12_巴彦淖尔' 行数: 0
2025-09-08 09:09:17,046 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 09:09:17,047 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 09:09:17,048 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 09:09:17,049 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('巴彦淖尔', '一厂（一期）-5GW组件车间')]
2025-09-08 09:09:17,051 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 09:09:17,051 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 09:09:17,063 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 09:09:17,065 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_12_巴彦淖尔
2025-09-08 09:09:17,065 - INFO - [2_table_aggregator.py] 原始表c的行数: 0
2025-09-08 09:09:17,065 - INFO - [2_table_aggregator.py] 汇总表的行数: 0
2025-09-08 09:09:17,065 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 09:09:17,065 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 09:09:17,065 - INFO - [2_table_aggregator.py] 所有基地数据聚合完成!
2025-09-08 09:09:17,065 - INFO - [2_table_aggregator.py] 数据库连接已关闭
2025-09-08 09:09:17,093 - INFO - 脚本 2_table_aggregator.py 成功完成 (返回码: 0)
2025-09-08 09:09:17,094 - INFO - 脚本 2_table_aggregator.py 执行完成，继续下一个
2025-09-08 09:09:17,094 - INFO - 正在运行脚本: 3_merge_tables.py
2025-09-08 09:09:17,094 - INFO - 开始运行脚本: D:\JA\database\3_merge_tables.py
2025-09-08 09:09:17,094 - INFO - 工作目录: D:\JA\database
2025-09-08 09:09:19,579 - INFO - [3_merge_tables.py] 开始处理 12 个基地...
2025-09-08 09:09:19,633 - INFO - [3_merge_tables.py] 正在处理: 扬州基地...正在处理: 东台基地...
2025-09-08 09:09:19,633 - INFO - [3_merge_tables.py] 正在处理: 合肥基地...正在处理: 鄂尔多斯基地...
2025-09-08 09:09:19,643 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-08 09:09:19,643 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_1_扬州  清理旧表: 2_采集点+设备合并表_3_合肥
2025-09-08 09:09:19,644 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_2_东台
2025-09-08 09:09:19,652 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_2_东台
2025-09-08 09:09:19,652 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-08 09:09:19,656 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_1_扬州
2025-09-08 09:09:19,657 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_3_合肥
2025-09-08 09:09:20,033 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_4_鄂尔多斯
2025-09-08 09:09:20,235 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:09:20,235 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:09:20,242 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\04鄂尔多斯基地\2_采集点+设备合并表_4_鄂尔多斯_20250908090919.xlsx
2025-09-08 09:09:20,644 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_3_合肥
2025-09-08 09:09:20,877 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_2_东台
2025-09-08 09:09:21,033 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_1_扬州
2025-09-08 09:09:23,757 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:09:23,757 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:09:23,782 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\03合肥基地\2_采集点+设备合并表_3_合肥_20250908090919.xlsx
2025-09-08 09:09:30,769 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_4_鄂尔多斯_20250908090919.xlsx
2025-09-08 09:09:30,770 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:09:35,700 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:09:35,700 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:09:35,734 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\02东台基地\2_采集点+设备合并表_2_东台_20250908090919.xlsx
2025-09-08 09:09:46,265 - INFO - [3_merge_tables.py] 正在处理: 曲靖基地...
2025-09-08 09:09:46,321 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_5_曲靖
2025-09-08 09:09:46,330 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_5_曲靖
2025-09-08 09:09:46,817 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:09:46,823 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:09:46,882 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\01扬州基地\2_采集点+设备合并表_1_扬州_20250908090919.xlsx
2025-09-08 09:09:47,252 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_5_曲靖
2025-09-08 09:10:07,028 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_3_合肥_20250908090919.xlsx
2025-09-08 09:10:07,029 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:10:20,625 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:10:20,625 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:10:20,657 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\05曲靖基地\2_采集点+设备合并表_5_曲靖_20250908090919.xlsx
2025-09-08 09:10:34,615 - INFO - [3_merge_tables.py] 正在处理: 奉贤基地...
2025-09-08 09:10:34,641 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_6_奉贤
2025-09-08 09:10:34,657 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_6_奉贤
2025-09-08 09:10:34,767 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_6_奉贤
2025-09-08 09:10:34,802 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_2_东台_20250908090919.xlsx
2025-09-08 09:10:34,802 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:10:36,608 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:10:36,610 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:10:36,623 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\06奉贤基地\2_采集点+设备合并表_6_奉贤_20250908090919.xlsx
2025-09-08 09:10:43,845 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_6_奉贤_20250908090919.xlsx
2025-09-08 09:10:43,846 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:10:50,716 - INFO - [3_merge_tables.py] 正在处理: 包头基地...
2025-09-08 09:10:50,785 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_7_包头
2025-09-08 09:10:50,799 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_7_包头
2025-09-08 09:10:53,233 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_7_包头
2025-09-08 09:10:53,847 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_1_扬州_20250908090919.xlsx
2025-09-08 09:10:53,847 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:11:11,423 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_5_曲靖_20250908090919.xlsx
2025-09-08 09:11:11,437 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:11:35,803 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:11:35,803 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:11:35,848 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\07包头基地\2_采集点+设备合并表_7_包头_20250908090919.xlsx
2025-09-08 09:12:01,731 - INFO - [3_merge_tables.py] 正在处理: 义乌基地...
2025-09-08 09:12:01,739 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_8_义乌
2025-09-08 09:12:01,755 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_8_义乌
2025-09-08 09:12:01,902 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_8_义乌
2025-09-08 09:12:02,113 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:12:02,113 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:12:02,118 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\08义乌基地\2_采集点+设备合并表_8_义乌_20250908090919.xlsx
2025-09-08 09:12:02,725 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_7_包头_20250908090919.xlsx
2025-09-08 09:12:02,725 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:12:11,616 - INFO - [3_merge_tables.py] 正在处理: 邢台基地...
2025-09-08 09:12:11,697 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_9_邢台
2025-09-08 09:12:11,708 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_9_邢台
2025-09-08 09:12:11,828 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_9_邢台
2025-09-08 09:12:12,115 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_8_义乌_20250908090919.xlsx
2025-09-08 09:12:12,116 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:12:19,343 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:12:19,343 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:12:19,346 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\09邢台基地\2_采集点+设备合并表_9_邢台_20250908090919.xlsx
2025-09-08 09:12:26,779 - INFO - [3_merge_tables.py] 正在处理: 宁晋基地...
2025-09-08 09:12:26,836 - INFO - [3_merge_tables.py] 正在处理: 石家庄基地...
2025-09-08 09:12:26,861 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_10_宁晋
2025-09-08 09:12:26,871 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_11_石家庄
2025-09-08 09:12:26,873 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_10_宁晋
2025-09-08 09:12:26,879 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_11_石家庄
2025-09-08 09:12:27,091 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_9_邢台_20250908090919.xlsx
2025-09-08 09:12:27,091 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:12:27,203 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_10_宁晋
2025-09-08 09:12:27,700 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_11_石家庄
2025-09-08 09:12:30,506 - INFO - [3_merge_tables.py] 正在处理: 巴彦淖尔基地...
2025-09-08 09:12:30,513 - INFO - [3_merge_tables.py] 清理旧表: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-08 09:12:30,521 - INFO - [3_merge_tables.py] 创建新表: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-08 09:12:30,577 - INFO - [3_merge_tables.py] 读取数据: 2_采集点+设备合并表_12_巴彦淖尔
2025-09-08 09:12:30,718 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:12:30,720 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:12:30,722 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\12巴彦淖尔基地\2_采集点+设备合并表_12_巴彦淖尔_20250908090919.xlsx
2025-09-08 09:12:31,239 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:12:31,240 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:12:31,255 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\10宁晋基地\2_采集点+设备合并表_10_宁晋_20250908090919.xlsx
2025-09-08 09:12:31,573 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_12_巴彦淖尔_20250908090919.xlsx
2025-09-08 09:12:31,588 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:12:39,474 - INFO - [3_merge_tables.py] 重命名列
2025-09-08 09:12:39,474 - INFO - [3_merge_tables.py] 调整列顺序
2025-09-08 09:12:39,518 - INFO - [3_merge_tables.py] 导出到: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\11石家庄基地\2_采集点+设备合并表_11_石家庄_20250908090919.xlsx
2025-09-08 09:12:54,721 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_10_宁晋_20250908090919.xlsx
2025-09-08 09:12:54,723 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:13:04,041 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备合并表_11_石家庄_20250908090919.xlsx
2025-09-08 09:13:04,041 - INFO - [3_merge_tables.py] 应用基本格式...
2025-09-08 09:13:30,527 - INFO - [3_merge_tables.py] 所有基地处理完成! 总耗时: 250.95秒
2025-09-08 09:13:30,527 - INFO - [3_merge_tables.py] 开始合并所有基地文件...
2025-09-08 09:13:30,529 - INFO - [3_merge_tables.py] 正在合并: 扬州基地...
2025-09-08 09:13:49,300 - INFO - [3_merge_tables.py] 正在合并: 东台基地...
2025-09-08 09:14:04,908 - INFO - [3_merge_tables.py] 正在合并: 合肥基地...
2025-09-08 09:14:13,037 - INFO - [3_merge_tables.py] 正在合并: 鄂尔多斯基地...
2025-09-08 09:14:16,101 - INFO - [3_merge_tables.py] 正在合并: 曲靖基地...
2025-09-08 09:14:28,692 - INFO - [3_merge_tables.py] 正在合并: 奉贤基地...
2025-09-08 09:14:29,692 - INFO - [3_merge_tables.py] 正在合并: 包头基地...
2025-09-08 09:14:39,844 - INFO - [3_merge_tables.py] 正在合并: 义乌基地...
2025-09-08 09:14:41,261 - INFO - [3_merge_tables.py] 正在合并: 邢台基地...
2025-09-08 09:14:43,481 - INFO - [3_merge_tables.py] 正在合并: 宁晋基地...
2025-09-08 09:14:47,237 - INFO - [3_merge_tables.py] 正在合并: 石家庄基地...
2025-09-08 09:15:01,190 - INFO - [3_merge_tables.py] 正在合并: 巴彦淖尔基地...
2025-09-08 09:17:10,205 - INFO - [3_merge_tables.py] 合并完成! 耗时: 219.68秒
2025-09-08 09:17:10,205 - INFO - [3_merge_tables.py] 正在应用基本格式...
2025-09-08 09:21:38,406 - INFO - [3_merge_tables.py] 合并文件已生成: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】采集点+设备_20250908090919.xlsx
2025-09-08 09:21:38,407 - INFO - [3_merge_tables.py] 程序已正常退出
2025-09-08 09:21:59,398 - INFO - 脚本 3_merge_tables.py 成功完成 (返回码: 0)
2025-09-08 09:21:59,400 - INFO - 脚本 3_merge_tables.py 执行完成，继续下一个
2025-09-08 09:21:59,400 - INFO - 正在运行脚本: 4_merge_calc_tables.py
2025-09-08 09:21:59,400 - INFO - 开始运行脚本: D:\JA\database\4_merge_calc_tables.py
2025-09-08 09:21:59,400 - INFO - 工作目录: D:\JA\database
2025-09-08 09:22:00,624 - INFO - [4_merge_calc_tables.py] 开始导出数据...
2025-09-08 09:22:00,624 - INFO - [4_merge_calc_tables.py] 输出目录: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点
2025-09-08 09:22:02,720 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_1_扬州 已导出到Sheet: 扬州
2025-09-08 09:22:03,611 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_2_东台 已导出到Sheet: 东台
2025-09-08 09:22:03,902 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_3_合肥 已导出到Sheet: 合肥
2025-09-08 09:22:04,105 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_4_鄂尔多斯 已导出到Sheet: 鄂尔多斯
2025-09-08 09:22:06,377 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_5_曲靖 已导出到Sheet: 曲靖
2025-09-08 09:22:06,463 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_6_奉贤 已导出到Sheet: 奉贤
2025-09-08 09:22:07,977 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_7_包头 已导出到Sheet: 包头
2025-09-08 09:22:08,202 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_8_义乌 已导出到Sheet: 义乌
2025-09-08 09:22:08,330 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_9_邢台 已导出到Sheet: 邢台
2025-09-08 09:22:08,578 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_10_宁晋 已导出到Sheet: 宁晋
2025-09-08 09:22:10,271 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_11_石家庄 已导出到Sheet: 石家庄
2025-09-08 09:22:10,280 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_12_巴彦淖尔 已导出到Sheet: 巴彦淖尔
2025-09-08 09:22:19,345 - INFO - [4_merge_calc_tables.py] 汇总Sheet已创建
2025-09-08 09:22:47,715 - INFO - [4_merge_calc_tables.py] 文件已保存为: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250908092200.xlsx
2025-09-08 09:22:47,751 - INFO - [4_merge_calc_tables.py] 文件验证成功: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250908092200.xlsx
2025-09-08 09:22:47,751 - INFO - [4_merge_calc_tables.py] 文件大小: 25091.62 KB
2025-09-08 09:22:47,752 - INFO - [4_merge_calc_tables.py] 导出完成，耗时: 47.13 秒
2025-09-08 09:22:47,752 - INFO - [4_merge_calc_tables.py] === 导出摘要 ===
2025-09-08 09:22:47,752 - INFO - [4_merge_calc_tables.py] 输出文件: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250908092200.xlsx
2025-09-08 09:22:47,752 - INFO - [4_merge_calc_tables.py] 包含工作表: 汇总 + 12个基地表
2025-09-08 09:22:49,574 - INFO - 脚本 4_merge_calc_tables.py 成功完成 (返回码: 0)
2025-09-08 09:22:49,574 - INFO - 脚本 4_merge_calc_tables.py 执行完成，继续下一个
2025-09-08 09:22:49,574 - INFO - 结束执行时间: 2025-09-08 09:22:49
2025-09-08 09:22:49,574 - INFO - ==================================================
2025-09-08 18:01:41,996 - INFO - ==================================================
2025-09-08 18:01:41,997 - INFO - 开始执行流水线 - 2025-09-08 18:01:41
2025-09-08 18:01:41,997 - INFO - 虚拟环境路径: D:\JA\database\.venv
2025-09-08 18:01:41,997 - INFO - Python版本: 3.12.9 (tags/v3.12.9:fdb8142, Feb  4 2025, 15:27:58) [MSC v.1942 64 bit (AMD64)]
2025-09-08 18:01:42,087 - INFO - pymysql版本: 1.4.6
2025-09-08 18:01:42,087 - INFO - 正在运行脚本: 1_copy_to_local.py
2025-09-08 18:01:42,087 - INFO - 开始运行脚本: D:\JA\database\1_copy_to_local.py
2025-09-08 18:01:42,087 - INFO - 工作目录: D:\JA\database
2025-09-08 18:01:42,229 - INFO - [1_copy_to_local.py] 开始数据库同步任务: 2025-09-08 18:01:42
2025-09-08 18:01:42,229 - INFO - [1_copy_to_local.py] 开始同步基地: 扬州
2025-09-08 18:01:42,450 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_1_扬州
2025-09-08 18:01:50,592 - INFO - [1_copy_to_local.py] |- 同步完成: 87355 条数据
2025-09-08 18:01:50,592 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_1_扬州
2025-09-08 18:01:51,516 - INFO - [1_copy_to_local.py] |- 同步完成: 8775 条数据
2025-09-08 18:01:51,517 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_1_扬州
2025-09-08 18:01:51,804 - INFO - [1_copy_to_local.py] |- 同步完成: 11933 条数据
2025-09-08 18:01:51,804 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_1_扬州
2025-09-08 18:01:51,898 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-08 18:01:51,898 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_1_扬州
2025-09-08 18:01:52,466 - INFO - [1_copy_to_local.py] |- 同步完成: 8672 条数据
2025-09-08 18:01:52,466 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_1_扬州
2025-09-08 18:01:53,026 - INFO - [1_copy_to_local.py] |- 同步完成: 6076 条数据
2025-09-08 18:01:53,026 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_1_扬州
2025-09-08 18:01:53,492 - INFO - [1_copy_to_local.py] |- 同步完成: 3411 条数据
2025-09-08 18:01:53,497 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 11.27秒
2025-09-08 18:01:53,498 - INFO - [1_copy_to_local.py] 开始同步基地: 东台
2025-09-08 18:01:53,663 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_2_东台
2025-09-08 18:01:57,267 - INFO - [1_copy_to_local.py] |- 同步完成: 77532 条数据
2025-09-08 18:01:57,268 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_2_东台
2025-09-08 18:01:57,754 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-08 18:01:57,754 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_2_东台
2025-09-08 18:01:57,912 - INFO - [1_copy_to_local.py] |- 同步完成: 5767 条数据
2025-09-08 18:01:57,912 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_2_东台
2025-09-08 18:01:57,989 - INFO - [1_copy_to_local.py] |- 同步完成: 12 条数据
2025-09-08 18:01:57,989 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_2_东台
2025-09-08 18:01:58,231 - INFO - [1_copy_to_local.py] |- 同步完成: 5131 条数据
2025-09-08 18:01:58,231 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_2_东台
2025-09-08 18:01:58,464 - INFO - [1_copy_to_local.py] |- 同步完成: 4618 条数据
2025-09-08 18:01:58,464 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_2_东台
2025-09-08 18:01:58,616 - INFO - [1_copy_to_local.py] |- 同步完成: 1921 条数据
2025-09-08 18:01:58,619 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 5.12秒
2025-09-08 18:01:58,620 - INFO - [1_copy_to_local.py] 开始同步基地: 合肥
2025-09-08 18:02:06,783 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_3_合肥
2025-09-08 18:02:10,661 - INFO - [1_copy_to_local.py] |- 同步完成: 41670 条数据
2025-09-08 18:02:10,661 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_3_合肥
2025-09-08 18:02:11,111 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-08 18:02:11,111 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_3_合肥
2025-09-08 18:02:11,211 - INFO - [1_copy_to_local.py] |- 同步完成: 2417 条数据
2025-09-08 18:02:11,211 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_3_合肥
2025-09-08 18:02:11,290 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-08 18:02:11,290 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_3_合肥
2025-09-08 18:02:11,467 - INFO - [1_copy_to_local.py] |- 同步完成: 1890 条数据
2025-09-08 18:02:11,467 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_3_合肥
2025-09-08 18:02:11,858 - INFO - [1_copy_to_local.py] |- 同步完成: 2023 条数据
2025-09-08 18:02:11,858 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_3_合肥
2025-09-08 18:02:12,036 - INFO - [1_copy_to_local.py] |- 同步完成: 855 条数据
2025-09-08 18:02:12,038 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 13.42秒
2025-09-08 18:02:12,039 - INFO - [1_copy_to_local.py] 开始同步基地: 鄂尔多斯
2025-09-08 18:02:20,185 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_4_鄂尔多斯
2025-09-08 18:02:21,349 - INFO - [1_copy_to_local.py] |- 同步完成: 14404 条数据
2025-09-08 18:02:21,349 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_4_鄂尔多斯
2025-09-08 18:02:21,493 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-08 18:02:21,493 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_4_鄂尔多斯
2025-09-08 18:02:21,581 - INFO - [1_copy_to_local.py] |- 同步完成: 484 条数据
2025-09-08 18:02:21,581 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_4_鄂尔多斯
2025-09-08 18:02:21,656 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-08 18:02:21,656 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_4_鄂尔多斯
2025-09-08 18:02:21,756 - INFO - [1_copy_to_local.py] |- 同步完成: 310 条数据
2025-09-08 18:02:21,756 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_4_鄂尔多斯
2025-09-08 18:02:21,912 - INFO - [1_copy_to_local.py] |- 同步完成: 794 条数据
2025-09-08 18:02:21,912 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_4_鄂尔多斯
2025-09-08 18:02:22,006 - INFO - [1_copy_to_local.py] |- 同步完成: 152 条数据
2025-09-08 18:02:22,007 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 9.97秒
2025-09-08 18:02:22,008 - INFO - [1_copy_to_local.py] 开始同步基地: 曲靖
2025-09-08 18:02:22,271 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_5_曲靖
2025-09-08 18:02:28,370 - INFO - [1_copy_to_local.py] |- 同步完成: 71297 条数据
2025-09-08 18:02:28,370 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_5_曲靖
2025-09-08 18:02:29,452 - INFO - [1_copy_to_local.py] |- 同步完成: 8527 条数据
2025-09-08 18:02:29,452 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_5_曲靖
2025-09-08 18:02:29,821 - INFO - [1_copy_to_local.py] |- 同步完成: 15092 条数据
2025-09-08 18:02:29,821 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_5_曲靖
2025-09-08 18:02:29,948 - INFO - [1_copy_to_local.py] |- 同步完成: 8 条数据
2025-09-08 18:02:29,948 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_5_曲靖
2025-09-08 18:02:30,453 - INFO - [1_copy_to_local.py] |- 同步完成: 8528 条数据
2025-09-08 18:02:30,453 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_5_曲靖
2025-09-08 18:02:31,432 - INFO - [1_copy_to_local.py] |- 同步完成: 13974 条数据
2025-09-08 18:02:31,432 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_5_曲靖
2025-09-08 18:02:31,819 - INFO - [1_copy_to_local.py] |- 同步完成: 2491 条数据
2025-09-08 18:02:31,823 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 9.82秒
2025-09-08 18:02:31,824 - INFO - [1_copy_to_local.py] 开始同步基地: 奉贤
2025-09-08 18:02:31,991 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_6_奉贤
2025-09-08 18:02:32,600 - INFO - [1_copy_to_local.py] |- 同步完成: 6140 条数据
2025-09-08 18:02:32,601 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_6_奉贤
2025-09-08 18:02:32,760 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-09-08 18:02:32,760 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_6_奉贤
2025-09-08 18:02:32,852 - INFO - [1_copy_to_local.py] |- 同步完成: 648 条数据
2025-09-08 18:02:32,852 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_6_奉贤
2025-09-08 18:02:32,945 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-08 18:02:32,945 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_6_奉贤
2025-09-08 18:02:33,056 - INFO - [1_copy_to_local.py] |- 同步完成: 513 条数据
2025-09-08 18:02:33,057 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_6_奉贤
2025-09-08 18:02:33,168 - INFO - [1_copy_to_local.py] |- 同步完成: 667 条数据
2025-09-08 18:02:33,168 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_6_奉贤
2025-09-08 18:02:33,276 - INFO - [1_copy_to_local.py] |- 同步完成: 280 条数据
2025-09-08 18:02:33,277 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.45秒
2025-09-08 18:02:33,277 - INFO - [1_copy_to_local.py] 开始同步基地: 包头
2025-09-08 18:02:33,379 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_7_包头
2025-09-08 18:02:36,742 - INFO - [1_copy_to_local.py] |- 同步完成: 59306 条数据
2025-09-08 18:02:36,742 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_7_包头
2025-09-08 18:02:37,203 - INFO - [1_copy_to_local.py] |- 同步完成: 4806 条数据
2025-09-08 18:02:37,203 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_7_包头
2025-09-08 18:02:37,475 - INFO - [1_copy_to_local.py] |- 同步完成: 10009 条数据
2025-09-08 18:02:37,475 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_7_包头
2025-09-08 18:02:37,545 - INFO - [1_copy_to_local.py] |- 同步完成: 10 条数据
2025-09-08 18:02:37,545 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_7_包头
2025-09-08 18:02:37,824 - INFO - [1_copy_to_local.py] |- 同步完成: 4805 条数据
2025-09-08 18:02:37,824 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_7_包头
2025-09-08 18:02:38,134 - INFO - [1_copy_to_local.py] |- 同步完成: 5574 条数据
2025-09-08 18:02:38,134 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_7_包头
2025-09-08 18:02:38,347 - INFO - [1_copy_to_local.py] |- 同步完成: 2019 条数据
2025-09-08 18:02:38,361 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 5.08秒
2025-09-08 18:02:38,362 - INFO - [1_copy_to_local.py] 开始同步基地: 义乌
2025-09-08 18:02:38,561 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_8_义乌
2025-09-08 18:02:39,328 - INFO - [1_copy_to_local.py] |- 同步完成: 9645 条数据
2025-09-08 18:02:39,328 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_8_义乌
2025-09-08 18:02:39,498 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-08 18:02:39,498 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_8_义乌
2025-09-08 18:02:39,621 - INFO - [1_copy_to_local.py] |- 同步完成: 1467 条数据
2025-09-08 18:02:39,621 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_8_义乌
2025-09-08 18:02:39,719 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-08 18:02:39,720 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_8_义乌
2025-09-08 18:02:39,859 - INFO - [1_copy_to_local.py] |- 同步完成: 1363 条数据
2025-09-08 18:02:39,859 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_8_义乌
2025-09-08 18:02:40,060 - INFO - [1_copy_to_local.py] |- 同步完成: 2776 条数据
2025-09-08 18:02:40,060 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_8_义乌
2025-09-08 18:02:40,180 - INFO - [1_copy_to_local.py] |- 同步完成: 4 条数据
2025-09-08 18:02:40,181 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.82秒
2025-09-08 18:02:40,181 - INFO - [1_copy_to_local.py] 开始同步基地: 邢台
2025-09-08 18:02:40,345 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_9_邢台
2025-09-08 18:02:41,189 - INFO - [1_copy_to_local.py] |- 同步完成: 8176 条数据
2025-09-08 18:02:41,189 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_9_邢台
2025-09-08 18:02:41,382 - INFO - [1_copy_to_local.py] |- 同步完成: 488 条数据
2025-09-08 18:02:41,384 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_9_邢台
2025-09-08 18:02:41,517 - INFO - [1_copy_to_local.py] |- 同步完成: 943 条数据
2025-09-08 18:02:41,517 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_9_邢台
2025-09-08 18:02:41,641 - INFO - [1_copy_to_local.py] |- 同步完成: 5 条数据
2025-09-08 18:02:41,641 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_9_邢台
2025-09-08 18:02:41,790 - INFO - [1_copy_to_local.py] |- 同步完成: 488 条数据
2025-09-08 18:02:41,790 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_9_邢台
2025-09-08 18:02:41,978 - INFO - [1_copy_to_local.py] |- 同步完成: 814 条数据
2025-09-08 18:02:41,978 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_9_邢台
2025-09-08 18:02:42,127 - INFO - [1_copy_to_local.py] |- 同步完成: 300 条数据
2025-09-08 18:02:42,128 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 1.95秒
2025-09-08 18:02:42,129 - INFO - [1_copy_to_local.py] 开始同步基地: 宁晋
2025-09-08 18:02:42,336 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_10_宁晋
2025-09-08 18:02:44,933 - INFO - [1_copy_to_local.py] |- 同步完成: 25728 条数据
2025-09-08 18:02:44,933 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_10_宁晋
2025-09-08 18:02:45,228 - INFO - [1_copy_to_local.py] |- 同步完成: 1385 条数据
2025-09-08 18:02:45,228 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_10_宁晋
2025-09-08 18:02:45,308 - INFO - [1_copy_to_local.py] |- 同步完成: 2083 条数据
2025-09-08 18:02:45,308 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_10_宁晋
2025-09-08 18:02:45,356 - INFO - [1_copy_to_local.py] |- 同步完成: 6 条数据
2025-09-08 18:02:45,356 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_10_宁晋
2025-09-08 18:02:45,456 - INFO - [1_copy_to_local.py] |- 同步完成: 1385 条数据
2025-09-08 18:02:45,457 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_10_宁晋
2025-09-08 18:02:45,553 - INFO - [1_copy_to_local.py] |- 同步完成: 850 条数据
2025-09-08 18:02:45,553 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_10_宁晋
2025-09-08 18:02:45,626 - INFO - [1_copy_to_local.py] |- 同步完成: 377 条数据
2025-09-08 18:02:45,627 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 3.50秒
2025-09-08 18:02:45,628 - INFO - [1_copy_to_local.py] 开始同步基地: 石家庄
2025-09-08 18:02:45,746 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_11_石家庄
2025-09-08 18:02:53,038 - INFO - [1_copy_to_local.py] |- 同步完成: 82456 条数据
2025-09-08 18:02:53,038 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_11_石家庄
2025-09-08 18:02:53,423 - INFO - [1_copy_to_local.py] |- 同步完成: 3714 条数据
2025-09-08 18:02:53,423 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_11_石家庄
2025-09-08 18:02:53,598 - INFO - [1_copy_to_local.py] |- 同步完成: 9978 条数据
2025-09-08 18:02:53,598 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_11_石家庄
2025-09-08 18:02:53,651 - INFO - [1_copy_to_local.py] |- 同步完成: 16 条数据
2025-09-08 18:02:53,651 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_11_石家庄
2025-09-08 18:02:53,859 - INFO - [1_copy_to_local.py] |- 同步完成: 3714 条数据
2025-09-08 18:02:53,859 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_11_石家庄
2025-09-08 18:02:54,185 - INFO - [1_copy_to_local.py] |- 同步完成: 6433 条数据
2025-09-08 18:02:54,185 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_11_石家庄
2025-09-08 18:02:54,291 - INFO - [1_copy_to_local.py] |- 同步完成: 1208 条数据
2025-09-08 18:02:54,297 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 8.67秒
2025-09-08 18:02:54,297 - INFO - [1_copy_to_local.py] 开始同步基地: 巴彦淖尔
2025-09-08 18:02:54,416 - INFO - [1_copy_to_local.py] 同步表: ja_tag -> A采集点表_12_巴彦淖尔
2025-09-08 18:02:54,781 - INFO - [1_copy_to_local.py] |- 同步完成: 2124 条数据
2025-09-08 18:02:54,782 - INFO - [1_copy_to_local.py] 同步表: ja_aggregation_relation -> B计算逻辑表_名称_12_巴彦淖尔
2025-09-08 18:02:54,855 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-08 18:02:54,855 - INFO - [1_copy_to_local.py] 同步表: ja_agg_relation_tag_bind -> C计算逻辑表_采集点_12_巴彦淖尔
2025-09-08 18:02:54,915 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-08 18:02:54,916 - INFO - [1_copy_to_local.py] 同步表: ja_interface -> D接口表_12_巴彦淖尔
2025-09-08 18:02:54,983 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-08 18:02:54,983 - INFO - [1_copy_to_local.py] 同步表: ja_service_group -> E服务表_12_巴彦淖尔
2025-09-08 18:02:55,047 - INFO - [1_copy_to_local.py] |- 同步完成: 0 条数据
2025-09-08 18:02:55,047 - INFO - [1_copy_to_local.py] 同步表: ja_equipment -> F设备表_12_巴彦淖尔
2025-09-08 18:02:55,134 - INFO - [1_copy_to_local.py] |- 同步完成: 158 条数据
2025-09-08 18:02:55,134 - INFO - [1_copy_to_local.py] 同步表: ja_device -> G数据源表_12_巴彦淖尔
2025-09-08 18:02:55,224 - INFO - [1_copy_to_local.py] |- 同步完成: 158 条数据
2025-09-08 18:02:55,225 - INFO - [1_copy_to_local.py] 基地同步完成, 总耗时: 0.93秒
2025-09-08 18:02:55,225 - INFO - [1_copy_to_local.py] 所有同步任务完成: 2025-09-08 18:02:55
2025-09-08 18:02:55,249 - INFO - 脚本 1_copy_to_local.py 成功完成 (返回码: 0)
2025-09-08 18:02:55,249 - INFO - 脚本 1_copy_to_local.py 执行完成，继续下一个
2025-09-08 18:02:55,249 - INFO - 正在运行脚本: 1_copy_ems_to_local.py
2025-09-08 18:02:55,249 - INFO - 开始运行脚本: D:\JA\database\1_copy_ems_to_local.py
2025-09-08 18:02:55,249 - INFO - 工作目录: D:\JA\database
2025-09-08 18:02:55,506 - INFO - [1_copy_ems_to_local.py] 连接源数据库: 172.25.4.87:5432/ems_test
2025-09-08 18:02:55,807 - INFO - [1_copy_ems_to_local.py] 连接目标数据库: localhost:3306/mzr_db
2025-09-08 18:02:55,843 - INFO - [1_copy_ems_to_local.py] 开始迁移表: from_demo.dim_base -> x【字典】基地编码
2025-09-08 18:02:56,187 - INFO - [1_copy_ems_to_local.py] 表 x【字典】基地编码 创建成功
2025-09-08 18:02:56,246 - INFO - [1_copy_ems_to_local.py] 插入 12 行到 x【字典】基地编码
2025-09-08 18:02:56,247 - INFO - [1_copy_ems_to_local.py] 共插入 12 行到 x【字典】基地编码
2025-09-08 18:02:56,247 - INFO - [1_copy_ems_to_local.py] 表 from_demo.dim_base -> x【字典】基地编码 迁移完成
2025-09-08 18:02:56,247 - INFO - [1_copy_ems_to_local.py] 开始迁移表: from_demo.dim_system_type -> w【字典】系统编码
2025-09-08 18:02:56,323 - INFO - [1_copy_ems_to_local.py] 表 w【字典】系统编码 创建成功
2025-09-08 18:02:56,381 - INFO - [1_copy_ems_to_local.py] 插入 26 行到 w【字典】系统编码
2025-09-08 18:02:56,382 - INFO - [1_copy_ems_to_local.py] 共插入 26 行到 w【字典】系统编码
2025-09-08 18:02:56,382 - INFO - [1_copy_ems_to_local.py] 表 from_demo.dim_system_type -> w【字典】系统编码 迁移完成
2025-09-08 18:02:56,382 - INFO - [1_copy_ems_to_local.py] PostgreSQL连接已关闭
2025-09-08 18:02:56,383 - INFO - [1_copy_ems_to_local.py] MySQL连接已关闭
2025-09-08 18:02:56,383 - INFO - [1_copy_ems_to_local.py] 数据库连接已关闭
2025-09-08 18:02:56,400 - INFO - 脚本 1_copy_ems_to_local.py 成功完成 (返回码: 0)
2025-09-08 18:02:56,400 - INFO - 脚本 1_copy_ems_to_local.py 执行完成，继续下一个
2025-09-08 18:02:56,400 - INFO - 正在运行脚本: 2_table_aggregator.py
2025-09-08 18:02:56,400 - INFO - 开始运行脚本: D:\JA\database\2_table_aggregator.py
2025-09-08 18:02:56,400 - INFO - 工作目录: D:\JA\database
2025-09-08 18:02:56,673 - INFO - [2_table_aggregator.py] 开始数据聚合流程...
2025-09-08 18:02:56,673 - INFO - [2_table_aggregator.py] 加载配置文件: 2_table_aggregator_config.json
2025-09-08 18:02:56,785 - INFO - [2_table_aggregator.py] 数据库连接成功
2025-09-08 18:02:56,795 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_1_扬州
2025-09-08 18:02:56,805 - INFO - [2_table_aggregator.py] 表 1_汇总表_1_扬州 创建成功
2025-09-08 18:02:56,805 - INFO - [2_table_aggregator.py] 正在为基地 扬州 执行数据聚合...
2025-09-08 18:02:56,817 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:02:56,830 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_1_扬州' 行数: 11933
2025-09-08 18:02:56,853 - INFO - [2_table_aggregator.py] a表 'a采集点表_1_扬州' 行数: 87355
2025-09-08 18:02:56,866 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_1_扬州' 行数: 8775
2025-09-08 18:02:56,868 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:02:56,870 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:02:56,871 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:02:56,954 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('扬州基地', '一厂（晶运园区）-F3电池车间'), ('扬州基地', '一厂（晶运园区）-F2电池车间'), ('扬州基地', '一厂（晶运园区）-动力站F3'), ('扬州基地', '二厂（晶山园区）-晶山组件（M3）'), ('扬州基地', '一厂（晶运园区）-动力站-配电室')]
2025-09-08 18:02:57,283 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:02:57,283 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:02:57,294 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:02:58,028 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_1_扬州
2025-09-08 18:02:58,028 - INFO - [2_table_aggregator.py] 原始表c的行数: 11933
2025-09-08 18:02:58,028 - INFO - [2_table_aggregator.py] 汇总表的行数: 11933
2025-09-08 18:02:58,028 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 18:02:58,028 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 18:02:58,028 - INFO - [2_table_aggregator.py] 行 1: ('LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '耗电', '7', '电池车间LPCVD自动化312#电能', '电池车间LPCVD自动化312', 'YZ-002-DC-58-206-0037#AE0005-FV', '85262', 'LPCVD自动化312（JAYZ2438173）', '90002', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-58-206-0037', '通过', '反馈值', '能耗类', '正向有功电度', 'LPCVD自动化', 'LPCVD自动化', '1', 'LPCVD自动化312（JAYZ2438173）-耗电', '7#9_002_21#90002#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000250', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', 'LPCVD')
2025-09-08 18:02:58,029 - INFO - [2_table_aggregator.py] 行 2: ('硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '耗电', '7', '电池车间硼扩自动化317#电能', '电池车间硼扩自动化317', 'YZ-002-DC-43-156-0039#AE0005-FV', '85636', '硼扩自动化317（JAYZ23C7297）', '89886', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-43-156-0039', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩自动化', '硼扩自动化', '1', '硼扩自动化317（JAYZ23C7297）-耗电', '7#9_002_21#89886#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YZ-EMS-AE-E-NS-NS-000000134', '能源管理', '设备', '1', '1', '1', '1', '扬州基地', '电池工段', '硼扩')
2025-09-08 18:02:58,029 - INFO - [2_table_aggregator.py] 行 3: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-08 18:02:58,029 - INFO - [2_table_aggregator.py] 行 4: ('正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '运行状态', None, '电池车间正膜主机333#炉管5#设备运行状态', '电池车间正膜主机333', 'YZ-002-DC-52-173-0065#SN0005-RS', '90985', '正膜主机333（JAYZ23C7357）', '90107', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-52-173-0065', '通过', '运行状态', '信号类', '状态信号', '正膜主机', '正膜主机', '1', '正膜主机333_JAYZ23C7357#运行时长', 'YZ-002-DC-52-173-0065#OperationStatusTime#90107', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000349', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '正膜')
2025-09-08 18:02:58,029 - INFO - [2_table_aggregator.py] 行 5: ('背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '运行状态', None, '电池车间背膜主机307#炉管5#设备运行状态', '电池车间背膜主机307', 'YZ-002-DC-53-175-0040#SN0005-RS', '90931', '背膜主机307（JAYZ2417811）', '90116', '一厂（晶运园区）-F3电池车间', '002', 'YZ-002-DC-53-175-0040', '通过', '运行状态', '信号类', '状态信号', '背膜主机', '背膜主机', '1', '背膜主机307_JAYZ2417811#运行时长', 'YZ-002-DC-53-175-0040#OperationStatusTime#90116', '1', 'h1Diff', '12', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YZ-EMC-RS-E-NS-NS-000000358', '设备管控', '设备', '1', '1', '6', '1', '扬州基地', '电池工段', '背膜')
2025-09-08 18:02:58,030 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:02:58,036 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_2_东台
2025-09-08 18:02:58,050 - INFO - [2_table_aggregator.py] 表 1_汇总表_2_东台 创建成功
2025-09-08 18:02:58,051 - INFO - [2_table_aggregator.py] 正在为基地 东台 执行数据聚合...
2025-09-08 18:02:58,055 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:02:58,059 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_2_东台' 行数: 5767
2025-09-08 18:02:58,081 - INFO - [2_table_aggregator.py] a表 'a采集点表_2_东台' 行数: 77532
2025-09-08 18:02:58,089 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_2_东台' 行数: 5131
2025-09-08 18:02:58,090 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:02:58,090 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:02:58,091 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:02:58,127 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('东台基地', '一厂-电池车间1'), ('东台基地', '一厂-组件车间1'), ('东台基地', '一厂动力站'), ('东台基地', '一厂办公区'), ('东台基地', '其他区域')]
2025-09-08 18:02:58,139 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:02:58,139 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:02:58,154 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:02:58,648 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_2_东台
2025-09-08 18:02:58,648 - INFO - [2_table_aggregator.py] 原始表c的行数: 5767
2025-09-08 18:02:58,648 - INFO - [2_table_aggregator.py] 汇总表的行数: 5767
2025-09-08 18:02:58,648 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 18:02:58,648 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 18:02:58,648 - INFO - [2_table_aggregator.py] 行 1: ('BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '产量', None, 'BSG上料2号机#产量下料', 'BSG上料2号机', 'DT-001-DC-45-160-0002#YE0004-FV', '384554', 'BSG下料-BSGX1002', '512016', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0002', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1002-产量', '0#11_001_21#512016#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-08 18:02:58,648 - INFO - [2_table_aggregator.py] 行 2: ('BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '产量', None, 'BSG上料4号机#产量下料', 'BSG上料4号机', 'DT-001-DC-45-160-0003#YE0004-FV', '384544', 'BSG下料-BSGX1004', '512018', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0003', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1004-产量', '0#11_001_21#512018#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-08 18:02:58,648 - INFO - [2_table_aggregator.py] 行 3: ('BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '产量', None, 'BSG上料6号机#产量下料', 'BSG上料6号机', 'DT-001-DC-45-160-0004#YE0004-FV', '384586', 'BSG下料-BSGX1006', '512019', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0004', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1006-产量', '0#11_001_21#512019#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-08 18:02:58,648 - INFO - [2_table_aggregator.py] 行 4: ('BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '产量', None, 'BSG上料8号机#产量下料', 'BSG上料8号机', 'DT-001-DC-45-160-0006#YE0004-FV', '384562', 'BSG下料-BSGX1008', '512022', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0006', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1008-产量', '0#11_001_21#512022#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-08 18:02:58,648 - INFO - [2_table_aggregator.py] 行 5: ('BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '产量', None, 'BSG上料12号机#产量下料', 'BSG上料12号机', 'DT-001-DC-45-160-0008#YE0004-FV', '384488', 'BSG下料-BSGX1012', '512025', '一厂-电池车间1', '001', 'DT-001-DC-45-160-0008', '通过', '反馈值', '统计类', '产量', '去BSG自动化', '去BSG自动化', '1', 'BSG上料-BSGS1012-产量', '0#11_001_21#512025#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'DT-EMS-YE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '东台基地', '电池工段', '去BSG')
2025-09-08 18:02:58,648 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:02:58,656 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_3_合肥
2025-09-08 18:02:58,664 - INFO - [2_table_aggregator.py] 表 1_汇总表_3_合肥 创建成功
2025-09-08 18:02:58,664 - INFO - [2_table_aggregator.py] 正在为基地 合肥 执行数据聚合...
2025-09-08 18:02:58,665 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:02:58,667 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_3_合肥' 行数: 2417
2025-09-08 18:02:58,689 - INFO - [2_table_aggregator.py] a表 'a采集点表_3_合肥' 行数: 41670
2025-09-08 18:02:58,693 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_3_合肥' 行数: 1890
2025-09-08 18:02:58,693 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:02:58,694 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:02:58,695 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:02:58,704 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('合肥基地', '二厂（二部）-六车间（201#智慧工厂）'), ('合肥基地', '一厂（一部）-二车间（116#创新工厂）'), ('合肥基地', '207动力站'), ('合肥基地', '207动力站-配电室'), ('合肥基地', '一厂（一部）-四车间（110#领跑工厂）-配电室')]
2025-09-08 18:02:58,712 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:02:58,712 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:02:58,727 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:02:58,920 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_3_合肥
2025-09-08 18:02:58,920 - INFO - [2_table_aggregator.py] 原始表c的行数: 2417
2025-09-08 18:02:58,921 - INFO - [2_table_aggregator.py] 汇总表的行数: 2417
2025-09-08 18:02:58,921 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 18:02:58,921 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 18:02:58,921 - INFO - [2_table_aggregator.py] 行 1: ('二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '耗电', '7', '智慧工厂一-6BL15002-总有功电度', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#AE0003-FV', '10', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-耗电', '7#12_001_22#2#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000048', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-08 18:02:58,921 - INFO - [2_table_aggregator.py] 行 2: ('二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '产量', None, '智慧工厂一-6BL15002-产量', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#YE0005-FV', '12', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '反馈值', '统计类', '产量', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002-产量', '0#12_001_22#2#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000049', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-08 18:02:58,921 - INFO - [2_table_aggregator.py] 行 3: ('二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '运行状态', None, '智慧工厂一-6BL15002运行状态', '智慧工厂一-6BL15002-PLC', 'HF-001-ZJ-61-256-0001#SN0002-RS', '9', '二道玻璃机6BL15002', '2', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-256-0001', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '二道玻璃机6BL15002#运行时长', 'HF-001-ZJ-61-250-0001#OperationStatusTime#2', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'HF-EMC-RS-E-NS-NS-000000049', '设备管控', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-08 18:02:58,921 - INFO - [2_table_aggregator.py] 行 4: ('二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '耗电', '7', '智慧工厂一-6CQ13002-总有功电度', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#AE0001-FV', '759', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '能耗类', '正向有功电度', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-耗电', '7#12_001_22#36#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'HF-EMS-AE-E-NS-NS-000000078', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-08 18:02:58,921 - INFO - [2_table_aggregator.py] 行 5: ('二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '产量', None, '智慧工厂一-6CQ13002-产量', '智慧工厂一-6CQ13002-PLC', 'HF-001-ZJ-61-263-0001#YE0002-FV', '760', '二道裁切机6CQ13002', '36', '二厂（二部）-六车间（201#智慧工厂）', '001', 'HF-001-ZJ-61-263-0001', '通过', '反馈值', '统计类', '产量', '二道EVA裁切机', '二道EVA裁切机', '1', '二道裁切机6CQ13002-产量', '0#12_001_22#36#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'HF-EMS-YE-E-NS-NS-000000079', '能源管理', '设备', '1', '1', '1', '1', '合肥基地', '组件工段', '焊接')
2025-09-08 18:02:58,922 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:02:58,930 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_4_鄂尔多斯
2025-09-08 18:02:58,940 - INFO - [2_table_aggregator.py] 表 1_汇总表_4_鄂尔多斯 创建成功
2025-09-08 18:02:58,940 - INFO - [2_table_aggregator.py] 正在为基地 鄂尔多斯 执行数据聚合...
2025-09-08 18:02:58,941 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:02:58,943 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_4_鄂尔多斯' 行数: 484
2025-09-08 18:02:58,956 - INFO - [2_table_aggregator.py] a表 'a采集点表_4_鄂尔多斯' 行数: 14404
2025-09-08 18:02:58,959 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_4_鄂尔多斯' 行数: 310
2025-09-08 18:02:58,960 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:02:58,961 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:02:58,962 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:02:58,975 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('鄂尔多斯', '二厂（B区）-B4-5GW组件车间2'), ('', '二厂（B区）-B4-5GW组件车间2')]
2025-09-08 18:02:58,979 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:02:58,979 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:02:58,994 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:02:59,065 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_4_鄂尔多斯
2025-09-08 18:02:59,066 - INFO - [2_table_aggregator.py] 原始表c的行数: 484
2025-09-08 18:02:59,066 - INFO - [2_table_aggregator.py] 汇总表的行数: 484
2025-09-08 18:02:59,066 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 18:02:59,066 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 18:02:59,066 - INFO - [2_table_aggregator.py] 行 1: ('2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '运行状态', None, '2#串焊机01状态', '2#串焊机01', 'null-019-ZJ-61-224-0002#SN0003-RS', '1143', '2#串焊机01（JAEEDS2020087）', '162', '二厂（B区）-B4-5GW组件车间2', None, 'null-019-ZJ-61-224-0002', '通过', '运行状态', '信号类', '状态信号', '串焊机', '串焊机', '1', '2线串焊机01（JAEEDS2020087）#运行时长', 'EE-019-ZJ-61-224-0002#OperationStatusTime#162', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000004', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-08 18:02:59,066 - INFO - [2_table_aggregator.py] 行 2: ('2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '运行状态', None, '2#串焊机02状态', '2#串焊机02', 'null-019-ZJ-61-224-0001#SN0005-RS', '1132', '2#串焊机02（JAEEDS2020088）', '160', '二厂（B区）-B4-5GW组件车间2', None, 'null-019-ZJ-61-224-0001', '通过', '运行状态', '信号类', '状态信号', '串焊机', '串焊机', '1', '2线串焊机02（JAEEDS2020088）#运行时长', 'EE-019-ZJ-61-224-0001#OperationStatusTime#160', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-08 18:02:59,066 - INFO - [2_table_aggregator.py] 行 3: ('2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '运行状态', None, '2#串焊机03状态', '2#串焊机03', 'null-019-ZJ-61-224-0004#SN0004-RS', '1161', '2#串焊机03（JAEEDS2020089）', '167', '二厂（B区）-B4-5GW组件车间2', None, 'null-019-ZJ-61-224-0004', '通过', '运行状态', '信号类', '状态信号', '串焊机', '串焊机', '1', '2线串焊机03（JAEEDS2020089）#运行时长', 'EE-019-ZJ-61-224-0004#OperationStatusTime#167', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000006', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-08 18:02:59,066 - INFO - [2_table_aggregator.py] 行 4: ('2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '运行状态', None, '2#串焊机04状态', '2#串焊机04', 'null-019-ZJ-61-224-0003#SN0001-RS', '1149', '2#串焊机04（JAEEDS2020090）', '164', '二厂（B区）-B4-5GW组件车间2', None, 'null-019-ZJ-61-224-0003', '通过', '运行状态', '信号类', '状态信号', '串焊机', '串焊机', '1', '2线串焊机04（JAEEDS2020090）#运行时长', 'EE-019-ZJ-61-224-0003#OperationStatusTime#164', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'EE-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-08 18:02:59,066 - INFO - [2_table_aggregator.py] 行 5: ('1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '产量', None, '1#二道胶膜裁切机产量', '1#二道胶膜裁切机02', 'EE-019-ZJ-61-228-0001#YE0001-FV', '1115', '1#二道胶膜裁切机02（JAEEDS2020026）', '155', '二厂（B区）-B4-5GW组件车间2', None, 'EE-019-ZJ-61-228-0001', '通过', '反馈值', '统计类', '产量', '裁切机', '裁切机', '1', '1#二道胶膜裁切机02（JAEEDS2020026）-产量', '0#4_019_22#155#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'EE-EMS-YE-E-NS-NS-000000016', '能源管理', '设备', '1', '1', '1', '1', '鄂尔多斯', '组件工段', '焊接')
2025-09-08 18:02:59,067 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:02:59,131 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_5_曲靖
2025-09-08 18:02:59,141 - INFO - [2_table_aggregator.py] 表 1_汇总表_5_曲靖 创建成功
2025-09-08 18:02:59,141 - INFO - [2_table_aggregator.py] 正在为基地 曲靖 执行数据聚合...
2025-09-08 18:02:59,144 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:02:59,150 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_5_曲靖' 行数: 15092
2025-09-08 18:02:59,171 - INFO - [2_table_aggregator.py] a表 'a采集点表_5_曲靖' 行数: 71297
2025-09-08 18:02:59,181 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_5_曲靖' 行数: 8527
2025-09-08 18:02:59,181 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:02:59,182 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:02:59,182 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:02:59,197 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('曲靖基地', '三厂（三期）-电池一期车间（101）'), ('曲靖基地', '二厂（二期）-201拉晶车间'), ('曲靖基地', '二厂（二期）-201加工车间'), ('曲靖基地', '三厂（三期）-组件一期车间（104）'), ('曲靖基地', '二厂（二期）-202拉晶车间')]
2025-09-08 18:02:59,209 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:02:59,209 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:02:59,222 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:02:59,920 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_5_曲靖
2025-09-08 18:02:59,921 - INFO - [2_table_aggregator.py] 原始表c的行数: 15092
2025-09-08 18:02:59,921 - INFO - [2_table_aggregator.py] 汇总表的行数: 15099
2025-09-08 18:02:59,921 - INFO - [2_table_aggregator.py] 警告: 行数不一致! 可能丢失了 -7 行数据
2025-09-08 18:02:59,921 - INFO - [2_table_aggregator.py] 建议检查连接条件和数据完整性
2025-09-08 18:02:59,921 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 18:02:59,921 - INFO - [2_table_aggregator.py] 行 1: ('西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '运行状态', None, '西区POLY尾气处理B19#运行状态', '西区POLY尾气处理B19', 'QJ-028-DC-56-199-0039#SN0001-RS', '1070', '西区POLY尾气处理B19（QJJAKJ12021493）', '145', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0039', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区POLY尾气处理B19（QJJAKJ12021493）#运行时长', 'QJ-028-DC-56-199-0039#OperationStatusTime#145', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-08 18:02:59,921 - INFO - [2_table_aggregator.py] 行 2: ('西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '运行状态', None, '西区ALD尾气处理B01#运行状态', '西区ALD尾气处理B01', 'QJ-028-DC-56-199-0044#SN0001-RS', '1110', '西区ALD尾气处理B01（QJJAKJ12021632）', '151', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0044', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B01（QJJAKJ12021632）#运行时长', 'QJ-028-DC-56-199-0044#OperationStatusTime#151', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-08 18:02:59,921 - INFO - [2_table_aggregator.py] 行 3: ('西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '运行状态', None, '西区ALD尾气处理B02#运行状态', '西区ALD尾气处理B02', 'QJ-028-DC-56-199-0045#SN0001-RS', '1118', '西区ALD尾气处理B02（QJJAKJ12021633）', '152', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0045', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B02（QJJAKJ12021633）#运行时长', 'QJ-028-DC-56-199-0045#OperationStatusTime#152', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000005', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-08 18:02:59,921 - INFO - [2_table_aggregator.py] 行 4: ('西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '运行状态', None, '西区ALD尾气处理B03#运行状态', '西区ALD尾气处理B03', 'QJ-028-DC-56-199-0046#SN0001-RS', '1126', '西区ALD尾气处理B03（QJJAKJ120216334）', '153', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0046', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B03（QJJAKJ120216334）#运行时长', 'QJ-028-DC-56-199-0046#OperationStatusTime#153', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000007', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-08 18:02:59,923 - INFO - [2_table_aggregator.py] 行 5: ('西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '运行状态', None, '西区ALD尾气处理B04#运行状态', '西区ALD尾气处理B04', 'QJ-028-DC-56-199-0001#SN0001-RS', '8', '西区ALD尾气处理B04（QJJAKJ120216335）', '5', '三厂（三期）-电池一期车间（101）', '028', 'QJ-028-DC-56-199-0001', '通过', '运行状态', '信号类', '状态信号', '尾气处理', '尾气处理', '1', '西区ALD尾气处理B04（QJJAKJ120216335）#运行时长', 'QJ-028-DC-56-199-0001#OperationStatusTime#5', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'QJ-EMC-RS-E-NS-NS-000000009', '设备管控', '设备', '1', '1', '1', '1', '曲靖基地', '电池工段', '电池辅助')
2025-09-08 18:02:59,923 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:02:59,927 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_6_奉贤
2025-09-08 18:02:59,936 - INFO - [2_table_aggregator.py] 表 1_汇总表_6_奉贤 创建成功
2025-09-08 18:02:59,936 - INFO - [2_table_aggregator.py] 正在为基地 奉贤 执行数据聚合...
2025-09-08 18:02:59,937 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:02:59,939 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_6_奉贤' 行数: 648
2025-09-08 18:02:59,947 - INFO - [2_table_aggregator.py] a表 'a采集点表_6_奉贤' 行数: 6140
2025-09-08 18:02:59,949 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_6_奉贤' 行数: 513
2025-09-08 18:02:59,950 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:02:59,951 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:02:59,951 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:02:59,953 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('奉贤基地', '一厂-B2组件车间（北区）'), ('奉贤基地', '一厂-B1储能车间'), ('奉贤基地', '厂外-C2接线盒车间'), ('奉贤基地', 'E2动力站'), ('奉贤基地', '35KV变电站')]
2025-09-08 18:02:59,957 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:02:59,957 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:02:59,969 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:03:00,018 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_6_奉贤
2025-09-08 18:03:00,018 - INFO - [2_table_aggregator.py] 原始表c的行数: 648
2025-09-08 18:03:00,018 - INFO - [2_table_aggregator.py] 汇总表的行数: 648
2025-09-08 18:03:00,018 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 18:03:00,019 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 18:03:00,019 - INFO - [2_table_aggregator.py] 行 1: ('自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '运行状态', None, '装工装_201_PLC#运行状态', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#SN0001-RS', '162', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '通过', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#运行时长', 'FX-002-ZJ-63-235-0001#OperationStatusTime#32', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-08 18:03:00,019 - INFO - [2_table_aggregator.py] 行 2: ('自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '耗电', '7', '装工装_201_PLC#总有功电度', '装工装_201_PLC', 'FX-002-ZJ-63-235-0001#AE0004-FV', '165', '自动放工装-FX02FGZ0201', '32', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0001', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0201#耗电', '7#13_002_22#32#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-08 18:03:00,019 - INFO - [2_table_aggregator.py] 行 3: ('在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '运行状态', None, '裁切机_501_PLC#运行状态', '裁切机_501_PLC', 'FX-002-ZJ-61-228-0001#SN0001-RS', '153', '在线裁切机一道-FX02CQ0501', '29', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-61-228-0001', '通过', '运行状态', '信号类', '状态信号', '一道EVA裁切机', '一道EVA裁切机', '1', '在线裁切机一道FX02CQ0501#运行时长', 'FX-002-ZJ-61-228-0001#OperationStatusTime#29', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000079', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '焊接')
2025-09-08 18:03:00,019 - INFO - [2_table_aggregator.py] 行 4: ('自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '运行状态', None, '装工装_301_PLC#运行状态', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#SN0001-RS', '166', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '运行状态', '信号类', '状态信号', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#运行时长', 'FX-002-ZJ-63-235-0002#OperationStatusTime#33', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'FX-EMC-RS-E-NS-NS-000000112', '设备管控', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-08 18:03:00,019 - INFO - [2_table_aggregator.py] 行 5: ('自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '耗电', '7', '装工装_301_PLC#总有功电度', '装工装_301_PLC', 'FX-002-ZJ-63-235-0002#AE0004-FV', '169', '自动放工装-FX02FGZ0301', '33', '一厂-B2组件车间（北区）', '002', 'FX-002-ZJ-63-235-0002', '未抄表', '反馈值', '能耗类', '正向有功电度', '装工装', '装工装', '1', '自动放工装FX02FGZ0301#耗电', '7#13_002_22#33#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'FX-EMS-AE-E-NS-NS-000000040', '能源管理', '设备', '1', '1', '1', '1', '奉贤基地', '组件工段', '组件检测')
2025-09-08 18:03:00,023 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:03:00,026 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_7_包头
2025-09-08 18:03:00,038 - INFO - [2_table_aggregator.py] 表 1_汇总表_7_包头 创建成功
2025-09-08 18:03:00,039 - INFO - [2_table_aggregator.py] 正在为基地 包头 执行数据聚合...
2025-09-08 18:03:00,039 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:03:00,044 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_7_包头' 行数: 10009
2025-09-08 18:03:00,065 - INFO - [2_table_aggregator.py] a表 'a采集点表_7_包头' 行数: 59306
2025-09-08 18:03:00,077 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_7_包头' 行数: 4806
2025-09-08 18:03:00,078 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:03:00,078 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:03:00,079 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:03:00,139 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('包头基地', '二厂-拉晶车间'), ('包头基地', '三厂-拉晶车间'), ('包头基地', '二厂-加工车间'), ('包头基地', '三厂-切片车间-配电室'), ('包头基地', '三厂-动力站-配电室')]
2025-09-08 18:03:00,149 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:03:00,149 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:03:00,161 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:03:00,603 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_7_包头
2025-09-08 18:03:00,603 - INFO - [2_table_aggregator.py] 原始表c的行数: 10009
2025-09-08 18:03:00,603 - INFO - [2_table_aggregator.py] 汇总表的行数: 10009
2025-09-08 18:03:00,603 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 18:03:00,603 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 18:03:00,603 - INFO - [2_table_aggregator.py] 行 1: ('二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001#运行时长', 'BT-025-LJ-31-101-0001#OperationStatusTime#21121#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-08 18:03:00,603 - INFO - [2_table_aggregator.py] 行 2: ('二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '产量', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#SN0001-RS', '9641', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-产量', '0#1_025_19#21121#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-08 18:03:00,604 - INFO - [2_table_aggregator.py] 行 3: ('二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '耗电', '7', '单晶炉#电能', '二厂-拉晶车间单晶炉1001', 'BT-025-LJ-31-101-0001#AE0003-FV', '9643', '单晶炉_阳光1001', '21121', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0001', '通过', '反馈值', '能耗类', '正向有功电度', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1001-耗电', '7#1_025_19#21121#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'BT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-08 18:03:00,604 - INFO - [2_table_aggregator.py] 行 4: ('二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '运行状态', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '单晶炉_阳光1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010#运行时长', 'BT-025-LJ-31-101-0010#OperationStatusTime#21130#JA', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'BT-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-08 18:03:00,604 - INFO - [2_table_aggregator.py] 行 5: ('二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '产量', None, '单晶炉集控#运行状态', '二厂-拉晶车间单晶炉1010', 'BT-025-LJ-31-101-0010#SN0001-RS', '9668', '单晶炉_阳光1010', '21130', '二厂-拉晶车间', '025', 'BT-025-LJ-31-101-0010', '通过', '运行状态', '信号类', '状态信号', '单晶炉', '单晶炉', '1', '二厂-拉晶车间单晶炉1010-产量', '0#1_025_19#21130#Sum', '1', 'h1Diff', '13', '产能统计-设备圆棒产量', '产能统计-设备圆棒产量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_circular_rod_equipment_hourly', 'BT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '2', '1', '包头基地', '拉晶工段', '拉晶')
2025-09-08 18:03:00,604 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:03:00,612 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_8_义乌
2025-09-08 18:03:00,621 - INFO - [2_table_aggregator.py] 表 1_汇总表_8_义乌 创建成功
2025-09-08 18:03:00,621 - INFO - [2_table_aggregator.py] 正在为基地 义乌 执行数据聚合...
2025-09-08 18:03:00,624 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:03:00,626 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_8_义乌' 行数: 1467
2025-09-08 18:03:00,637 - INFO - [2_table_aggregator.py] a表 'a采集点表_8_义乌' 行数: 9645
2025-09-08 18:03:00,641 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_8_义乌' 行数: 1363
2025-09-08 18:03:00,642 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:03:00,643 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:03:00,643 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:03:00,654 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('义乌基地', '一厂-组件车间一'), ('义乌基地', '仓库'), ('义乌基地', '动力站-配电室'), ('义乌基地', '一厂-电池车间一'), ('义乌基地', '二厂-电池车间二')]
2025-09-08 18:03:00,659 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:03:00,660 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:03:00,673 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:03:00,757 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_8_义乌
2025-09-08 18:03:00,757 - INFO - [2_table_aggregator.py] 原始表c的行数: 1467
2025-09-08 18:03:00,757 - INFO - [2_table_aggregator.py] 汇总表的行数: 1467
2025-09-08 18:03:00,757 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 18:03:00,757 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 18:03:00,757 - INFO - [2_table_aggregator.py] 行 1: ('1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '运行状态', None, '1上玻璃102-设备状态', 'KEP-HC', 'YW-003-ZJ-61-256-0010#SN0001-RS', '1', '1上玻璃102', '1', '一厂-组件车间一', '003', 'YW-003-ZJ-61-256-0010', '通过', '运行状态', '信号类', '状态信号', '二道上玻璃机', '二道上玻璃机', '1', '1上玻璃102#运行时长', 'YW-003-ZJ-61-250-0001#OperationStatusTime#1', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000001', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-08 18:03:00,757 - INFO - [2_table_aggregator.py] 行 2: ('1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '运行状态', None, '1汇流条竖起机141-设备状态', 'KEP-HC', 'YW-003-ZJ-60-211-0002#SN0001-RS', '100', '1汇流条竖起机141', '23', '一厂-组件车间一', '003', 'YW-003-ZJ-60-211-0002', '通过', '运行状态', '信号类', '状态信号', '自动捋引线', '自动捋引线', '1', '1汇流条竖起机141#运行时长', 'YW-003-ZJ-60-211-0002#OperationStatusTime#23', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000002', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '装框')
2025-09-08 18:03:00,757 - INFO - [2_table_aggregator.py] 行 3: ('1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '运行状态', None, '1层压机101-02-设备状态', 'KEP-HC', 'YW-003-ZJ-62-230-0021#SN0003-RS', '1001', '1层压机101-02', '158', '一厂-组件车间一', '003', 'YW-003-ZJ-62-230-0021', '通过', '运行状态', '信号类', '状态信号', '层压机', '层压机', '1', '1层压机101-02#运行时长', 'YW-003-ZJ-62-230-0021#OperationStatusTime#158', '1', 'h1Diff', '07', '状态统计-设备运行状态', '状态统计-设备运行状态', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'operationStatusTime_hourly', 'YW-EMC-RS-E-NS-NS-000000003', '设备管控', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '层压')
2025-09-08 18:03:00,757 - INFO - [2_table_aggregator.py] 行 4: ('1排版机092-产量', '0#10_003_22#160#Sum', '产量', None, '1排版机092-设备当班产能', 'KEP-HC', 'YW-003-ZJ-61-227-0015#YE0001-FV', '1004', '1排版机092', '160', '一厂-组件车间一', '003', 'YW-003-ZJ-61-227-0015', '通过', '反馈值', '统计类', '产量', '排版机', '排版机', '1', '1排版机092-产量', '0#10_003_22#160#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'YW-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '焊接')
2025-09-08 18:03:00,757 - INFO - [2_table_aggregator.py] 行 5: ('1分档机111-耗电', '7#10_003_22#156#Sum', '耗电', '7', '1分档机111-电量', 'KEP-HC', 'YW-003-ZJ-64-239-0004#AE0005-FV', '1005', '1分档机111', '156', '一厂-组件车间一', '003', 'YW-003-ZJ-64-239-0004', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '1分档机111-耗电', '7#10_003_22#156#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'YW-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '义乌基地', '组件工段', '包装')
2025-09-08 18:03:00,759 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:03:00,764 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_9_邢台
2025-09-08 18:03:00,774 - INFO - [2_table_aggregator.py] 表 1_汇总表_9_邢台 创建成功
2025-09-08 18:03:00,775 - INFO - [2_table_aggregator.py] 正在为基地 邢台 执行数据聚合...
2025-09-08 18:03:00,775 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:03:00,777 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_9_邢台' 行数: 943
2025-09-08 18:03:00,788 - INFO - [2_table_aggregator.py] a表 'a采集点表_9_邢台' 行数: 8176
2025-09-08 18:03:00,790 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_9_邢台' 行数: 488
2025-09-08 18:03:00,790 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:03:00,791 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:03:00,791 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:03:00,799 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('邢台基地', '三厂（三园区）-组件三车间'), ('邢台基地', '二厂（二园区）-组件一车间')]
2025-09-08 18:03:00,804 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:03:00,804 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:03:00,817 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:03:00,884 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_9_邢台
2025-09-08 18:03:00,884 - INFO - [2_table_aggregator.py] 原始表c的行数: 943
2025-09-08 18:03:00,884 - INFO - [2_table_aggregator.py] 汇总表的行数: 943
2025-09-08 18:03:00,884 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 18:03:00,885 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 18:03:00,885 - INFO - [2_table_aggregator.py] 行 1: ('分档机1FD501-耗电', '7#2_004_22#249#Sum', '耗电', '7', '分档机1FD501#设备当前电能表示数', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#AE0002-FV', '801', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '能耗类', '正向有功电度', '分档机', '分档机', '1', '分档机1FD501-耗电', '7#2_004_22#249#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'XT-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '邢台基地', '组件工段', '包装')
2025-09-08 18:03:00,885 - INFO - [2_table_aggregator.py] 行 2: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', None, '分档机1FD501#设备白班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0004-FV', '805', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-08 18:03:00,885 - INFO - [2_table_aggregator.py] 行 3: ('分档机1FD501-产量', '0#2_004#249#Sum', '产量', None, '分档机1FD501#设备夜班产能', '组件分档机1FD501', 'XT-004-ZJ-64-239-0005#YE0005-FV', '807', '分档机1FD501', '249', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-64-239-0005', '通过', '反馈值', '统计类', '产量', '分档机', '分档机', '1', '分档机1FD501-产量', '0#2_004#249#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '2', '1', '邢台基地', '组件工段', '包装')
2025-09-08 18:03:00,885 - INFO - [2_table_aggregator.py] 行 4: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', None, '裁切机1EC106#设备白班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0002-FV', '249', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-08 18:03:00,885 - INFO - [2_table_aggregator.py] 行 5: ('裁切机1EC601-产量', '0#2_004#50#Sum', '产量', None, '裁切机1EC106#设备夜班产能', '组件裁切机1EC106', 'XT-004-ZJ-61-228-0006#YE0003-FV', '250', '裁切机1EC601', '50', '二厂（二园区）-组件一车间', '004', 'XT-004-ZJ-61-228-0006', '通过', '反馈值', '统计类', '产量', '一道EVA裁切机', '一道EVA裁切机', '1', '裁切机1EC601-产量', '0#2_004#50#Sum', '1', 'h1Diff', '00', '产能统计-设备产能统计', '产能统计-设备产能统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'production_volume_equipment_hourly', 'XT-EMS-YE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '3', '1', '邢台基地', '组件工段', '焊接')
2025-09-08 18:03:00,885 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:03:00,892 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_10_宁晋
2025-09-08 18:03:00,901 - INFO - [2_table_aggregator.py] 表 1_汇总表_10_宁晋 创建成功
2025-09-08 18:03:00,901 - INFO - [2_table_aggregator.py] 正在为基地 宁晋 执行数据聚合...
2025-09-08 18:03:00,902 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:03:00,903 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_10_宁晋' 行数: 2083
2025-09-08 18:03:00,927 - INFO - [2_table_aggregator.py] a表 'a采集点表_10_宁晋' 行数: 25728
2025-09-08 18:03:00,929 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_10_宁晋' 行数: 1385
2025-09-08 18:03:00,929 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:03:00,930 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:03:00,931 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:03:00,950 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('宁晋基地', '宁晋东城-电池车间'), ('宁晋基地', '宁晋东城-电池车间-配电室'), ('宁晋基地', '动力车间'), ('', '宁晋东城-电池车间')]
2025-09-08 18:03:00,953 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:03:00,953 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:03:00,965 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:03:01,146 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_10_宁晋
2025-09-08 18:03:01,146 - INFO - [2_table_aggregator.py] 原始表c的行数: 2083
2025-09-08 18:03:01,147 - INFO - [2_table_aggregator.py] 汇总表的行数: 2083
2025-09-08 18:03:01,147 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 18:03:01,147 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 18:03:01,147 - INFO - [2_table_aggregator.py] 行 1: ('硼扩工艺机401-耗电', '7#7_001_21#1#Sum', '耗电', '7', '宁晋电池-硼扩工艺机401-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-43-155-0001#AE0008-FV', '8', '硼扩工艺机401', '1', '宁晋东城-电池车间', '001', 'NJ-001-DC-43-155-0001', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩主机', '硼扩主机', '1', '硼扩工艺机401-耗电', '7#7_001_21#1#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000001', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '硼扩')
2025-09-08 18:03:01,147 - INFO - [2_table_aggregator.py] 行 2: ('硼扩工艺机410-耗电', '7#7_001_21#10#Sum', '耗电', '7', '宁晋电池-硼扩工艺机410-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-43-155-0010#AE0008-FV', '80', '硼扩工艺机410', '10', '宁晋东城-电池车间', '001', 'NJ-001-DC-43-155-0010', '通过', '反馈值', '能耗类', '正向有功电度', '硼扩主机', '硼扩主机', '1', '硼扩工艺机410-耗电', '7#7_001_21#10#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000002', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '硼扩')
2025-09-08 18:03:01,147 - INFO - [2_table_aggregator.py] 行 3: ('背膜工艺机413-耗电', '7#7_001_21#100#Sum', '耗电', '7', '宁晋电池-背膜工艺机413-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0013#AE0008-FV', '800', '背膜工艺机413', '100', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0013', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机413-耗电', '7#7_001_21#100#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000003', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-08 18:03:01,147 - INFO - [2_table_aggregator.py] 行 4: ('背膜工艺机414-耗电', '7#7_001_21#101#Sum', '耗电', '7', '宁晋电池-背膜工艺机414-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0014#AE0008-FV', '808', '背膜工艺机414', '101', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0014', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机414-耗电', '7#7_001_21#101#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000004', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-08 18:03:01,147 - INFO - [2_table_aggregator.py] 行 5: ('背膜工艺机415-耗电', '7#7_001_21#102#Sum', '耗电', '7', '宁晋电池-背膜工艺机415-上位机--总电能', '宁晋电池-kafka', 'NJ-001-DC-52-175-0015#AE0008-FV', '816', '背膜工艺机415', '102', '宁晋东城-电池车间', '001', 'NJ-001-DC-52-175-0015', '通过', '反馈值', '能耗类', '正向有功电度', '背膜主机', '背膜主机', '1', '背膜工艺机415-耗电', '7#7_001_21#102#Sum', '1', 'h1Diff', '00', '能耗统计-设备能耗统计', '能耗统计-设备能耗统计', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '能源', 'consumption_bas_equipment_hourly', 'NJ-EMS-AE-E-NS-NS-000000005', '能源管理', '设备', '1', '1', '1', '1', '宁晋基地', '电池工段', '镀膜')
2025-09-08 18:03:01,147 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:03:01,156 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_11_石家庄
2025-09-08 18:03:01,165 - INFO - [2_table_aggregator.py] 表 1_汇总表_11_石家庄 创建成功
2025-09-08 18:03:01,165 - INFO - [2_table_aggregator.py] 正在为基地 石家庄 执行数据聚合...
2025-09-08 18:03:01,166 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:03:01,171 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_11_石家庄' 行数: 9978
2025-09-08 18:03:01,195 - INFO - [2_table_aggregator.py] a表 'a采集点表_11_石家庄' 行数: 82456
2025-09-08 18:03:01,204 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_11_石家庄' 行数: 3714
2025-09-08 18:03:01,204 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:03:01,205 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:03:01,206 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:03:01,267 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('石家庄基地', '一厂-动力站'), ('石家庄基地', '一厂-电池一期-配电室'), ('石家庄基地', '一厂-切片一期-配电室'), ('石家庄基地', '一厂-电池一期'), ('石家庄基地', '一厂-切片一期')]
2025-09-08 18:03:01,471 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:03:01,471 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:03:01,489 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:03:02,054 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_11_石家庄
2025-09-08 18:03:02,054 - INFO - [2_table_aggregator.py] 原始表c的行数: 9978
2025-09-08 18:03:02,054 - INFO - [2_table_aggregator.py] 汇总表的行数: 9978
2025-09-08 18:03:02,054 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 18:03:02,055 - INFO - [2_table_aggregator.py] 汇总表数据示例 (前5行):
2025-09-08 18:03:02,055 - INFO - [2_table_aggregator.py] 行 1: ('重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '耗电', '7', '78AH07#仪表正向有功总', '动力配电室仪表2.4.6.8', 'SJ-003-ZZ-01-JQ-0207#AE0001-FV', '447079', '78AH07', '519381', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0207', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-10#低温变频离心式冷水机组', '7#6_003_2#519381#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000480', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-08 18:03:02,055 - INFO - [2_table_aggregator.py] 行 2: ('重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '耗电', '7', '71AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0102#AE0001-FV', '446711', '71AH07', '519013', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0102', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-14#双工况低温离心式水源热泵机组', '7#6_003_2#519013#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000182', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-08 18:03:02,055 - INFO - [2_table_aggregator.py] 行 3: ('重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '耗电', '7', '75AH07#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0138#AE0001-FV', '446807', '75AH07', '519109', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0138', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-03#双工况中温离心式水源热泵机组', '7#6_003_2#519109#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000236', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-08 18:03:02,055 - INFO - [2_table_aggregator.py] 行 4: ('重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '耗电', '7', '77AH08#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0155#AE0001-FV', '446871', '77AH08', '519173', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0155', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：RMCH-7-1F-06#双工况中温离心式水源热泵机组', '7#6_003_2#519173#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000483', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-08 18:03:02,055 - INFO - [2_table_aggregator.py] 行 5: ('重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '耗电', '7', '71AH06#仪表正向有功总', '动力配电室仪表1.3.5.7', 'SJ-003-ZZ-01-JQ-0099#AE0001-FV', '446703', '71AH06', '519005', '一厂-动力站', '003', 'SJ-003-ZZ-01-JQ-0099', '通过', '反馈值', '能耗类', '正向有功电度', '在线仪表', '电力仪表', '2', '重点设备耗电量：CH-7-1F-12#低温变频离心式冷水机组', '7#6_003_2#519005#Sum', '1', 'h1Diff', '00', '设备侧小时级电用量', '设备侧小时级电用量', 'Kafka', '10.2.8.71:9092,10.2.8.72:9092,10.2.8.73:9092', '设备', 'consumption_bas_equipment_hourly', 'SJ-EMS-AE-E-NS-NS-000000479', '能源管理', '设备', '1', '1', '1', '1', '石家庄基地', '多工段', '配电系统')
2025-09-08 18:03:02,057 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:03:02,062 - INFO - [2_table_aggregator.py] 已删除已存在的表: 1_汇总表_12_巴彦淖尔
2025-09-08 18:03:02,128 - INFO - [2_table_aggregator.py] 表 1_汇总表_12_巴彦淖尔 创建成功
2025-09-08 18:03:02,128 - INFO - [2_table_aggregator.py] 正在为基地 巴彦淖尔 执行数据聚合...
2025-09-08 18:03:02,131 - INFO - [2_table_aggregator.py] y表的列: ['基地', '车间名称', '车间代码']
2025-09-08 18:03:02,132 - INFO - [2_table_aggregator.py] c表 'c计算逻辑表_采集点_12_巴彦淖尔' 行数: 0
2025-09-08 18:03:02,135 - INFO - [2_table_aggregator.py] a表 'a采集点表_12_巴彦淖尔' 行数: 2124
2025-09-08 18:03:02,135 - INFO - [2_table_aggregator.py] b表 'b计算逻辑表_名称_12_巴彦淖尔' 行数: 0
2025-09-08 18:03:02,137 - INFO - [2_table_aggregator.py] z表 'z【字典】业务属性' 行数: 42
2025-09-08 18:03:02,138 - INFO - [2_table_aggregator.py] y表 'y【字典】车间编码' 行数: 313
2025-09-08 18:03:02,138 - INFO - [2_table_aggregator.py] y表基地和车间名称示例: [('包头基地', '一厂-拉晶车间'), ('包头基地', '一厂-加工车间'), ('包头基地', '一厂-准备1车间'), ('包头基地', '一厂-质量部品管车间'), ('包头基地', '一厂-五车间')]
2025-09-08 18:03:02,139 - INFO - [2_table_aggregator.py] f表base_name和workshop示例: [('巴彦淖尔', '一厂（一期）-5GW组件车间')]
2025-09-08 18:03:02,141 - INFO - [2_table_aggregator.py] SELECT语句返回的列数: 41
2025-09-08 18:03:02,141 - INFO - [2_table_aggregator.py] 目标表的列数: 41
2025-09-08 18:03:02,153 - INFO - [2_table_aggregator.py] 执行SQL语句...
2025-09-08 18:03:02,155 - INFO - [2_table_aggregator.py] 数据已成功聚合到 1_汇总表_12_巴彦淖尔
2025-09-08 18:03:02,155 - INFO - [2_table_aggregator.py] 原始表c的行数: 0
2025-09-08 18:03:02,155 - INFO - [2_table_aggregator.py] 汇总表的行数: 0
2025-09-08 18:03:02,155 - INFO - [2_table_aggregator.py] 行数一致，所有数据已保留
2025-09-08 18:03:02,155 - INFO - [2_table_aggregator.py] --------------------------------------------------
2025-09-08 18:03:02,155 - INFO - [2_table_aggregator.py] 所有基地数据聚合完成!
2025-09-08 18:03:02,155 - INFO - [2_table_aggregator.py] 数据库连接已关闭
2025-09-08 18:03:02,174 - INFO - 脚本 2_table_aggregator.py 成功完成 (返回码: 0)
2025-09-08 18:03:02,174 - INFO - 脚本 2_table_aggregator.py 执行完成，继续下一个
2025-09-08 18:03:02,174 - INFO - 正在运行脚本: 3_merge_tables.py
2025-09-08 18:03:02,174 - INFO - 开始运行脚本: D:\JA\database\3_merge_tables.py
2025-09-08 18:03:02,174 - INFO - 工作目录: D:\JA\database
2025-09-08 18:03:02,771 - INFO - [3_merge_tables.py] 开始处理 12 个基地...
2025-09-08 18:03:02,812 - INFO - [3_merge_tables.py] 正在处理: 扬州基地...正在处理: 奉贤基地...
2025-09-08 18:03:02,812 - INFO - [3_merge_tables.py] 正在处理: 合肥基地...
2025-09-08 18:03:02,813 - INFO - [3_merge_tables.py] 正在处理: 义乌基地...
2025-09-08 18:03:02,814 - INFO - [3_merge_tables.py] 正在处理: 包头基地...正在处理: 东台基地...正在处理: 曲靖基地...
2025-09-08 18:03:02,814 - INFO - [3_merge_tables.py] 正在处理: 鄂尔多斯基地...
2025-09-08 18:03:02,826 - INFO - [3_merge_tables.py] [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_7_包头
2025-09-08 18:03:02,827 - INFO - [3_merge_tables.py] [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_6_奉贤
2025-09-08 18:03:02,827 - INFO - [3_merge_tables.py] [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_2_东台
2025-09-08 18:03:02,828 - INFO - [3_merge_tables.py] [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_4_鄂尔多斯
2025-09-08 18:03:02,828 - INFO - [3_merge_tables.py] [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_5_曲靖  [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_8_义乌
2025-09-08 18:03:02,829 - INFO - [3_merge_tables.py] [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_1_扬州  [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_3_合肥
2025-09-08 18:03:03,542 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_6_奉贤
2025-09-08 18:03:03,556 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_8_义乌
2025-09-08 18:03:03,697 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_6_奉贤
2025-09-08 18:03:03,698 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_4_鄂尔多斯
2025-09-08 18:03:03,748 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_6_奉贤
2025-09-08 18:03:03,796 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:03,844 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_6_奉贤_20250908180302.xlsx
2025-09-08 18:03:03,958 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_8_义乌
2025-09-08 18:03:04,596 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_3_合肥
2025-09-08 18:03:04,966 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_8_义乌
2025-09-08 18:03:04,970 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:05,019 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_8_义乌_20250908180302.xlsx
2025-09-08 18:03:05,221 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_7_包头
2025-09-08 18:03:05,626 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_2_东台
2025-09-08 18:03:05,735 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_5_曲靖
2025-09-08 18:03:05,877 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_1_扬州
2025-09-08 18:03:06,365 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_4_鄂尔多斯
2025-09-08 18:03:06,861 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_4_鄂尔多斯
2025-09-08 18:03:06,948 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:07,033 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_4_鄂尔多斯_20250908180302.xlsx
2025-09-08 18:03:08,448 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_6_奉贤_20250908180302.xlsx
2025-09-08 18:03:08,455 - INFO - [3_merge_tables.py] 正在处理: 邢台基地...
2025-09-08 18:03:08,494 - INFO - [3_merge_tables.py] [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_9_邢台
2025-09-08 18:03:08,670 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_9_邢台
2025-09-08 18:03:09,695 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_9_邢台
2025-09-08 18:03:09,906 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_8_义乌_20250908180302.xlsx
2025-09-08 18:03:09,912 - INFO - [3_merge_tables.py] 正在处理: 宁晋基地...
2025-09-08 18:03:09,936 - INFO - [3_merge_tables.py] [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_10_宁晋
2025-09-08 18:03:09,944 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_9_邢台
2025-09-08 18:03:10,026 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:10,073 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_9_邢台_20250908180302.xlsx
2025-09-08 18:03:10,535 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_10_宁晋
2025-09-08 18:03:12,017 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_4_鄂尔多斯_20250908180302.xlsx
2025-09-08 18:03:12,024 - INFO - [3_merge_tables.py] 正在处理: 石家庄基地...
2025-09-08 18:03:12,084 - INFO - [3_merge_tables.py] [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_11_石家庄
2025-09-08 18:03:12,477 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_9_邢台_20250908180302.xlsx
2025-09-08 18:03:12,481 - INFO - [3_merge_tables.py] 正在处理: 巴彦淖尔基地...
2025-09-08 18:03:12,513 - INFO - [3_merge_tables.py] [1/4] 清理并创建合并表: 2_采集点+设备+数据源合并表_12_巴彦淖尔
2025-09-08 18:03:12,721 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_12_巴彦淖尔
2025-09-08 18:03:12,970 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_12_巴彦淖尔
2025-09-08 18:03:13,036 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_12_巴彦淖尔
2025-09-08 18:03:13,097 - INFO - [3_merge_tables.py] [2/4] 读取采集点表: a采集点表_11_石家庄
2025-09-08 18:03:13,114 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:13,152 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_12_巴彦淖尔_20250908180302.xlsx
2025-09-08 18:03:13,964 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_12_巴彦淖尔_20250908180302.xlsx
2025-09-08 18:03:14,291 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_3_合肥
2025-09-08 18:03:15,012 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_3_合肥
2025-09-08 18:03:15,265 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_10_宁晋
2025-09-08 18:03:15,351 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:15,523 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_3_合肥_20250908180302.xlsx
2025-09-08 18:03:18,102 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_10_宁晋
2025-09-08 18:03:19,139 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_5_曲靖
2025-09-08 18:03:19,193 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:19,308 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_10_宁晋_20250908180302.xlsx
2025-09-08 18:03:22,011 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_7_包头
2025-09-08 18:03:24,083 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_7_包头
2025-09-08 18:03:24,544 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_2_东台
2025-09-08 18:03:24,748 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:24,982 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_7_包头_20250908180302.xlsx
2025-09-08 18:03:30,942 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_2_东台
2025-09-08 18:03:31,189 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_5_曲靖
2025-09-08 18:03:31,832 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_1_扬州
2025-09-08 18:03:31,999 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:32,331 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_2_东台_20250908180302.xlsx
2025-09-08 18:03:38,611 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:38,911 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_5_曲靖_20250908180302.xlsx
2025-09-08 18:03:44,548 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_10_宁晋_20250908180302.xlsx
2025-09-08 18:03:45,195 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_1_扬州
2025-09-08 18:03:45,870 - INFO - [3_merge_tables.py] [3/4] 读取设备表: f设备表_11_石家庄
2025-09-08 18:03:46,954 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_3_合肥_20250908180302.xlsx
2025-09-08 18:03:47,128 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:47,492 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_1_扬州_20250908180302.xlsx
2025-09-08 18:03:54,374 - INFO - [3_merge_tables.py] [4/4] 读取数据源表: g数据源表_11_石家庄
2025-09-08 18:03:54,560 - INFO - [3_merge_tables.py] [5/4] 内存中合并数据...
2025-09-08 18:03:54,890 - INFO - [3_merge_tables.py] [6/4] 导出Excel: 2_采集点+设备+数据源合并表_11_石家庄_20250908180302.xlsx
2025-09-08 18:04:04,477 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_7_包头_20250908180302.xlsx
2025-09-08 18:04:04,831 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_5_曲靖_20250908180302.xlsx
2025-09-08 18:04:04,980 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_2_东台_20250908180302.xlsx
2025-09-08 18:04:05,318 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_11_石家庄_20250908180302.xlsx
2025-09-08 18:04:05,469 - INFO - [3_merge_tables.py] 已导出: 2_采集点+设备+数据源合并表_1_扬州_20250908180302.xlsx
2025-09-08 18:04:05,508 - INFO - [3_merge_tables.py] 所有基地处理完成! 总耗时: 62.74秒
2025-09-08 18:04:05,508 - INFO - [3_merge_tables.py] 开始合并所有基地文件...
2025-09-08 18:04:05,515 - INFO - [3_merge_tables.py] 正在读取合并: 扬州...
2025-09-08 18:04:18,646 - INFO - [3_merge_tables.py] 正在读取合并: 东台...
2025-09-08 18:04:28,401 - INFO - [3_merge_tables.py] 正在读取合并: 合肥...
2025-09-08 18:04:33,344 - INFO - [3_merge_tables.py] 正在读取合并: 鄂尔多斯...
2025-09-08 18:04:34,974 - INFO - [3_merge_tables.py] 正在读取合并: 曲靖...
2025-09-08 18:04:43,885 - INFO - [3_merge_tables.py] 正在读取合并: 奉贤...
2025-09-08 18:04:45,400 - INFO - [3_merge_tables.py] 正在读取合并: 包头...
2025-09-08 18:04:54,146 - INFO - [3_merge_tables.py] 正在读取合并: 义乌...
2025-09-08 18:04:55,512 - INFO - [3_merge_tables.py] 正在读取合并: 邢台...
2025-09-08 18:04:56,435 - INFO - [3_merge_tables.py] 正在读取合并: 宁晋...
2025-09-08 18:04:59,649 - INFO - [3_merge_tables.py] 正在读取合并: 石家庄...
2025-09-08 18:05:11,251 - INFO - [3_merge_tables.py] 正在读取合并: 巴彦淖尔...
2025-09-08 18:06:11,097 - INFO - [3_merge_tables.py] 合并完成! 耗时: 125.59秒
2025-09-08 18:06:11,158 - INFO - [3_merge_tables.py] 合并文件已生成: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】采集点+设备_20250908180302.xlsx
2025-09-08 18:06:11,159 - INFO - [3_merge_tables.py] 程序已正常退出
2025-09-08 18:06:14,265 - INFO - 脚本 3_merge_tables.py 成功完成 (返回码: 0)
2025-09-08 18:06:14,266 - INFO - 脚本 3_merge_tables.py 执行完成，继续下一个
2025-09-08 18:06:14,267 - INFO - 正在运行脚本: 4_merge_calc_tables.py
2025-09-08 18:06:14,267 - INFO - 开始运行脚本: D:\JA\database\4_merge_calc_tables.py
2025-09-08 18:06:14,267 - INFO - 工作目录: D:\JA\database
2025-09-08 18:06:15,556 - INFO - [4_merge_calc_tables.py] 开始导出数据...
2025-09-08 18:06:15,556 - INFO - [4_merge_calc_tables.py] 输出目录: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点
2025-09-08 18:06:17,685 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_1_扬州 已导出到Sheet: 扬州
2025-09-08 18:06:18,594 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_2_东台 已导出到Sheet: 东台
2025-09-08 18:06:18,885 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_3_合肥 已导出到Sheet: 合肥
2025-09-08 18:06:19,101 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_4_鄂尔多斯 已导出到Sheet: 鄂尔多斯
2025-09-08 18:06:21,370 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_5_曲靖 已导出到Sheet: 曲靖
2025-09-08 18:06:21,450 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_6_奉贤 已导出到Sheet: 奉贤
2025-09-08 18:06:22,955 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_7_包头 已导出到Sheet: 包头
2025-09-08 18:06:23,126 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_8_义乌 已导出到Sheet: 义乌
2025-09-08 18:06:23,243 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_9_邢台 已导出到Sheet: 邢台
2025-09-08 18:06:23,487 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_10_宁晋 已导出到Sheet: 宁晋
2025-09-08 18:06:25,014 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_11_石家庄 已导出到Sheet: 石家庄
2025-09-08 18:06:25,028 - INFO - [4_merge_calc_tables.py] 表 1_汇总表_12_巴彦淖尔 已导出到Sheet: 巴彦淖尔
2025-09-08 18:06:33,472 - INFO - [4_merge_calc_tables.py] 汇总Sheet已创建
2025-09-08 18:07:00,817 - INFO - [4_merge_calc_tables.py] 文件已保存为: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250908180615.xlsx
2025-09-08 18:07:00,854 - INFO - [4_merge_calc_tables.py] 文件验证成功: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250908180615.xlsx
2025-09-08 18:07:00,854 - INFO - [4_merge_calc_tables.py] 文件大小: 25107.29 KB
2025-09-08 18:07:00,854 - INFO - [4_merge_calc_tables.py] 导出完成，耗时: 45.30 秒
2025-09-08 18:07:00,854 - INFO - [4_merge_calc_tables.py] === 导出摘要 ===
2025-09-08 18:07:00,854 - INFO - [4_merge_calc_tables.py] 输出文件: D:\工作\PARA\1.PROJECTS\【置顶00】各基地计算逻辑和采集点\【合并】计算逻辑_20250908180615.xlsx
2025-09-08 18:07:00,854 - INFO - [4_merge_calc_tables.py] 包含工作表: 汇总 + 12个基地表
2025-09-08 18:07:02,638 - INFO - 脚本 4_merge_calc_tables.py 成功完成 (返回码: 0)
2025-09-08 18:07:02,639 - INFO - 脚本 4_merge_calc_tables.py 执行完成，继续下一个
2025-09-08 18:07:02,639 - INFO - 结束执行时间: 2025-09-08 18:07:02
2025-09-08 18:07:02,639 - INFO - ==================================================
